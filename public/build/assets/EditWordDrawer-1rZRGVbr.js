import{_ as H}from"./AppTextarea-ncsl-ccN.js";import{_ as P}from"./AppTextField-gvJhEt_e.js";import{_ as R}from"./AppSelect-kmsspWw3.js";import{_ as z}from"./AppDrawerHeaderSection-CoC-5cXl.js";import{r,E as J,w as N,f as I,e as o,o as g,b as t,l as K,a_ as L,k as h,d as S,c as $,ae as k,s as O,t as T,Z as Q,aZ as X}from"./main-0vQdum3W.js";import{C as Y}from"./vue3-perfect-scrollbar-DTesLCsq.js";import{$ as j}from"./api-Bu9cAkj7.js";import{V as ee}from"./VNavigationDrawer-DkmwQRww.js";import{V as le}from"./VDivider-BjTkQFeN.js";import{V as ae}from"./VCard-B0FIEgQM.js";import{V as te}from"./VCardText-2aUnYOFi.js";import{V as oe}from"./VForm-ByJ2Ocas.js";import{V as re,a as f}from"./VRow-BJC749nL.js";import"./form-BOBDXTIA.js";import"./VTextarea-CAclUJAZ.js";/* empty css                   */import"./VCounter-1kO9Ejq8.js";import"./VImg-DLx6417Q.js";import"./VField-ByueHOv2.js";import"./easing-Bybner-F.js";import"./VInput-DtWYPT_L.js";import"./forwardRefs-C-GTDzx5.js";import"./VTextField-Dt27vO3T.js";import"./VSelect-DLwBfv6o.js";import"./VList-glRgkQBq.js";import"./ssrBoot-BbTZXmIo.js";import"./VAvatar-CU2kuCTC.js";import"./dialog-transition-B9SqVvtS.js";import"./VMenu-Bp7x5C0S.js";import"./VOverlay-BbgNkXp-.js";import"./delay-C0XEdUdM.js";import"./lazy-Vb2e14Gv.js";import"./scopeId-BbZfvjVd.js";import"./VCheckboxBtn-B3MFNsTD.js";import"./VSelectionControl-DF6Do3EW.js";import"./VChip-cOQOpo1V.js";import"./VSlideGroup-_0PEsXoi.js";import"./VSpacer-offRCwAk.js";/* empty css              */import"./index-CvOPxmL5.js";const ue={class:"d-flex gap-2 align-center"},se={key:0,class:"d-flex gap-2 align-center"},ne={class:"small"},ie={key:1,class:"text-muted small"},de={key:0,class:"text-danger small mt-1"},Qe={__name:"EditWordDrawer",props:{isDrawerOpen:{type:Boolean,required:!0},wordData:{type:Object,default:()=>({})}},emits:["update:isDrawerOpen","submit-word"],setup(G,{emit:M}){const s=G,C=M,U=r(!1),b=r(),c=r(!1),u=r(null),n=r(null),_=r(""),w=r(""),V=r(""),i=r(null),y=r(null),B=r([]),d=r([]),D=r(null);let p=!1;J(async()=>{var a;try{const e=await j("/users?role=user",{method:"GET"});B.value=e.data||[],(a=s.wordData)!=null&&a.id&&(u.value=s.wordData.user_id,_.value=s.wordData.word||"",w.value=s.wordData.translation||"",V.value=s.wordData.example_sentence||"",u.value&&(await E(u.value,s.wordData.folder_id),p=!0))}catch(e){console.error("Error fetching users",e)}});const E=async(a,e=null)=>{if(!a){d.value=[],n.value=null;return}try{const m=await j(`/folders?user_id=${a}`,{method:"GET"});d.value=m.data||[],e&&d.value.find(v=>v.id===e)&&!p?n.value=e:p||(n.value=null)}catch(m){console.error("Error fetching folders",m),d.value=[],n.value=null}};N(u,async a=>{if(!a){d.value=[],n.value=null;return}p=!1,await E(a)}),N(()=>s.wordData,async a=>{a&&Object.keys(a).length>0?(u.value=a.user_id||null,_.value=a.word||"",w.value=a.translation||"",V.value=a.example_sentence||"",u.value&&(p=!1,await E(u.value,a.folder_id),p=!0)):A()});const W=a=>{const e=a.target.files[0];e&&(e.type.startsWith("audio/")?(i.value=e,y.value=null):(y.value="الملف يجب أن يكون صوتياً",i.value=null,a.target.value=null))},A=()=>{var a,e;(a=b.value)==null||a.reset(),(e=b.value)==null||e.resetValidation(),u.value=null,n.value=null,_.value="",w.value="",V.value="",i.value=null,y.value=null,D.value&&(D.value.value=null),d.value=[],p=!1,c.value=!1},F=()=>{C("update:isDrawerOpen",!1),X(()=>A())},Z=async()=>{var m,v;if(!await((m=b.value)==null?void 0:m.validate())||!((v=s.wordData)!=null&&v.id))return;const e=new FormData;e.append("user_id",u.value),e.append("folder_id",n.value),e.append("word",_.value),e.append("translation",w.value),e.append("example_sentence",V.value),i.value&&e.append("audio_file",i.value),c.value=!0;try{await C("submit-word",s.wordData.id,e),F()}catch(x){console.error(x)}finally{c.value=!1}};return(a,e)=>{const m=z,v=R,x=P,q=H;return g(),I(ee,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":s.isDrawerOpen,"onUpdate:modelValue":e[8]||(e[8]=l=>C("update:isDrawerOpen",l))},{default:o(()=>[t(m,{title:"تعديل الكلمة",onCancel:F}),t(le),t(K(Y),{options:{wheelPropagation:!1}},{default:o(()=>[t(ae,{flat:""},{default:o(()=>[t(te,null,{default:o(()=>[t(oe,{ref_key:"refForm",ref:b,modelValue:U.value,"onUpdate:modelValue":e[7]||(e[7]=l=>U.value=l),onSubmit:L(Z,["prevent"])},{default:o(()=>[t(re,null,{default:o(()=>[t(f,{cols:"12"},{default:o(()=>[t(v,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=l=>u.value=l),items:B.value.map(l=>({value:l.id,title:l.name})),label:"العميل",rules:[l=>!!l||"هذا الحقل مطلوب"]},null,8,["modelValue","items","rules"])]),_:1}),d.value.length?(g(),I(f,{key:0,cols:"12"},{default:o(()=>[t(v,{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=l=>n.value=l),items:d.value.map(l=>({value:l.id,title:l.name})),label:"المجلد",rules:[l=>!!l||"هذا الحقل مطلوب"]},null,8,["modelValue","items","rules"])]),_:1})):h("",!0),t(f,{cols:"12"},{default:o(()=>[t(x,{modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=l=>_.value=l),label:"الكلمة",rules:[l=>!!l||"هذا الحقل مطلوب"]},null,8,["modelValue","rules"])]),_:1}),t(f,{cols:"12"},{default:o(()=>[t(x,{modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=l=>w.value=l),label:"الترجمة",rules:[l=>!!l||"هذا الحقل مطلوب"]},null,8,["modelValue","rules"])]),_:1}),t(f,{cols:"12"},{default:o(()=>[t(q,{modelValue:V.value,"onUpdate:modelValue":e[4]||(e[4]=l=>V.value=l),label:"الجملة"},null,8,["modelValue"])]),_:1}),t(f,{cols:"12"},{default:o(()=>[S("div",ue,[S("input",{ref_key:"audioInput",ref:D,type:"file",accept:"audio/*",onChange:W,style:{display:"none"}},null,544),t(k,{variant:"outlined",onClick:e[5]||(e[5]=l=>D.value.click())},{default:o(()=>e[9]||(e[9]=[O(" رفع ملف صوت ")])),_:1,__:[9]}),i.value?(g(),$("div",se,[S("span",ne,T(i.value.name),1),t(k,{icon:"",variant:"text",onClick:e[6]||(e[6]=()=>{i.value=null,D.value.value.value=null})},{default:o(()=>[t(Q,{icon:"tabler-x"})]),_:1})])):(g(),$("div",ie,"لم يتم اختيار ملف"))]),y.value?(g(),$("div",de,T(y.value),1)):h("",!0)]),_:1}),t(f,{cols:"12"},{default:o(()=>[t(k,{type:"submit",class:"me-3",loading:c.value,disabled:c.value},{default:o(()=>[O(T(c.value?"جاري التعديل...":"حفظ"),1)]),_:1},8,["loading","disabled"]),t(k,{type:"reset",variant:"tonal",color:"error",onClick:F},{default:o(()=>e[10]||(e[10]=[O(" إلغاء ")])),_:1,__:[10]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};export{Qe as default};
