import{_ as le}from"./TablePagination-Do0S47Mp.js";import{_ as ae}from"./AppSelect-DB7--uGO.js";import{_ as oe}from"./AppTextField-D7sjfavu.js";import{$ as H}from"./api-BiIk25cj.js";import{V as U,a as se,b as P,d as Q}from"./VCard-D708Umyd.js";import{V as R}from"./VDialog-CTLXwC5d.js";import{V as re}from"./VSnackbar-KKYnY0Gx.js";import{V as I}from"./VCardText-B4D8XQzc.js";import{V as A}from"./VSpacer-h-2lS1GV.js";import{V as Y}from"./VDivider-BMaMjSWQ.js";import{V as ne}from"./VDataTableServer-BAu91W67.js";import{r as s,E as ie,w as ue,V as me,c as pe,b as t,e as o,a as de,o as w,s as r,d as n,Z as f,t as p,a5 as E,f as j}from"./main-CG3IkRSh.js";import"./VPagination-DciovWfz.js";import"./form-0eVxL5IN.js";import"./VSelect-B-kIFpvS.js";import"./VTextField-KavlJx_0.js";/* empty css                   */import"./VCounter-CQYIVEat.js";import"./VImg-UsZZPD-J.js";import"./VField-BIcgXvNc.js";import"./easing-Bybner-F.js";import"./VInput-DLn4gIuB.js";import"./forwardRefs-C-GTDzx5.js";import"./VList-BO4xVlP5.js";import"./ssrBoot-DRV8GpEy.js";import"./VAvatar-B9hrW8uR.js";import"./dialog-transition-D938gvTE.js";import"./VMenu-DHE6rVpT.js";import"./VOverlay-BXOurBsA.js";import"./delay-BsALBX5A.js";import"./lazy-ChBzuUjv.js";import"./scopeId-CUHqbHex.js";import"./VCheckboxBtn-BTtL6pCD.js";import"./VSelectionControl-6Ze-_NSM.js";import"./VChip-CC7mVFDs.js";import"./VSlideGroup-Ba6MS0Ay.js";import"./index-CvOPxmL5.js";/* empty css              */import"./VDataTable-DlM8KpS7.js";import"./VTable-pUAzb-Hh.js";import"./filter-DG6L0tFn.js";const ve={style:{"inline-size":"15.625rem"}},fe={class:"me-3 d-flex gap-3"},at={__name:"index",setup(ce){const y=s(""),u=s(10),d=s(1),$=s(),C=s(),N=s([]),Z=a=>{var e,v;$.value=(e=a.sortBy[0])==null?void 0:e.key,C.value=(v=a.sortBy[0])==null?void 0:v.order},D=s(!1),z=s(""),_=s("success"),F=(a,e="success")=>{z.value=a,_.value=e,D.value=!0},c=s(!1),k=s(null),q=a=>{k.value=a,c.value=!0},J=async()=>{k.value&&(await h(k.value),c.value=!1,k.value=null)},K=a=>{if(!a)return"";const e=new Date(a),v=e.getFullYear(),M=String(e.getMonth()+1).padStart(2,"0"),V=String(e.getDate()).padStart(2,"0");let i=e.getHours();const l=String(e.getMinutes()).padStart(2,"0"),m=i>=12?"PM":"AM";i=i%12,i=i||12;const x=String(i).padStart(2,"0");return`${v}-${M}-${V} ${x}:${l} ${m}`},b=s(!1),g=s(null),L=a=>{g.value=a,b.value=!0},W=[{title:"الاسم",key:"name"},{title:"البريد الإلكتروني",key:"email"},{title:"الموضوع",key:"subject"},{title:"الرسالة",key:"message"},{title:"التاريخ",key:"created_at"},{title:"العمليات",key:"actions",sortable:!1}],O=s([]),S=s(0),T=s(!0),B=async()=>{T.value=!0;try{const a=await H("/messages",{method:"GET",params:{search:y.value,per_page:u.value,page:d.value,sort_by:$.value,sort_order:C.value}});a.status==="success"&&(O.value=a.data.data,S.value=a.data.total)}catch(a){console.error("Error fetching messages",a)}finally{T.value=!1}};ie(B),ue([y,u,d,$,C],B);const X=me(()=>O.value),h=async a=>{try{await H(`/messages/${a}/delete`,{method:"POST"}),F("تم حذف الرسالة بنجاح","success"),B()}catch{F("حدث خطأ أثناء الحذف","error")}},ee=a=>{if(!a)return"";const e=a.split(" ");return e.length>5?e.slice(0,5).join(" ")+"...":a},te=a=>{window.location.href=`mailto:${a}`};return(a,e)=>{const v=oe,M=ae,V=de("IconBtn"),i=le;return w(),pe("section",null,[t(U,{class:"mb-6"},{default:o(()=>[t(se,{class:"pb-4"},{default:o(()=>[t(P,null,{default:o(()=>e[11]||(e[11]=[r("الرسائل الواردة")])),_:1,__:[11]})]),_:1}),t(I,{class:"d-flex flex-wrap gap-4 align-center"},{default:o(()=>[n("div",ve,[t(v,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=l=>y.value=l),placeholder:"بحث..."},null,8,["modelValue"])]),n("div",fe,[t(M,{"model-value":u.value,items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[1]||(e[1]=l=>u.value=parseInt(l,10))},null,8,["model-value"])]),t(A)]),_:1}),t(Y),t(ne,{"items-per-page":u.value,"onUpdate:itemsPerPage":e[3]||(e[3]=l=>u.value=l),"model-value":N.value,"onUpdate:modelValue":e[4]||(e[4]=l=>N.value=l),page:d.value,"onUpdate:page":e[5]||(e[5]=l=>d.value=l),items:X.value,"item-value":"id","items-length":S.value,headers:W,class:"text-no-wrap",loading:T.value,"onUpdate:options":Z},{"item.message":o(({item:l})=>[r(p(ee(l.message)),1)]),"item.created_at":o(({item:l})=>[r(p(K(l.created_at)),1)]),"item.actions":o(({item:l})=>[t(V,{onClick:m=>L(l)},{default:o(()=>[t(f,{icon:"tabler-eye"})]),_:2},1032,["onClick"]),t(V,{onClick:m=>te(l.email)},{default:o(()=>[t(f,{icon:"tabler-mail"})]),_:2},1032,["onClick"]),t(V,{onClick:m=>q(l.id)},{default:o(()=>[t(f,{icon:"tabler-trash"})]),_:2},1032,["onClick"])]),bottom:o(()=>[t(i,{page:d.value,"onUpdate:page":e[2]||(e[2]=l=>d.value=l),"items-per-page":u.value,"total-items":S.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length","loading"])]),_:1}),t(R,{modelValue:b.value,"onUpdate:modelValue":e[7]||(e[7]=l=>b.value=l),"max-width":"700px"},{default:o(()=>[t(U,null,{default:o(()=>[t(P,{class:"text-h6"},{default:o(()=>e[12]||(e[12]=[r("عرض الرسالة كاملة")])),_:1,__:[12]}),t(I,null,{default:o(()=>{var l,m,x,G;return[n("p",null,[e[13]||(e[13]=n("strong",null,"الاسم:",-1)),r(" "+p((l=g.value)==null?void 0:l.name),1)]),n("p",null,[e[14]||(e[14]=n("strong",null,"البريد الإلكتروني:",-1)),r(" "+p((m=g.value)==null?void 0:m.email),1)]),n("p",null,[e[15]||(e[15]=n("strong",null,"الموضوع:",-1)),r(" "+p(((x=g.value)==null?void 0:x.subject)||"لا يوجد"),1)]),t(Y,{class:"my-2"}),e[16]||(e[16]=n("p",null,[n("strong",null,"الرسالة:")],-1)),n("p",null,p((G=g.value)==null?void 0:G.message),1)]}),_:1,__:[16]}),t(Q,{class:"px-6 pb-4"},{default:o(()=>[t(A),t(E,{color:"primary",variant:"flat",onClick:e[6]||(e[6]=l=>b.value=!1)},{default:o(()=>e[17]||(e[17]=[r("إغلاق")])),_:1,__:[17]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(R,{modelValue:c.value,"onUpdate:modelValue":e[9]||(e[9]=l=>c.value=l),"max-width":"500px"},{default:o(()=>[t(U,null,{default:o(()=>[t(P,{class:"text-h6"},{default:o(()=>e[18]||(e[18]=[r("تأكيد الحذف")])),_:1,__:[18]}),t(I,null,{default:o(()=>e[19]||(e[19]=[r("هل أنت متأكد أنك تريد حذف هذه الرسالة؟")])),_:1,__:[19]}),t(Q,{class:"px-6 pb-4"},{default:o(()=>[t(A),t(E,{color:"error",variant:"flat",onClick:e[8]||(e[8]=l=>c.value=!1)},{default:o(()=>e[20]||(e[20]=[r("إلغاء")])),_:1,__:[20]}),t(E,{color:"success",variant:"flat",onClick:J},{default:o(()=>e[21]||(e[21]=[r("موافق")])),_:1,__:[21]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(re,{modelValue:D.value,"onUpdate:modelValue":e[10]||(e[10]=l=>D.value=l),color:_.value,location:"top end",timeout:"5000"},{prepend:o(()=>[_.value==="success"?(w(),j(f,{key:0,icon:"tabler-check"})):_.value==="error"?(w(),j(f,{key:1,icon:"tabler-alert-circle"})):(w(),j(f,{key:2,icon:"tabler-info-circle"}))]),default:o(()=>[r(" "+p(z.value),1)]),_:1},8,["modelValue","color"])])}}};export{at as default};
