import{_ as oe}from"./TablePagination-k5j-Wj6U.js";import{_ as se}from"./AppTextField-BWx9dSw2.js";import{_ as re}from"./AppSelect-BA5iydIU.js";import{r,E as le,w as ie,V as ne,c as N,b as a,e as o,i as ue,a as F,o as f,s as u,d as i,a5 as U,Z as m,t as d,f as C}from"./main-DSzMYLzp.js";import de from"./AddNewUserDrawer-MUNafXGx.js";import pe from"./EditUserDrawer-CLD0x3Dq.js";import{$ as T}from"./api-DfH6QBqv.js";import{V as Y,a as me,b as G,d as ce}from"./VCard-DuhDOrWR.js";import{V as ve}from"./VSnackbar-cAfrQJKi.js";import{V as fe}from"./VDialog-BVYGJeUe.js";import{V as Q}from"./VCardText-CYf2INNP.js";import{V as Z}from"./VSpacer-C0KMtbqI.js";import{V as _e}from"./VDivider-Aaq6eqyh.js";import{V as ge}from"./VDataTableServer-DEUWfKn-.js";import{V as xe}from"./VAvatar-CS_wgqDD.js";import{V as ye}from"./VImg-DNHHYH1j.js";import"./VPagination-D_e-sj_C.js";import"./form-B1tFRS7d.js";import"./VTextField-CziLb0ab.js";/* empty css                   */import"./VCounter-CgP2sO8g.js";import"./VField-D6MI6Ow5.js";import"./easing-Bybner-F.js";import"./VInput-CPAsoCij.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-D2dW3-oO.js";import"./VList-DKYD3D7n.js";import"./ssrBoot-BftT6orn.js";import"./dialog-transition-Bo7gOho2.js";import"./VMenu-C8sperRe.js";import"./VOverlay-B4STW1mc.js";import"./delay-xKSXn8zt.js";import"./lazy-C265PUUC.js";import"./scopeId-D_KEFreD.js";import"./VCheckboxBtn-BPHfXDUK.js";import"./VSelectionControl-l_Y0JvA-.js";import"./VChip-BBSDOnKc.js";import"./VSlideGroup-DP5_Q-g4.js";import"./validators-DpYrMFzk.js";import"./helpers-DK5QwNv0.js";import"./AppDrawerHeaderSection-D3lbPkyF.js";import"./vue3-perfect-scrollbar-CD61MQhq.js";import"./VNavigationDrawer-vqJV-mq-.js";import"./VForm-CPPstvq0.js";import"./VRow-CXKAFC9P.js";/* empty css              */import"./index-CvOPxmL5.js";import"./VDataTable-B5-Dxcxn.js";import"./VTable-0DUjqDOs.js";import"./filter-svWakHCw.js";const Ve={class:"me-3 d-flex gap-3"},we={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},be={style:{"inline-size":"15.625rem"}},De={class:"d-flex align-center gap-x-4"},ke={key:1},he={class:"d-flex flex-column"},Ue={class:"text-base"},Ce={class:"text-sm"},Te={class:"d-flex align-center gap-x-2"},$e={class:"text-body-1 text-high-emphasis text-capitalize"},Be={class:"text-body-1 text-high-emphasis"},Ie={class:"text-body-1 text-high-emphasis"},Ee={class:"text-body-1 text-high-emphasis"},Bt={__name:"index",setup(Pe){ue();const V=r(""),p=r(10),c=r(1),$=r(),B=r(),w=r([]),j=s=>{var e,n;$.value=(e=s.sortBy[0])==null?void 0:e.key,B.value=(n=s.sortBy[0])==null?void 0:n.order},b=r(!1),S=r(""),D=r("success"),v=(s,e="success")=>{S.value=s,D.value=e,b.value=!0},_=r(!1),k=r(null),q=s=>{k.value=s,_.value=!0},H=async()=>{k.value&&(await ee(k.value),_.value=!1,k.value=null)},J=s=>{if(!s)return"غير محدد";const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),x=new Date(s),h=new Date(x.getFullYear(),x.getMonth(),x.getDate()).getTime()-n.getTime(),y=Math.ceil(h/(1e3*60*60*24));return y>0?`متبقي ${y} يوم`:y===0?"ينتهي اليوم":"منتهية"},K=[{title:"الادمن",key:"user"},{title:"النوع",key:"role"},{title:"البريد الالكتروني",key:"email"},{title:"العمليات",key:"actions",sortable:!1}],z=r([]),I=r(0),E=r(!0),g=async()=>{var s;E.value=!0;try{const e=await T("/users",{method:"GET",params:{role:"admin",search:V.value,per_page:p.value,page:c.value,sort_by:$.value,sort_order:B.value}});e.status==="success"&&(z.value=e.data,I.value=((s=e.meta)==null?void 0:s.total)||0)}catch(e){console.error("Error fetching users",e)}finally{E.value=!1}};le(g),ie([V,p,c,$,B],g);const W=ne(()=>z.value),P=s=>(s==null?void 0:s.toLowerCase())==="admin"?{color:"primary",icon:"tabler-crown"}:{color:"primary",icon:"tabler-user"},A=r(!1),X=async s=>{try{await T("/users/store",{method:"POST",body:s}),v("تم اضافة البيانات بنجاح","success"),g()}catch{v("حدث خطأ من فضلك حاول في وقت اخر","error")}},ee=async s=>{try{await T(`/users/delete/${s}`,{method:"POST"});const e=w.value.findIndex(n=>n===s);e!==-1&&w.value.splice(e,1),v("تم الحذف بنجاح","success"),g()}catch(e){console.error("Error deleting user:",e),v("حدث خطأ أثناء الحذف","error")}},M=r(!1),O=r(null),te=s=>{O.value=s,M.value=!0},ae=async(s,e)=>{try{await T(`/users/update/${s}`,{method:"POST",body:e}),v("تم تعديل البيانات بنجاح","success"),g()}catch{v("حدث خطأ من فضلك حاول في وقت اخر","error")}};return(s,e)=>{const n=re,x=se,R=F("RouterLink"),h=F("IconBtn"),y=oe;return f(),N("section",null,[a(Y,{class:"mb-6"},{default:o(()=>[a(me,{class:"pb-4"},{default:o(()=>[a(G,null,{default:o(()=>e[13]||(e[13]=[u("الادمن")])),_:1,__:[13]})]),_:1}),a(Q,{class:"d-flex flex-wrap gap-4"},{default:o(()=>[i("div",Ve,[a(n,{"model-value":p.value,items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[0]||(e[0]=t=>p.value=parseInt(t,10))},null,8,["model-value"])]),a(Z),i("div",we,[i("div",be,[a(x,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=t=>V.value=t),placeholder:"بحث"},null,8,["modelValue"])]),a(U,{"prepend-icon":"tabler-plus",onClick:e[2]||(e[2]=t=>A.value=!0)},{default:o(()=>e[14]||(e[14]=[u(" اضافة ادمن جديد ")])),_:1,__:[14]})])]),_:1}),a(_e),a(ge,{"items-per-page":p.value,"onUpdate:itemsPerPage":e[4]||(e[4]=t=>p.value=t),"model-value":w.value,"onUpdate:modelValue":e[5]||(e[5]=t=>w.value=t),page:c.value,"onUpdate:page":e[6]||(e[6]=t=>c.value=t),items:W.value,"item-value":"id","items-length":I.value,headers:K,class:"text-no-wrap",loading:E.value,"onUpdate:options":j},{"item.user":o(({item:t})=>[i("div",De,[a(xe,{size:"34",variant:t.avatar?void 0:"tonal",color:t.avatar?void 0:P(t.role).color},{default:o(()=>{var l;return[t.avatar?(f(),C(ye,{key:0,src:t.avatar},null,8,["src"])):(f(),N("span",ke,d((l=t.name)==null?void 0:l.charAt(0).toUpperCase()),1))]}),_:2},1032,["variant","color"]),i("div",he,[i("h6",Ue,[a(R,{to:{name:"apps-user-view-id",params:{id:t.id}},class:"font-weight-medium text-link"},{default:o(()=>[u(d(t.name),1)]),_:2},1032,["to"])]),i("div",Ce,d(t.email),1)])])]),"item.role":o(({item:t})=>[i("div",Te,[a(m,{size:22,icon:P(t.role).icon,color:P(t.role).color},null,8,["icon","color"]),e[15]||(e[15]=i("div",{class:"text-capitalize text-high-emphasis text-body-1"}," ادمن ",-1))])]),"item.plan":o(({item:t})=>{var l,L;return[i("div",$e,d(((L=(l=t.subscription)==null?void 0:l.plan)==null?void 0:L.name)||"غير مشترك"),1)]}),"item.start_at":o(({item:t})=>{var l;return[i("div",Be,d(((l=t.subscription)==null?void 0:l.start_date)??"غير محدد"),1)]}),"item.expires_at":o(({item:t})=>{var l;return[i("div",Ie,d(((l=t.subscription)==null?void 0:l.end_date)??"غير محدد"),1)]}),"item.remain":o(({item:t})=>{var l;return[i("div",Ee,d(J((l=t.subscription)==null?void 0:l.end_date)),1)]}),"item.actions":o(({item:t})=>[a(h,{onClick:l=>te(t)},{default:o(()=>[a(m,{icon:"tabler-pencil"})]),_:2},1032,["onClick"]),a(h,{onClick:l=>q(t.id)},{default:o(()=>[a(m,{icon:"tabler-trash"})]),_:2},1032,["onClick"])]),bottom:o(()=>[a(y,{page:c.value,"onUpdate:page":e[3]||(e[3]=t=>c.value=t),"items-per-page":p.value,"total-items":I.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length","loading"])]),_:1}),a(de,{"is-drawer-open":A.value,"onUpdate:isDrawerOpen":e[7]||(e[7]=t=>A.value=t),onUserData:X},null,8,["is-drawer-open"]),a(pe,{"is-drawer-open":M.value,"onUpdate:isDrawerOpen":e[8]||(e[8]=t=>M.value=t),"user-data":O.value,onUserData:ae},null,8,["is-drawer-open","user-data"]),a(ve,{modelValue:b.value,"onUpdate:modelValue":e[10]||(e[10]=t=>b.value=t),color:D.value,location:"top end",timeout:"5000"},{prepend:o(()=>[D.value==="success"?(f(),C(m,{key:0,icon:"tabler-check"})):D.value==="error"?(f(),C(m,{key:1,icon:"tabler-alert-circle"})):(f(),C(m,{key:2,icon:"tabler-info-circle"}))]),actions:o(()=>[a(U,{icon:"",variant:"text",color:"white",onClick:e[9]||(e[9]=t=>b.value=!1)},{default:o(()=>[a(m,{icon:"tabler-x"})]),_:1})]),default:o(()=>[u(" "+d(S.value)+" ",1)]),_:1},8,["modelValue","color"]),a(fe,{modelValue:_.value,"onUpdate:modelValue":e[12]||(e[12]=t=>_.value=t),"max-width":"500px"},{default:o(()=>[a(Y,null,{default:o(()=>[a(G,{class:"text-h6"},{default:o(()=>e[16]||(e[16]=[u(" تأكيد الحذف ")])),_:1,__:[16]}),a(Q,null,{default:o(()=>e[17]||(e[17]=[u(" هل أنت متأكد أنك تريد حذف هذا الادمن؟ لا يمكن التراجع عن هذا الإجراء. ")])),_:1,__:[17]}),a(ce,{class:"px-6 pb-4"},{default:o(()=>[a(Z),a(U,{color:"error",variant:"flat",onClick:e[11]||(e[11]=t=>_.value=!1)},{default:o(()=>e[18]||(e[18]=[u(" إلغاء ")])),_:1,__:[18]}),a(U,{color:"success",variant:"flat",onClick:H},{default:o(()=>e[19]||(e[19]=[u(" موافق ")])),_:1,__:[19]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{Bt as default};
