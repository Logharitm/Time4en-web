import{_ as oe}from"./TablePagination-B8d9hxqa.js";import{_ as se}from"./AppTextField-D7_sgzpA.js";import{_ as re}from"./AppSelect-Be37VUwQ.js";import{r,E as le,w as ie,V as ne,c as L,b as a,e as o,i as ue,a as F,o as f,s as d,d as i,ae as U,Z as c,t as u,f as C}from"./main-DFArCsHY.js";import de from"./AddNewUserDrawer-lYmvwPtf.js";import pe from"./EditUserDrawer-BKMzZw9W.js";import{$ as T}from"./api-XzAV96D5.js";import{V as Y,a as ce,b as G,d as me}from"./VCard-DxEjI5j5.js";import{V as ve}from"./VSnackbar-DEKLRHEo.js";import{V as fe}from"./VDialog-Comn7H6S.js";import{V as Q}from"./VCardText-DPCtp8hQ.js";import{V as Z}from"./VSpacer-Ix0ciMj8.js";import{V as _e}from"./VDivider-r3A3xjrj.js";import{V as ge}from"./VDataTableServer-aed43sCK.js";import{V as xe}from"./VAvatar-CR6ulyn0.js";import{V as ye}from"./VImg-u4PCXAxX.js";import"./VPagination-uZ1sW5JS.js";import"./form-Dca2QsTl.js";import"./VTextField-umeveIvf.js";/* empty css                   */import"./VCounter-COEwzdbN.js";import"./VField-Df9Z3FAQ.js";import"./easing-Bybner-F.js";import"./VInput-CTSxe1am.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-DMNaQ-fx.js";import"./VList-CePb2jwz.js";import"./ssrBoot-BYwRCcks.js";import"./dialog-transition-DJ8svTM-.js";import"./VMenu-CGIlYQhN.js";import"./VOverlay-DAJAZdL3.js";import"./delay-DmoI4jxp.js";import"./lazy-Cxg2GrII.js";import"./scopeId-C1yITn5F.js";import"./VCheckboxBtn-CTXDyT5c.js";import"./VSelectionControl-CPzmbhb-.js";import"./VChip-D7ojS-xb.js";import"./VSlideGroup-D22aarxl.js";import"./validators-DpYrMFzk.js";import"./helpers-DK5QwNv0.js";import"./AppDrawerHeaderSection-UlioqdB7.js";import"./vue3-perfect-scrollbar-lX5i4by-.js";import"./VNavigationDrawer-CUULj9NY.js";import"./VForm-C3ZOJrXx.js";import"./VRow-ug2wovWp.js";/* empty css              */import"./index-CvOPxmL5.js";import"./VDataTable-_pKsa3bT.js";import"./VTable-iLxlgEJ3.js";import"./filter-B-rpF6id.js";const Ve={class:"me-3 d-flex gap-3"},be={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},we={style:{"inline-size":"15.625rem"}},he={class:"d-flex align-center gap-x-4"},ke={key:1},De={class:"d-flex flex-column"},Ue={class:"text-base"},Ce={class:"text-sm"},Te={class:"d-flex align-center gap-x-2"},$e={class:"text-capitalize text-high-emphasis text-body-1"},Be={class:"text-body-1 text-high-emphasis text-capitalize"},Ie={class:"text-body-1 text-high-emphasis"},Ee={class:"text-body-1 text-high-emphasis"},Pe={class:"text-body-1 text-high-emphasis"},It={__name:"index",setup(Ae){ue();const V=r(""),p=r(10),m=r(1),$=r(),B=r(),b=r([]),j=s=>{var e,n;$.value=(e=s.sortBy[0])==null?void 0:e.key,B.value=(n=s.sortBy[0])==null?void 0:n.order},w=r(!1),S=r(""),h=r("success"),v=(s,e="success")=>{S.value=s,h.value=e,w.value=!0},_=r(!1),k=r(null),q=s=>{k.value=s,_.value=!0},H=async()=>{k.value&&(await ee(k.value),_.value=!1,k.value=null)},J=s=>{if(!s)return"غير محدد";const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),x=new Date(s),D=new Date(x.getFullYear(),x.getMonth(),x.getDate()).getTime()-n.getTime(),y=Math.ceil(D/(1e3*60*60*24));return y>0?`متبقي ${y} يوم`:y===0?"ينتهي اليوم":"منتهية"},K=[{title:"الادمن",key:"user"},{title:"النوع",key:"role"},{title:"البريد الالكتروني",key:"email"},{title:"العمليات",key:"actions",sortable:!1}],z=r([]),I=r(0),E=r(!0),g=async()=>{var s;E.value=!0;try{const e=await T("/users",{method:"GET",params:{role:"admin",search:V.value,per_page:p.value,page:m.value,sort_by:$.value,sort_order:B.value}});e.status==="success"&&(z.value=e.data,I.value=((s=e.meta)==null?void 0:s.total)||0)}catch(e){console.error("Error fetching users",e)}finally{E.value=!1}};le(g),ie([V,p,m,$,B],g);const W=ne(()=>z.value),P=s=>{const e=s==null?void 0:s.toLowerCase();return e==="subscriber"?{color:"success",icon:"tabler-user"}:e==="author"?{color:"error",icon:"tabler-device-desktop"}:e==="maintainer"?{color:"info",icon:"tabler-chart-pie"}:e==="editor"?{color:"warning",icon:"tabler-edit"}:e==="admin"?{color:"primary",icon:"tabler-crown"}:{color:"primary",icon:"tabler-user"}},A=r(!1),X=async s=>{try{await T("/users/store",{method:"POST",body:s}),v("تم اضافة البيانات بنجاح","success"),g()}catch{v("حدث خطأ من فضلك حاول في وقت اخر","error")}},ee=async s=>{try{await T(`/users/delete/${s}`,{method:"POST"});const e=b.value.findIndex(n=>n===s);e!==-1&&b.value.splice(e,1),v("تم الحذف بنجاح","success"),g()}catch(e){console.error("Error deleting user:",e),v("حدث خطأ أثناء الحذف","error")}},M=r(!1),O=r(null),te=s=>{O.value=s,M.value=!0},ae=async(s,e)=>{try{await T(`/users/update/${s}`,{method:"POST",body:e}),v("تم تعديل البيانات بنجاح","success"),g()}catch{v("حدث خطأ من فضلك حاول في وقت اخر","error")}};return(s,e)=>{const n=re,x=se,R=F("RouterLink"),D=F("IconBtn"),y=oe;return f(),L("section",null,[a(Y,{class:"mb-6"},{default:o(()=>[a(ce,{class:"pb-4"},{default:o(()=>[a(G,null,{default:o(()=>e[13]||(e[13]=[d("الادمن")])),_:1,__:[13]})]),_:1}),a(Q,{class:"d-flex flex-wrap gap-4"},{default:o(()=>[i("div",Ve,[a(n,{"model-value":p.value,items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[0]||(e[0]=t=>p.value=parseInt(t,10))},null,8,["model-value"])]),a(Z),i("div",be,[i("div",we,[a(x,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=t=>V.value=t),placeholder:"بحث"},null,8,["modelValue"])]),a(U,{"prepend-icon":"tabler-plus",onClick:e[2]||(e[2]=t=>A.value=!0)},{default:o(()=>e[14]||(e[14]=[d(" اضافة ادمن جديد ")])),_:1,__:[14]})])]),_:1}),a(_e),a(ge,{"items-per-page":p.value,"onUpdate:itemsPerPage":e[4]||(e[4]=t=>p.value=t),"model-value":b.value,"onUpdate:modelValue":e[5]||(e[5]=t=>b.value=t),page:m.value,"onUpdate:page":e[6]||(e[6]=t=>m.value=t),items:W.value,"item-value":"id","items-length":I.value,headers:K,class:"text-no-wrap",loading:E.value,"onUpdate:options":j},{"item.user":o(({item:t})=>[i("div",he,[a(xe,{size:"34",variant:t.avatar?void 0:"tonal",color:t.avatar?void 0:P(t.role).color},{default:o(()=>{var l;return[t.avatar?(f(),C(ye,{key:0,src:t.avatar},null,8,["src"])):(f(),L("span",ke,u((l=t.name)==null?void 0:l.charAt(0).toUpperCase()),1))]}),_:2},1032,["variant","color"]),i("div",De,[i("h6",Ue,[a(R,{to:{name:"apps-user-view-id",params:{id:t.id}},class:"font-weight-medium text-link"},{default:o(()=>[d(u(t.name),1)]),_:2},1032,["to"])]),i("div",Ce,u(t.email),1)])])]),"item.role":o(({item:t})=>[i("div",Te,[a(c,{size:22,icon:P(t.role).icon,color:P(t.role).color},null,8,["icon","color"]),i("div",$e,u(t.role=="user"?"عميل":"ادمن"),1)])]),"item.plan":o(({item:t})=>{var l,N;return[i("div",Be,u(((N=(l=t.subscription)==null?void 0:l.plan)==null?void 0:N.name)||"غير مشترك"),1)]}),"item.start_at":o(({item:t})=>{var l;return[i("div",Ie,u(((l=t.subscription)==null?void 0:l.start_date)??"غير محدد"),1)]}),"item.expires_at":o(({item:t})=>{var l;return[i("div",Ee,u(((l=t.subscription)==null?void 0:l.end_date)??"غير محدد"),1)]}),"item.remain":o(({item:t})=>{var l;return[i("div",Pe,u(J((l=t.subscription)==null?void 0:l.end_date)),1)]}),"item.actions":o(({item:t})=>[a(D,{onClick:l=>te(t)},{default:o(()=>[a(c,{icon:"tabler-pencil"})]),_:2},1032,["onClick"]),a(D,{onClick:l=>q(t.id)},{default:o(()=>[a(c,{icon:"tabler-trash"})]),_:2},1032,["onClick"])]),bottom:o(()=>[a(y,{page:m.value,"onUpdate:page":e[3]||(e[3]=t=>m.value=t),"items-per-page":p.value,"total-items":I.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length","loading"])]),_:1}),a(de,{"is-drawer-open":A.value,"onUpdate:isDrawerOpen":e[7]||(e[7]=t=>A.value=t),onUserData:X},null,8,["is-drawer-open"]),a(pe,{"is-drawer-open":M.value,"onUpdate:isDrawerOpen":e[8]||(e[8]=t=>M.value=t),"user-data":O.value,onUserData:ae},null,8,["is-drawer-open","user-data"]),a(ve,{modelValue:w.value,"onUpdate:modelValue":e[10]||(e[10]=t=>w.value=t),color:h.value,location:"top end",timeout:"5000"},{prepend:o(()=>[h.value==="success"?(f(),C(c,{key:0,icon:"tabler-check"})):h.value==="error"?(f(),C(c,{key:1,icon:"tabler-alert-circle"})):(f(),C(c,{key:2,icon:"tabler-info-circle"}))]),actions:o(()=>[a(U,{icon:"",variant:"text",color:"white",onClick:e[9]||(e[9]=t=>w.value=!1)},{default:o(()=>[a(c,{icon:"tabler-x"})]),_:1})]),default:o(()=>[d(" "+u(S.value)+" ",1)]),_:1},8,["modelValue","color"]),a(fe,{modelValue:_.value,"onUpdate:modelValue":e[12]||(e[12]=t=>_.value=t),"max-width":"500px"},{default:o(()=>[a(Y,null,{default:o(()=>[a(G,{class:"text-h6"},{default:o(()=>e[15]||(e[15]=[d(" تأكيد الحذف ")])),_:1,__:[15]}),a(Q,null,{default:o(()=>e[16]||(e[16]=[d(" هل أنت متأكد أنك تريد حذف هذا الادمن؟ لا يمكن التراجع عن هذا الإجراء. ")])),_:1,__:[16]}),a(me,{class:"px-6 pb-4"},{default:o(()=>[a(Z),a(U,{color:"error",variant:"flat",onClick:e[11]||(e[11]=t=>_.value=!1)},{default:o(()=>e[17]||(e[17]=[d(" إلغاء ")])),_:1,__:[17]}),a(U,{color:"success",variant:"flat",onClick:H},{default:o(()=>e[18]||(e[18]=[d(" موافق ")])),_:1,__:[18]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{It as default};
