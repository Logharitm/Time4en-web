import{_ as pe}from"./TablePagination-xJ7XuTp_.js";import{_ as ce}from"./AppDateTimePicker-DaZJ9SxL.js";import{_ as ve}from"./AppTextField-BghX37xa.js";import{_ as fe}from"./AppSelect-C-zkGQbQ.js";import{r as s,E as _e,w as Q,V as Ve,c as Z,b as a,e as l,i as ge,a as j,o as D,s as i,d as u,a0 as I,Z as U,t as d,f as O,k as ye}from"./main-ati8xvH6.js";import be from"./AddNewUserDrawer-BOeKFCuB.js";import we from"./EditUserDrawer-BYw_GVvN.js";import{$ as h}from"./api-B8XarYXo.js";import{_ as xe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as q,a as ke,b as H,d as De}from"./VCard-D1ecB0Qb.js";import{V as Ue}from"./VSnackbar-oDRv-gkv.js";import{V as he}from"./VDialog-CY219MRL.js";import{V as J}from"./VCardText-DIfRMZKO.js";import{V as K}from"./VSpacer-Cg3yOwu2.js";import{V as Te}from"./VDivider-BHYnGZVE.js";import{V as Ce}from"./VDataTableServer-C0p1Vyce.js";import{V as $e}from"./VAvatar-bih18Hak.js";import{V as Be}from"./VImg-CqGYfzkJ.js";import"./VPagination-CPSARsKf.js";import"./VField-DKy7DUWd.js";import"./form-BHcokMEG.js";import"./easing-Bybner-F.js";import"./VInput--0QYvzuB.js";import"./VTextField-BtK2TFKt.js";/* empty css                   */import"./VCounter-B8JWvb_e.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-C2NzBH0H.js";import"./VList-B_sGVGgF.js";import"./ssrBoot-pFNmaLdJ.js";import"./dialog-transition-BO2JtSU2.js";import"./VMenu-DbRpIYgP.js";import"./VOverlay-DwOHP6WB.js";import"./delay-TxzeKsv_.js";import"./lazy-UUZv6FjF.js";import"./scopeId-7InUGSEQ.js";import"./VCheckboxBtn-CiBu_Whe.js";import"./VSelectionControl-d5f6WD7D.js";import"./VChip-CvCx5nyt.js";import"./VSlideGroup-Cdjwb4FN.js";import"./validators-DpYrMFzk.js";import"./helpers-DK5QwNv0.js";import"./AppDrawerHeaderSection-CYfUZoHm.js";import"./vue3-perfect-scrollbar-BU0pCFSp.js";import"./VNavigationDrawer-DePwwTkA.js";import"./VForm-DLGANjsJ.js";import"./VRow-BSanGcpd.js";/* empty css              */import"./index-CvOPxmL5.js";import"./VDataTable-BxJNwoI0.js";import"./VTable-pSYjZy3q.js";import"./filter-Z-65vIL7.js";const Pe={class:"me-3 d-flex gap-3"},Ie={style:{"min-width":"200px"}},Ae={style:{"min-width":"200px"}},Ee={style:{"min-width":"200px"}},Se={style:{"min-width":"200px"}},Me={style:{"min-width":"200px"}},Re={class:"d-flex align-center gap-x-4"},Ne={key:1},Oe={class:"d-flex flex-column"},ze={class:"text-base"},Fe={class:"text-sm"},Le={class:"d-flex align-center gap-x-2"},Ge={class:"text-capitalize text-high-emphasis text-body-1"},Ye={__name:"index",setup(Qe){const W=ge(),V=s(""),g=s(null),y=s(null),b=s(null),w=s(null),T=s([]),X=async()=>{var o;try{const e=await h("/plans",{method:"GET",params:{per_page:200}});e&&e.status==="success"?T.value=Array.isArray(e.data)?e.data:((o=e.data)==null?void 0:o.data)??e.data??[]:T.value=[]}catch(e){console.error("Error fetching plans",e),T.value=[]}},p=s(10),c=s(1),A=s(),E=s(),z=s([]),ee=o=>{var e,n,m,_;A.value=(n=(e=o.sortBy)==null?void 0:e[0])==null?void 0:n.key,E.value=(_=(m=o.sortBy)==null?void 0:m[0])==null?void 0:_.order},C=s(!1),F=s(""),$=s("success"),v=(o,e="success")=>{F.value=o,$.value=e,C.value=!0},B=s(!1),S=s(null),te=async()=>{S.value&&(await ue(S.value),B.value=!1,S.value=null)},ae=o=>{if(!o)return"غير محدد";const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),m=new Date(o),N=new Date(m.getFullYear(),m.getMonth(),m.getDate()).getTime()-n.getTime(),k=Math.ceil(N/(1e3*60*60*24));return k>0?`متبقي ${k} يوم`:k===0?"ينتهي اليوم":"منتهية"},le=[{title:"المستخدم",key:"user"},{title:"النوع",key:"role"},{title:"عدد الفولدرات",key:"folders",sortable:!1},{title:"عدد الكلمات",key:"words",sortable:!1},{title:"باقة الاشتراك",key:"plan"},{title:"بداية الاشتراك",key:"start_at"},{title:"نهاية الاشتراك",key:"expires_at"},{title:"الوقت المتبقي",key:"remain"},{title:"العمليات",key:"actions",sortable:!1}],P=s([]),x=s(0),M=s(!0),f=async()=>{var o;M.value=!0;try{const e={role:g.value||void 0,search:V.value||void 0,plan_id:y.value||void 0,start_date:b.value||void 0,end_date:w.value||void 0,per_page:p.value,page:c.value,sort_by:A.value||void 0,sort_order:E.value||void 0},n=await h("/users",{method:"GET",params:e});n&&n.status==="success"?(P.value=n.data,x.value=((o=n.meta)==null?void 0:o.total)||0):(P.value=[],x.value=0)}catch(e){console.error("Error fetching users",e),P.value=[],x.value=0}finally{M.value=!1}},oe=()=>{V.value="",g.value=null,y.value=null,b.value=null,w.value=null};_e(async()=>{await X(),f()}),Q([V,g,y,b,w,p,A,E],()=>{c.value=1,f()}),Q(c,()=>{f()});const se=Ve(()=>P.value),R=o=>{const e=o==null?void 0:o.toLowerCase();return e==="subscriber"?{color:"success",icon:"tabler-user"}:e==="author"?{color:"error",icon:"tabler-device-desktop"}:e==="maintainer"?{color:"info",icon:"tabler-chart-pie"}:e==="editor"?{color:"warning",icon:"tabler-edit"}:e==="admin"?{color:"primary",icon:"tabler-crown"}:{color:"primary",icon:"tabler-user"}},L=s(!1),G=s(!1),re=s(null),ne=async o=>{try{await h("/users/store",{method:"POST",body:o}),v("تم اضافة البيانات بنجاح","success"),f()}catch{v("حدث خطأ من فضلك حاول في وقت اخر","error")}},ie=async(o,e)=>{try{await h(`/users/update/${o}`,{method:"POST",body:e}),v("تم تعديل البيانات بنجاح","success"),f()}catch{v("حدث خطأ من فضلك حاول في وقت اخر","error")}},ue=async o=>{try{await h(`/users/delete/${o}`,{method:"POST"}),v("تم الحذف بنجاح","success"),f()}catch{v("حدث خطأ أثناء الحذف","error")}},de=o=>{W.push({name:"admin-users-id",params:{id:o}})};return(o,e)=>{const n=fe,m=ve,_=ce,N=j("RouterLink"),k=j("IconBtn"),me=pe;return D(),Z("section",null,[a(q,{class:"mb-6"},{default:l(()=>[a(ke,{class:"pb-4"},{default:l(()=>[a(H,null,{default:l(()=>e[16]||(e[16]=[i("المستخدمين")])),_:1,__:[16]})]),_:1}),a(J,{class:"d-flex flex-wrap gap-4 align-center"},{default:l(()=>[u("div",Pe,[a(n,{label:"عرض","model-value":p.value,items:[10,25,50,100].map(t=>({value:t,title:t})),style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[0]||(e[0]=t=>p.value=parseInt(t,10))},null,8,["model-value","items"])]),u("div",Ie,[a(m,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=t=>V.value=t),placeholder:"بحث بالاسم أو الايميل",label:"بحث"},null,8,["modelValue"])]),u("div",Ae,[a(n,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=t=>g.value=t),items:[{value:"user",title:"مستخدم"},{value:"admin",title:"مدير"}],label:"النوع",clearable:""},null,8,["modelValue"])]),u("div",Ee,[a(n,{modelValue:y.value,"onUpdate:modelValue":e[3]||(e[3]=t=>y.value=t),items:T.value,"item-value":"id","item-title":"name",label:"الباقة",clearable:"",placeholder:"اختر باقة"},null,8,["modelValue","items"])]),u("div",Se,[a(_,{modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=t=>b.value=t),label:"تاريخ البداية",placeholder:"اختر التاريخ",clearable:""},null,8,["modelValue"])]),u("div",Me,[a(_,{modelValue:w.value,"onUpdate:modelValue":e[5]||(e[5]=t=>w.value=t),label:"تاريخ النهاية",placeholder:"اختر التاريخ",clearable:""},null,8,["modelValue"])]),a(K),a(I,{"prepend-icon":"tabler-rotate-clockwise",variant:"outlined",onClick:oe},{default:l(()=>e[17]||(e[17]=[i(" إعادة تعيين ")])),_:1,__:[17]})]),_:1}),a(Te),a(Ce,{"items-per-page":p.value,"onUpdate:itemsPerPage":e[7]||(e[7]=t=>p.value=t),"model-value":z.value,"onUpdate:modelValue":e[8]||(e[8]=t=>z.value=t),page:c.value,"onUpdate:page":e[9]||(e[9]=t=>c.value=t),items:se.value,"item-value":"id","items-length":x.value,headers:le,class:"text-no-wrap",loading:M.value,"onUpdate:options":ee},{"item.user":l(({item:t})=>[u("div",Re,[a($e,{size:"34",variant:t.avatar?void 0:"tonal",color:t.avatar?void 0:R(t.role).color},{default:l(()=>{var r;return[t.avatar?(D(),O(Be,{key:0,src:t.avatar},null,8,["src"])):(D(),Z("span",Ne,d((r=t.name)==null?void 0:r.charAt(0).toUpperCase()),1))]}),_:2},1032,["variant","color"]),u("div",Oe,[u("h6",ze,[a(N,{to:{name:"apps-user-view-id",params:{id:t.id}},class:"font-weight-medium text-link"},{default:l(()=>[i(d(t.name),1)]),_:2},1032,["to"])]),u("div",Fe,d(t.email),1)])])]),"item.role":l(({item:t})=>[u("div",Le,[a(U,{size:22,icon:R(t.role).icon,color:R(t.role).color},null,8,["icon","color"]),u("div",Ge,d(t.role=="user"?"عميل":"ادمن"),1)])]),"item.plan":l(({item:t})=>{var r,Y;return[i(d(((Y=(r=t.subscription)==null?void 0:r.plan)==null?void 0:Y.name)||"غير مشترك"),1)]}),"item.start_at":l(({item:t})=>{var r;return[i(d(((r=t.subscription)==null?void 0:r.start_date)??"غير محدد"),1)]}),"item.expires_at":l(({item:t})=>{var r;return[i(d(((r=t.subscription)==null?void 0:r.end_date)??"غير محدد"),1)]}),"item.remain":l(({item:t})=>{var r;return[i(d(ae((r=t.subscription)==null?void 0:r.end_date)),1)]}),"item.actions":l(({item:t})=>[a(k,{onClick:r=>de(t.id)},{default:l(()=>[a(U,{icon:"tabler-eye"})]),_:2},1032,["onClick"])]),bottom:l(()=>[a(me,{page:c.value,"onUpdate:page":e[6]||(e[6]=t=>c.value=t),"items-per-page":p.value,"total-items":x.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length","loading"])]),_:1}),a(be,{"is-drawer-open":L.value,"onUpdate:isDrawerOpen":e[10]||(e[10]=t=>L.value=t),onUserData:ne},null,8,["is-drawer-open"]),a(we,{"is-drawer-open":G.value,"onUpdate:isDrawerOpen":e[11]||(e[11]=t=>G.value=t),"user-data":re.value,onUserData:ie},null,8,["is-drawer-open","user-data"]),a(Ue,{modelValue:C.value,"onUpdate:modelValue":e[13]||(e[13]=t=>C.value=t),color:$.value,location:"top end",timeout:"5000"},{prepend:l(()=>[$.value==="success"?(D(),O(U,{key:0,icon:"tabler-check"})):$.value==="error"?(D(),O(U,{key:1,icon:"tabler-alert-circle"})):ye("",!0)]),actions:l(()=>[a(I,{icon:"",variant:"text",color:"white",onClick:e[12]||(e[12]=t=>C.value=!1)},{default:l(()=>[a(U,{icon:"tabler-x"})]),_:1})]),default:l(()=>[i(" "+d(F.value)+" ",1)]),_:1},8,["modelValue","color"]),a(he,{modelValue:B.value,"onUpdate:modelValue":e[15]||(e[15]=t=>B.value=t),"max-width":"500px"},{default:l(()=>[a(q,null,{default:l(()=>[a(H,{class:"text-h6"},{default:l(()=>e[18]||(e[18]=[i(" تأكيد الحذف ")])),_:1,__:[18]}),a(J,null,{default:l(()=>e[19]||(e[19]=[i("هل أنت متأكد أنك تريد حذف هذا المستخدم؟ لا يمكن التراجع عن هذا الإجراء.")])),_:1,__:[19]}),a(De,{class:"px-6 pb-4"},{default:l(()=>[a(K),a(I,{color:"error",variant:"flat",onClick:e[14]||(e[14]=t=>B.value=!1)},{default:l(()=>e[20]||(e[20]=[i(" إلغاء ")])),_:1,__:[20]}),a(I,{color:"success",variant:"flat",onClick:te},{default:l(()=>e[21]||(e[21]=[i(" موافق ")])),_:1,__:[21]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},Yt=xe(Ye,[["__scopeId","data-v-06f736a9"]]);export{Yt as default};
