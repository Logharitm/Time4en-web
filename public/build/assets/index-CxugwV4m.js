import{_ as te}from"./TablePagination-DdKTX9OV.js";import{_ as ae}from"./AppDateTimePicker-Dr5P4Pgx.js";import{_ as le}from"./AppTextField-aZv7gLR1.js";import{_ as oe}from"./AppSelect-Dc5xzrsl.js";import{$ as M}from"./api-CHPjDHzy.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as O,a as re,b as Q,d as ie}from"./VCard-CIKASufN.js";import{V as ne}from"./VSnackbar-nXt_2vgz.js";import{V as ue}from"./VDialog-fBE2blFA.js";import{V as Z}from"./VCardText-DDkz13nn.js";import{V as j}from"./VSpacer-EjYJj1Z_.js";import{r as o,E as de,w as q,c as H,b as a,e as l,o as y,s as n,d as r,a5 as U,t as m,f as S,Z as $,k as me}from"./main-BoNGmApi.js";import{V as pe}from"./VDivider-COJgEHam.js";import{V as ce}from"./VDataTableServer-cQiRBdfY.js";import{V as ve}from"./VAvatar-B4jUlWaz.js";import{V as fe}from"./VImg-C0UW1cvE.js";import{V as _e}from"./VChip-CFWLr0Fc.js";import"./VPagination-g7dDgunw.js";import"./VField-CGulMkEM.js";import"./form-BOCittNv.js";import"./easing-Bybner-F.js";import"./VInput-UNY5FM3D.js";import"./VTextField-DfsZX4z1.js";/* empty css                   */import"./VCounter-BrDhg_jj.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-DvY4lhKB.js";import"./VList-dMazRKTH.js";import"./ssrBoot-CbhHCPX2.js";import"./dialog-transition-DSZfBO75.js";import"./VMenu-Ct53Bckx.js";import"./VOverlay-BEh_8h-6.js";import"./delay-VWJ3yp0p.js";import"./lazy-CCMlf-LN.js";import"./scopeId-9mEpF7-z.js";import"./VCheckboxBtn-CXq9-h6C.js";import"./VSelectionControl-BjjFP2rz.js";import"./index-CvOPxmL5.js";/* empty css              */import"./VDataTable-C6qSTHw6.js";import"./VTable-Bdz8hCOV.js";import"./filter-JpcQOUJD.js";import"./VSlideGroup-BuutOZ8P.js";const Ve={class:"me-3 d-flex gap-3"},ge={style:{"min-width":"200px"}},xe={style:{"min-width":"200px"}},ye={style:{"min-width":"200px"}},be={style:{"min-width":"200px"}},ke={style:{"min-width":"200px"}},we={class:"text-truncate",style:{"max-width":"300px"}},Ce={class:"d-flex align-center gap-x-4"},De={key:1},Ue={class:"d-flex flex-column"},Te={class:"text-base"},he={class:"text-sm"},Be={__name:"index",setup(Ee){const p=o(""),c=o(null),v=o(null),f=o(null),_=o(null),u=o(10),d=o(1),T=o(),h=o();o([]);const J=i=>{var e,s,g,x;T.value=(s=(e=i.sortBy)==null?void 0:e[0])==null?void 0:s.key,h.value=(x=(g=i.sortBy)==null?void 0:g[0])==null?void 0:x.order},b=o(!1),A=o(""),k=o("success"),I=(i,e="success")=>{A.value=i,k.value=e,b.value=!0},w=o(!1),B=o(null),K=async()=>{B.value&&(await Y(B.value),w.value=!1,B.value=null)},W=[{title:"نص الإشعار",key:"message"},{title:"الحالة",key:"status",sortable:!1},{title:"المُستلم",key:"recipient"},{title:"تاريخ الإرسال",key:"created_at"}],C=o([]),V=o(0),E=o(!0),D=async()=>{var i;E.value=!0;try{const e={search:p.value||void 0,is_read:c.value||void 0,recipient:v.value||void 0,start_date:f.value||void 0,end_date:_.value||void 0,per_page:u.value,page:d.value,sort_by:T.value||void 0,sort_order:h.value||void 0},s=await M("/notifications",{method:"GET",params:e});s&&s.status==="success"?(C.value=s.data,V.value=((i=s.meta)==null?void 0:i.total)||(Array.isArray(s.data)?s.data.length:0)):(C.value=[],V.value=0)}catch(e){console.error("Error fetching notifications",e),C.value=[],V.value=0}finally{E.value=!1}},X=()=>{p.value="",c.value=null,v.value=null,f.value=null,_.value=null};de(()=>{D()}),q([p,c,v,f,_,u,T,h],()=>{d.value=1,D()}),q(d,()=>{D()});const Y=async i=>{try{await M(`/notifications/${i}`,{method:"DELETE"}),I("تم الحذف بنجاح","success"),D()}catch{I("حدث خطأ أثناء الحذف","error")}};return(i,e)=>{const s=oe,g=le,x=ae,ee=te;return y(),H("section",null,[a(O,{class:"mb-6"},{default:l(()=>[a(re,{class:"pb-4"},{default:l(()=>[a(Q,null,{default:l(()=>e[13]||(e[13]=[n("الاشعارات")])),_:1,__:[13]})]),_:1}),a(Z,{class:"d-flex flex-wrap gap-4 align-center"},{default:l(()=>[r("div",Ve,[a(s,{label:"عرض","model-value":u.value,items:[10,25,50,100].map(t=>({value:t,title:t})),style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=parseInt(t,10))},null,8,["model-value","items"])]),r("div",ge,[a(g,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=t=>p.value=t),placeholder:"بحث بنص الإشعار",label:"بحث"},null,8,["modelValue"])]),r("div",xe,[a(s,{modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=t=>c.value=t),items:[{value:!1,title:"غير مقروءة"},{value:!0,title:"مقروءة"}],label:"الحالة",clearable:""},null,8,["modelValue"])]),r("div",ye,[a(g,{modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=t=>v.value=t),placeholder:"بحث باسم أو ايميل المستلم",label:"المستلم",clearable:""},null,8,["modelValue"])]),r("div",be,[a(x,{modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=t=>f.value=t),label:"تاريخ البداية",placeholder:"اختر التاريخ",clearable:""},null,8,["modelValue"])]),r("div",ke,[a(x,{modelValue:_.value,"onUpdate:modelValue":e[5]||(e[5]=t=>_.value=t),label:"تاريخ النهاية",placeholder:"اختر التاريخ",clearable:""},null,8,["modelValue"])]),a(j),a(U,{"prepend-icon":"tabler-rotate-clockwise",variant:"outlined",onClick:X},{default:l(()=>e[14]||(e[14]=[n(" إعادة تعيين ")])),_:1,__:[14]})]),_:1}),a(pe),a(ce,{"items-per-page":u.value,"onUpdate:itemsPerPage":e[7]||(e[7]=t=>u.value=t),page:d.value,"onUpdate:page":e[8]||(e[8]=t=>d.value=t),items:C.value,"item-value":"id","items-length":V.value,headers:W,class:"text-no-wrap",loading:E.value,"onUpdate:options":J},{"item.message":l(({item:t})=>[r("div",we,m(t.message),1)]),"item.status":l(({item:t})=>[a(_e,{color:t.is_read?"success":"warning",size:"small",label:""},{default:l(()=>[n(m(t.is_read?"مقروءة":"غير مقروءة"),1)]),_:2},1032,["color"])]),"item.recipient":l(({item:t})=>{var N,P,z,F;return[r("div",Ce,[a(ve,{size:"34",variant:(N=t.user)!=null&&N.avatar?void 0:"tonal",color:(P=t.user)!=null&&P.avatar?void 0:"primary"},{default:l(()=>{var G,L,R;return[(G=t.user)!=null&&G.avatar?(y(),S(fe,{key:0,src:t.user.avatar},null,8,["src"])):(y(),H("span",De,m((R=(L=t.user)==null?void 0:L.name)==null?void 0:R.charAt(0).toUpperCase()),1))]}),_:2},1032,["variant","color"]),r("div",Ue,[r("h6",Te,m((z=t.user)==null?void 0:z.name),1),r("div",he,m((F=t.user)==null?void 0:F.email),1)])])]}),"item.created_at":l(({item:t})=>[n(m(new Date(t.created_at).toLocaleString("ar-EG",{dateStyle:"short",timeStyle:"short"})),1)]),bottom:l(()=>[a(ee,{page:d.value,"onUpdate:page":e[6]||(e[6]=t=>d.value=t),"items-per-page":u.value,"total-items":V.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","items","items-length","loading"])]),_:1}),a(ne,{modelValue:b.value,"onUpdate:modelValue":e[10]||(e[10]=t=>b.value=t),color:k.value,location:"top end",timeout:"5000"},{prepend:l(()=>[k.value==="success"?(y(),S($,{key:0,icon:"tabler-check"})):k.value==="error"?(y(),S($,{key:1,icon:"tabler-alert-circle"})):me("",!0)]),actions:l(()=>[a(U,{icon:"",variant:"text",color:"white",onClick:e[9]||(e[9]=t=>b.value=!1)},{default:l(()=>[a($,{icon:"tabler-x"})]),_:1})]),default:l(()=>[n(" "+m(A.value)+" ",1)]),_:1},8,["modelValue","color"]),a(ue,{modelValue:w.value,"onUpdate:modelValue":e[12]||(e[12]=t=>w.value=t),"max-width":"500px"},{default:l(()=>[a(O,null,{default:l(()=>[a(Q,{class:"text-h6"},{default:l(()=>e[15]||(e[15]=[n(" تأكيد الحذف ")])),_:1,__:[15]}),a(Z,null,{default:l(()=>e[16]||(e[16]=[n("هل أنت متأكد أنك تريد حذف هذا الإشعار؟ لا يمكن التراجع عن هذا الإجراء.")])),_:1,__:[16]}),a(ie,{class:"px-6 pb-4"},{default:l(()=>[a(j),a(U,{color:"error",variant:"flat",onClick:e[11]||(e[11]=t=>w.value=!1)},{default:l(()=>e[17]||(e[17]=[n(" إلغاء ")])),_:1,__:[17]}),a(U,{color:"success",variant:"flat",onClick:K},{default:l(()=>e[18]||(e[18]=[n(" موافق ")])),_:1,__:[18]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},yt=se(Be,[["__scopeId","data-v-e0605454"]]);export{yt as default};
