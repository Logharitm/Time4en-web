import{r as L,e as S}from"./validators-DpYrMFzk.js";import{r as u,u as A,i as M,b4 as N,a as U,c as $,o as P,b as t,e as s,d as l,l as a,G as V,t as R,s as h,a_ as E,aU as G,ae as z,F as H,b5 as _,aZ as O}from"./main-0vQdum3W.js";import{_ as Z}from"./AppTextField-gvJhEt_e.js";import{u as T}from"./useGenerateImageVariant-B5O9x_1B.js";import{a as J,b as K,c as Q,d as W}from"./auth-v2-login-illustration-light-CZAH_Qyi.js";import{m as X,a as Y}from"./misc-mask-light-Bi5cOsdU.js";import{V as ee}from"./VNodeRenderer-DtAw3_AD.js";import{$ as ae}from"./api-Bu9cAkj7.js";import{a as f,V as C}from"./VRow-BJC749nL.js";import{V as te}from"./VImg-DLx6417Q.js";import{V as oe}from"./VCard-B0FIEgQM.js";import{V as I}from"./VCardText-2aUnYOFi.js";import{V as se}from"./VForm-ByJ2Ocas.js";import{V as re}from"./VCheckbox-C3TLp1st.js";import"./helpers-DK5QwNv0.js";import"./form-BOBDXTIA.js";import"./VTextField-Dt27vO3T.js";/* empty css                   */import"./VCounter-1kO9Ejq8.js";import"./VField-ByueHOv2.js";import"./easing-Bybner-F.js";import"./VInput-DtWYPT_L.js";import"./forwardRefs-C-GTDzx5.js";import"./index-CvOPxmL5.js";/* empty css              */import"./VAvatar-CU2kuCTC.js";import"./VCheckboxBtn-B3MFNsTD.js";import"./VSelectionControl-DF6Do3EW.js";const le={class:"auth-logo d-flex align-center gap-x-3"},ie={class:"auth-title"},ne={class:"position-relative bg-background w-100 me-0"},me={class:"d-flex align-center justify-center w-100 h-100",style:{"padding-inline":"6.25rem"}},ue=["src"],de={class:"text-h4 mb-1"},pe={class:"text-capitalize"},ce={class:"d-flex align-center flex-wrap justify-space-between my-6"},Ge={__name:"login",setup(fe){const q=T(W,Q,K,J,!0),F=T(Y,X),d=u(!1),b=A(),v=M(),j=N(),n=u({email:void 0,password:void 0}),w=u(),i=u({email:"",password:""}),g=u(!1),B=async()=>{try{const o=await ae("/login",{method:"POST",body:{email:i.value.email,password:i.value.password},onResponseError({response:c}){var k,x;(k=c._data)!=null&&k.errors?n.value=c._data.errors:(x=c._data)!=null&&x.message&&(n.value={email:[c._data.message]})}}),e=(o==null?void 0:o.data)??o,p=e.accessToken,m=e.userData??{name:e.name,role:e.role,avatar:e.avatar??null,email:i.value.email};let r=[];m.role==="admin"?r=[{action:"manage",subject:"all"}]:r=[{action:"read",subject:"Home"}],_("accessToken").value=p,_("userData").value=m,_("userAbilityRules").value=r,j.update(r);const y=b.query.to?String(b.query.to):"/";v.currentRoute.value.fullPath!==y&&await O(()=>v.replace(y))}catch(o){console.error("Login error:",o),n.value={email:["Something went wrong, please try again."]}}},D=()=>{var o;(o=w.value)==null||o.validate().then(({valid:e})=>{e&&B()})};return(o,e)=>{const p=U("RouterLink"),m=Z;return P(),$(H,null,[t(p,{to:"/"},{default:s(()=>[l("div",le,[t(a(ee),{nodes:a(V).app.logo},null,8,["nodes"]),l("h1",ie,R(a(V).app.title),1)])]),_:1}),t(C,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:s(()=>[t(f,{md:"8",class:"d-none d-md-flex"},{default:s(()=>[l("div",ne,[l("div",me,[t(te,{"max-width":"613",src:a(q),class:"auth-illustration mt-16 mb-2"},null,8,["src"])]),l("img",{class:"auth-footer-mask",src:a(F),alt:"auth-footer-mask",height:"280",width:"100"},null,8,ue)])]),_:1}),t(f,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center"},{default:s(()=>[t(oe,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-4"},{default:s(()=>[t(I,null,{default:s(()=>[l("h4",de,[e[4]||(e[4]=h(" مرحبا بك في ")),l("span",pe,R(a(V).app.title),1)])]),_:1}),t(I,null,{default:s(()=>[t(a(se),{ref_key:"refVForm",ref:w,onSubmit:E(D,["prevent"])},{default:s(()=>[t(C,null,{default:s(()=>[t(f,{cols:"12"},{default:s(()=>[t(m,{modelValue:a(i).email,"onUpdate:modelValue":e[0]||(e[0]=r=>a(i).email=r),label:"البريد الالكتروني",placeholder:"johndoe@email.com",type:"email",autofocus:"",rules:["requiredValidator"in o?o.requiredValidator:a(L),"emailValidator"in o?o.emailValidator:a(S)],"error-messages":a(n).email},null,8,["modelValue","rules","error-messages"])]),_:1}),t(f,{cols:"12"},{default:s(()=>[t(m,{modelValue:a(i).password,"onUpdate:modelValue":e[1]||(e[1]=r=>a(i).password=r),label:"كلمة المرور",placeholder:"············",rules:["requiredValidator"in o?o.requiredValidator:a(L)],type:a(d)?"text":"password",autocomplete:"password","error-messages":a(n).password,"append-inner-icon":a(d)?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[2]||(e[2]=r=>d.value=!a(d))},null,8,["modelValue","rules","type","error-messages","append-inner-icon"]),l("div",ce,[t(re,{modelValue:a(g),"onUpdate:modelValue":e[3]||(e[3]=r=>G(g)?g.value=r:null),label:"تذكرني"},null,8,["modelValue"]),t(p,{class:"text-primary ms-2 mb-1",to:{name:"forgot-password"}},{default:s(()=>e[5]||(e[5]=[h(" هل نسيت كلمة المرور ؟ ")])),_:1,__:[5]})]),t(z,{block:"",type:"submit"},{default:s(()=>e[6]||(e[6]=[h(" تسجيل الدخول ")])),_:1,__:[6]})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})],64)}}};export{Ge as default};
