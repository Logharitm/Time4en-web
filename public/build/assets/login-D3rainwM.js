import{r as w,e as j}from"./validators-DpYrMFzk.js";import{r as u,u as B,i as F,a as S,c as D,o as M,b as t,e as s,d as l,l as e,G as V,t as v,s as g,a_ as A,aU as N,ae as U,F as $,b4 as h,aZ as E}from"./main-CfNsrW5X.js";import{_ as G}from"./AppTextField-1v8EtKwG.js";import{u as y}from"./useGenerateImageVariant-D5Yzr1hI.js";import{a as P,b as z,c as O,d as Z}from"./auth-v2-login-illustration-light-CZAH_Qyi.js";import{a as H,b as J}from"./misc-mask-light-Ha4lQOdV.js";import{V as K}from"./VNodeRenderer-De0LMI05.js";import{u as Q}from"./useAbility-BFlsd3Ha.js";import{$ as W}from"./api-BWXiQTAe.js";import{a as c,V as k}from"./VRow-D9bkbwLr.js";import{V as X}from"./VImg-tZlraYhF.js";import{V as Y}from"./VCard-BwNB_HAq.js";import{V as x}from"./VCardText-UmcD3uX4.js";import{V as ee}from"./VForm-ByAkZWzG.js";import{V as ae}from"./VCheckbox-BeZJMmgk.js";import"./helpers-DK5QwNv0.js";import"./form-Dho8Ouqi.js";import"./VTextField-H4qGtiT3.js";/* empty css                   */import"./VCounter-DPVeqQ4H.js";import"./VField-v42BI7p0.js";import"./easing-Bybner-F.js";import"./VInput-DQO5F0Vq.js";import"./forwardRefs-C-GTDzx5.js";import"./index-CvOPxmL5.js";/* empty css              */import"./VAvatar-Dc7XDQH2.js";import"./VCheckboxBtn-XnaBXv5q.js";import"./VSelectionControl-BXtfCnk7.js";const te={class:"auth-logo d-flex align-center gap-x-3"},oe={class:"auth-title"},se={class:"position-relative bg-background w-100 me-0"},re={class:"d-flex align-center justify-center w-100 h-100",style:{"padding-inline":"6.25rem"}},le=["src"],ie={class:"text-h4 mb-1"},ne={class:"text-capitalize"},me={class:"d-flex align-center flex-wrap justify-space-between my-6"},$e={__name:"login",setup(de){const L=y(Z,O,z,P,!0),T=y(J,H),p=u(!1),_=B(),C=F(),R=Q(),m=u({email:void 0,password:void 0}),b=u(),i=u({email:"",password:""}),f=u(!1),I=async()=>{try{const o=await W("/login",{method:"POST",body:{email:i.value.email,password:i.value.password},onResponseError({response:n}){var d,r;(d=n._data)!=null&&d.errors?m.value=n._data.errors:(r=n._data)!=null&&r.message&&(m.value={email:[n._data.message]})}}),a=o.data.accessToken;h("accessToken").value=a,h("userData").value={name:o.data.name,role:"Admin",email:i.value.email,avatar:o.data.avatar||null},h("userAbilityRules").value=[{action:"manage",subject:"all"}],R.update([{action:"manage",subject:"all"}]),await E(()=>{C.replace(_.query.to?String(_.query.to):"home/dashboard")})}catch(o){console.error("Login error:",o),m.value={email:["Something went wrong, please try again."]}}},q=()=>{var o;(o=b.value)==null||o.validate().then(({valid:a})=>{a&&I()})};return(o,a)=>{const n=S("RouterLink"),d=G;return M(),D($,null,[t(n,{to:"/"},{default:s(()=>[l("div",te,[t(e(K),{nodes:e(V).app.logo},null,8,["nodes"]),l("h1",oe,v(e(V).app.title),1)])]),_:1}),t(k,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:s(()=>[t(c,{md:"8",class:"d-none d-md-flex"},{default:s(()=>[l("div",se,[l("div",re,[t(X,{"max-width":"613",src:e(L),class:"auth-illustration mt-16 mb-2"},null,8,["src"])]),l("img",{class:"auth-footer-mask",src:e(T),alt:"auth-footer-mask",height:"280",width:"100"},null,8,le)])]),_:1}),t(c,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center"},{default:s(()=>[t(Y,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-4"},{default:s(()=>[t(x,null,{default:s(()=>[l("h4",ie,[a[4]||(a[4]=g(" مرحبا بك في ")),l("span",ne,v(e(V).app.title),1)])]),_:1}),t(x,null,{default:s(()=>[t(e(ee),{ref_key:"refVForm",ref:b,onSubmit:A(q,["prevent"])},{default:s(()=>[t(k,null,{default:s(()=>[t(c,{cols:"12"},{default:s(()=>[t(d,{modelValue:e(i).email,"onUpdate:modelValue":a[0]||(a[0]=r=>e(i).email=r),label:"البريد الالكتروني",placeholder:"johndoe@email.com",type:"email",autofocus:"",rules:["requiredValidator"in o?o.requiredValidator:e(w),"emailValidator"in o?o.emailValidator:e(j)],"error-messages":e(m).email},null,8,["modelValue","rules","error-messages"])]),_:1}),t(c,{cols:"12"},{default:s(()=>[t(d,{modelValue:e(i).password,"onUpdate:modelValue":a[1]||(a[1]=r=>e(i).password=r),label:"كلمة المرور",placeholder:"············",rules:["requiredValidator"in o?o.requiredValidator:e(w)],type:e(p)?"text":"password",autocomplete:"password","error-messages":e(m).password,"append-inner-icon":e(p)?"tabler-eye-off":"tabler-eye","onClick:appendInner":a[2]||(a[2]=r=>p.value=!e(p))},null,8,["modelValue","rules","type","error-messages","append-inner-icon"]),l("div",me,[t(ae,{modelValue:e(f),"onUpdate:modelValue":a[3]||(a[3]=r=>N(f)?f.value=r:null),label:"تذكرني"},null,8,["modelValue"]),t(n,{class:"text-primary ms-2 mb-1",to:{name:"forgot-password"}},{default:s(()=>a[5]||(a[5]=[g(" هل نسيت كلمة المرور ؟ ")])),_:1,__:[5]})]),t(U,{block:"",type:"submit"},{default:s(()=>a[6]||(a[6]=[g(" تسجيل الدخول ")])),_:1,__:[6]})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})],64)}}};export{$e as default};
