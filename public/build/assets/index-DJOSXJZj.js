import{_ as ie}from"./TablePagination-Drl8JWrM.js";import{_ as ue}from"./AppDateTimePicker-Dl4DxCJD.js";import{_ as de}from"./AppTextField-BtK_45Yd.js";import{_ as me}from"./AppSelect-BWZy_TjB.js";import{r as s,E as pe,w as Q,V as ce,c as Z,b as a,e as l,i as ve,a as fe,o as D,s as i,d as u,a5 as A,t as d,Z as B,f as O,k as _e}from"./main-B5_k4GpE.js";import Ve from"./AddNewUserDrawer-BqdU2vax.js";import ge from"./EditUserDrawer-CdNJoDCx.js";import{$ as U}from"./api-BNAjheud.js";import{_ as ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as j,a as be,b as q,d as we}from"./VCard-Bv4dJe5S.js";import{V as xe}from"./VSnackbar-vKemk4na.js";import{V as ke}from"./VDialog-ADgZjCWH.js";import{V as H}from"./VCardText-CknN0uU7.js";import{V as J}from"./VSpacer-BAghzqmj.js";import{V as De}from"./VDivider-C-ZLWfpl.js";import{V as Ue}from"./VDataTableServer-BqOFJUMK.js";import{V as Te}from"./VAvatar-bWn95gFY.js";import{V as he}from"./VImg-Cb86Gui7.js";import"./VPagination-CVHAmuwN.js";import"./VField-CvWtN2O_.js";import"./form-DAIQPITd.js";import"./easing-Bybner-F.js";import"./VInput-E3bUw-v6.js";import"./VTextField-DWru8Zir.js";/* empty css                   */import"./VCounter-Kzc7POGj.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-CxHTeF2x.js";import"./VList-CU4JJ1N0.js";import"./ssrBoot-B6mxTEy1.js";import"./dialog-transition-AgoygDbE.js";import"./VMenu-ClNa5w3K.js";import"./VOverlay-CGwfLGZo.js";import"./delay-Du-VFnPC.js";import"./lazy-0Ou_FOdk.js";import"./scopeId-CU0Zb9ir.js";import"./VCheckboxBtn-rtK4_g7K.js";import"./VSelectionControl-ka0NoHKN.js";import"./VChip-BNbIZiHe.js";import"./VSlideGroup-CS2knh2a.js";import"./validators-DpYrMFzk.js";import"./helpers-DK5QwNv0.js";import"./AppDrawerHeaderSection-mlFhqV8Q.js";import"./vue3-perfect-scrollbar-BPJZLzGT.js";import"./VNavigationDrawer-3BEvGEEC.js";import"./VForm-DtOjBCXK.js";import"./VRow-FDPefyAK.js";/* empty css              */import"./index-CvOPxmL5.js";import"./VDataTable-CdEZMhT8.js";import"./VTable-DYOWhEdG.js";import"./filter-BGgpA4Z3.js";const Ce={class:"me-3 d-flex gap-3"},$e={style:{"min-width":"200px"}},Pe={style:{"min-width":"200px"}},Ae={style:{"min-width":"200px"}},Be={style:{"min-width":"200px"}},Ee={style:{"min-width":"200px"}},Ie={class:"d-flex align-center gap-x-4"},Se={key:1},Me={class:"d-flex flex-column"},Re={class:"text-base"},Ne={class:"text-sm"},Oe={class:"d-flex align-center gap-x-2"},ze={class:"text-capitalize text-high-emphasis text-body-1"},Fe={__name:"index",setup(Le){ve();const V=s(""),g=s(null),y=s(null),b=s(null),w=s(null),T=s([]),K=async()=>{var o;try{const e=await U("/plans",{method:"GET",params:{per_page:200}});e&&e.status==="success"?T.value=Array.isArray(e.data)?e.data:((o=e.data)==null?void 0:o.data)??e.data??[]:T.value=[]}catch(e){console.error("Error fetching plans",e),T.value=[]}},p=s(10),c=s(1),E=s(),I=s(),z=s([]),W=o=>{var e,r,m,_;E.value=(r=(e=o.sortBy)==null?void 0:e[0])==null?void 0:r.key,I.value=(_=(m=o.sortBy)==null?void 0:m[0])==null?void 0:_.order},h=s(!1),F=s(""),C=s("success"),v=(o,e="success")=>{F.value=o,C.value=e,h.value=!0},$=s(!1),S=s(null),X=async()=>{S.value&&(await ne(S.value),$.value=!1,S.value=null)},ee=o=>{if(!o)return"غير محدد";const e=new Date,r=new Date(e.getFullYear(),e.getMonth(),e.getDate()),m=new Date(o),N=new Date(m.getFullYear(),m.getMonth(),m.getDate()).getTime()-r.getTime(),k=Math.ceil(N/(1e3*60*60*24));return k>0?`متبقي ${k} يوم`:k===0?"ينتهي اليوم":"منتهية"},te=[{title:"المستخدم",key:"user"},{title:"النوع",key:"role"},{title:"عدد الفولدرات",key:"folders",sortable:!1},{title:"عدد الكلمات",key:"words",sortable:!1},{title:"باقة الاشتراك",key:"plan"},{title:"بداية الاشتراك",key:"start_at"},{title:"نهاية الاشتراك",key:"expires_at"},{title:"الوقت المتبقي",key:"remain"}],P=s([]),x=s(0),M=s(!0),f=async()=>{var o;M.value=!0;try{const e={role:g.value||void 0,search:V.value||void 0,plan_id:y.value||void 0,start_date:b.value||void 0,end_date:w.value||void 0,per_page:p.value,page:c.value,sort_by:E.value||void 0,sort_order:I.value||void 0},r=await U("/users",{method:"GET",params:e});r&&r.status==="success"?(P.value=r.data,x.value=((o=r.meta)==null?void 0:o.total)||0):(P.value=[],x.value=0)}catch(e){console.error("Error fetching users",e),P.value=[],x.value=0}finally{M.value=!1}},ae=()=>{V.value="",g.value=null,y.value=null,b.value=null,w.value=null};pe(async()=>{await K(),f()}),Q([V,g,y,b,w,p,E,I],()=>{c.value=1,f()}),Q(c,()=>{f()});const le=ce(()=>P.value),R=o=>{const e=o==null?void 0:o.toLowerCase();return e==="subscriber"?{color:"success",icon:"tabler-user"}:e==="author"?{color:"error",icon:"tabler-device-desktop"}:e==="maintainer"?{color:"info",icon:"tabler-chart-pie"}:e==="editor"?{color:"warning",icon:"tabler-edit"}:e==="admin"?{color:"primary",icon:"tabler-crown"}:{color:"primary",icon:"tabler-user"}},L=s(!1),G=s(!1),oe=s(null),se=async o=>{try{await U("/users/store",{method:"POST",body:o}),v("تم اضافة البيانات بنجاح","success"),f()}catch{v("حدث خطأ من فضلك حاول في وقت اخر","error")}},re=async(o,e)=>{try{await U(`/users/update/${o}`,{method:"POST",body:e}),v("تم تعديل البيانات بنجاح","success"),f()}catch{v("حدث خطأ من فضلك حاول في وقت اخر","error")}},ne=async o=>{try{await U(`/users/delete/${o}`,{method:"POST"}),v("تم الحذف بنجاح","success"),f()}catch{v("حدث خطأ أثناء الحذف","error")}};return(o,e)=>{const r=me,m=de,_=ue,N=fe("RouterLink"),k=ie;return D(),Z("section",null,[a(j,{class:"mb-6"},{default:l(()=>[a(be,{class:"pb-4"},{default:l(()=>[a(q,null,{default:l(()=>e[16]||(e[16]=[i("المستخدمين")])),_:1,__:[16]})]),_:1}),a(H,{class:"d-flex flex-wrap gap-4 align-center"},{default:l(()=>[u("div",Ce,[a(r,{label:"عرض","model-value":p.value,items:[10,25,50,100].map(t=>({value:t,title:t})),style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[0]||(e[0]=t=>p.value=parseInt(t,10))},null,8,["model-value","items"])]),u("div",$e,[a(m,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=t=>V.value=t),placeholder:"بحث بالاسم أو الايميل",label:"بحث"},null,8,["modelValue"])]),u("div",Pe,[a(r,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=t=>g.value=t),items:[{value:"user",title:"مستخدم"},{value:"admin",title:"مدير"}],label:"النوع",clearable:""},null,8,["modelValue"])]),u("div",Ae,[a(r,{modelValue:y.value,"onUpdate:modelValue":e[3]||(e[3]=t=>y.value=t),items:T.value,"item-value":"id","item-title":"name",label:"الباقة",clearable:"",placeholder:"اختر باقة"},null,8,["modelValue","items"])]),u("div",Be,[a(_,{modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=t=>b.value=t),label:"تاريخ البداية",placeholder:"اختر التاريخ",clearable:""},null,8,["modelValue"])]),u("div",Ee,[a(_,{modelValue:w.value,"onUpdate:modelValue":e[5]||(e[5]=t=>w.value=t),label:"تاريخ النهاية",placeholder:"اختر التاريخ",clearable:""},null,8,["modelValue"])]),a(J),a(A,{"prepend-icon":"tabler-rotate-clockwise",variant:"outlined",onClick:ae},{default:l(()=>e[17]||(e[17]=[i(" إعادة تعيين ")])),_:1,__:[17]})]),_:1}),a(De),a(Ue,{"items-per-page":p.value,"onUpdate:itemsPerPage":e[7]||(e[7]=t=>p.value=t),"model-value":z.value,"onUpdate:modelValue":e[8]||(e[8]=t=>z.value=t),page:c.value,"onUpdate:page":e[9]||(e[9]=t=>c.value=t),items:le.value,"item-value":"id","items-length":x.value,headers:te,class:"text-no-wrap",loading:M.value,"onUpdate:options":W},{"item.user":l(({item:t})=>[u("div",Ie,[a(Te,{size:"34",variant:t.avatar?void 0:"tonal",color:t.avatar?void 0:R(t.role).color},{default:l(()=>{var n;return[t.avatar?(D(),O(he,{key:0,src:t.avatar},null,8,["src"])):(D(),Z("span",Se,d((n=t.name)==null?void 0:n.charAt(0).toUpperCase()),1))]}),_:2},1032,["variant","color"]),u("div",Me,[u("h6",Re,[a(N,{to:{name:"apps-user-view-id",params:{id:t.id}},class:"font-weight-medium text-link"},{default:l(()=>[i(d(t.name),1)]),_:2},1032,["to"])]),u("div",Ne,d(t.email),1)])])]),"item.role":l(({item:t})=>[u("div",Oe,[a(B,{size:22,icon:R(t.role).icon,color:R(t.role).color},null,8,["icon","color"]),u("div",ze,d(t.role=="user"?"عميل":"ادمن"),1)])]),"item.plan":l(({item:t})=>{var n,Y;return[i(d(((Y=(n=t.subscription)==null?void 0:n.plan)==null?void 0:Y.name)||"غير مشترك"),1)]}),"item.start_at":l(({item:t})=>{var n;return[i(d(((n=t.subscription)==null?void 0:n.start_date)??"غير محدد"),1)]}),"item.expires_at":l(({item:t})=>{var n;return[i(d(((n=t.subscription)==null?void 0:n.end_date)??"غير محدد"),1)]}),"item.remain":l(({item:t})=>{var n;return[i(d(ee((n=t.subscription)==null?void 0:n.end_date)),1)]}),"item.actions":l(({item:t})=>e[18]||(e[18]=[])),bottom:l(()=>[a(k,{page:c.value,"onUpdate:page":e[6]||(e[6]=t=>c.value=t),"items-per-page":p.value,"total-items":x.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length","loading"])]),_:1}),a(Ve,{"is-drawer-open":L.value,"onUpdate:isDrawerOpen":e[10]||(e[10]=t=>L.value=t),onUserData:se},null,8,["is-drawer-open"]),a(ge,{"is-drawer-open":G.value,"onUpdate:isDrawerOpen":e[11]||(e[11]=t=>G.value=t),"user-data":oe.value,onUserData:re},null,8,["is-drawer-open","user-data"]),a(xe,{modelValue:h.value,"onUpdate:modelValue":e[13]||(e[13]=t=>h.value=t),color:C.value,location:"top end",timeout:"5000"},{prepend:l(()=>[C.value==="success"?(D(),O(B,{key:0,icon:"tabler-check"})):C.value==="error"?(D(),O(B,{key:1,icon:"tabler-alert-circle"})):_e("",!0)]),actions:l(()=>[a(A,{icon:"",variant:"text",color:"white",onClick:e[12]||(e[12]=t=>h.value=!1)},{default:l(()=>[a(B,{icon:"tabler-x"})]),_:1})]),default:l(()=>[i(" "+d(F.value)+" ",1)]),_:1},8,["modelValue","color"]),a(ke,{modelValue:$.value,"onUpdate:modelValue":e[15]||(e[15]=t=>$.value=t),"max-width":"500px"},{default:l(()=>[a(j,null,{default:l(()=>[a(q,{class:"text-h6"},{default:l(()=>e[19]||(e[19]=[i(" تأكيد الحذف ")])),_:1,__:[19]}),a(H,null,{default:l(()=>e[20]||(e[20]=[i("هل أنت متأكد أنك تريد حذف هذا المستخدم؟ لا يمكن التراجع عن هذا الإجراء.")])),_:1,__:[20]}),a(we,{class:"px-6 pb-4"},{default:l(()=>[a(J),a(A,{color:"error",variant:"flat",onClick:e[14]||(e[14]=t=>$.value=!1)},{default:l(()=>e[21]||(e[21]=[i(" إلغاء ")])),_:1,__:[21]}),a(A,{color:"success",variant:"flat",onClick:X},{default:l(()=>e[22]||(e[22]=[i(" موافق ")])),_:1,__:[22]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},Ft=ye(Fe,[["__scopeId","data-v-5efdb5f3"]]);export{Ft as default};
