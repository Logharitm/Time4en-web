import{_ as T}from"./AppTextField-BWx9dSw2.js";import{_ as U}from"./AppDrawerHeaderSection-D3lbPkyF.js";import{r as n,E as A,w as $,f as h,e as o,o as w,b as l,l as j,ak as q,d as V,c as g,k as M,a5 as y,s as k,t as C,Z as W,ax as H}from"./main-DSzMYLzp.js";import{C as P}from"./vue3-perfect-scrollbar-CD61MQhq.js";import{V as R}from"./VNavigationDrawer-vqJV-mq-.js";import{V as Z}from"./VDivider-Aaq6eqyh.js";import{V as z}from"./VCard-DuhDOrWR.js";import{V as G}from"./VCardText-CYf2INNP.js";import{V as J}from"./VForm-CPPstvq0.js";import{V as K,a as D}from"./VRow-CXKAFC9P.js";import"./form-B1tFRS7d.js";import"./VTextField-CziLb0ab.js";/* empty css                   */import"./VCounter-CgP2sO8g.js";import"./VImg-DNHHYH1j.js";import"./VField-D6MI6Ow5.js";import"./easing-Bybner-F.js";import"./VInput-CPAsoCij.js";import"./forwardRefs-C-GTDzx5.js";import"./VSpacer-C0KMtbqI.js";/* empty css              */import"./VAvatar-CS_wgqDD.js";import"./delay-xKSXn8zt.js";import"./scopeId-D_KEFreD.js";import"./ssrBoot-BftT6orn.js";const L=["value"],Q={class:"d-flex gap-2 align-center"},X={key:0,class:"d-flex gap-2 align-center"},Y={class:"small"},ee={key:1,class:"text-muted small"},ae={key:0,class:"text-danger small mt-1"},Ie={__name:"EditWordDrawer",props:{isDrawerOpen:{type:Boolean,required:!0},wordData:{type:Object,default:()=>({})},folderId:{type:Number,required:!0}},emits:["update:isDrawerOpen","submit-word"],setup(B,{emit:N}){const r=B,x=N,F=n(!1),c=n(),i=n(!1),m=n(r.folderId),u=n(""),d=n(""),I=n(""),s=n(null),p=n(null),f=n(null);A(async()=>{var a;(a=r.wordData)!=null&&a.id&&(u.value=r.wordData.word||"",d.value=r.wordData.translation||"",I.value=r.wordData.example_sentence||"",r.wordData.folder_id&&(m.value=r.wordData.folder_id))}),$(()=>r.wordData,async a=>{a&&Object.keys(a).length>0?(u.value=a.word||"",d.value=a.translation||"",I.value=a.example_sentence||"",a.folder_id&&(m.value=a.folder_id)):O()});const S=a=>{const e=a.target.files[0];e&&(e.type.startsWith("audio/")?(s.value=e,p.value=null):(p.value="الملف يجب أن يكون صوتياً",s.value=null,a.target.value=null))},O=()=>{var a,e;(a=c.value)==null||a.reset(),(e=c.value)==null||e.resetValidation(),m.value=r.folderId,u.value="",d.value="",s.value=null,p.value=null,f.value&&(f.value.value=null),i.value=!1},b=()=>{x("update:isDrawerOpen",!1),H(()=>O())},E=async()=>{var _,v;if(!await((_=c.value)==null?void 0:_.validate())||!((v=r.wordData)!=null&&v.id))return;const e=new FormData;e.append("folder_id",m.value),e.append("word",u.value),e.append("translation",d.value),s.value&&e.append("audio_file",s.value),i.value=!0;try{await x("submit-word",r.wordData.id,e),b()}catch(t){console.error(t)}finally{i.value=!1}};return(a,e)=>{const _=U,v=T;return w(),h(R,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":r.isDrawerOpen,"onUpdate:modelValue":e[5]||(e[5]=t=>x("update:isDrawerOpen",t))},{default:o(()=>[l(_,{title:"تعديل الكلمة",onCancel:b}),l(Z),l(j(P),{options:{wheelPropagation:!1}},{default:o(()=>[l(z,{flat:""},{default:o(()=>[l(G,null,{default:o(()=>[l(J,{ref_key:"refForm",ref:c,modelValue:F.value,"onUpdate:modelValue":e[4]||(e[4]=t=>F.value=t),onSubmit:q(E,["prevent"])},{default:o(()=>[l(K,null,{default:o(()=>[V("input",{type:"hidden",value:m.value},null,8,L),l(D,{cols:"12"},{default:o(()=>[l(v,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),label:"الكلمة",rules:[t=>!!t||"هذا الحقل مطلوب"]},null,8,["modelValue","rules"])]),_:1}),l(D,{cols:"12"},{default:o(()=>[l(v,{modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=t=>d.value=t),label:"الترجمة",rules:[t=>!!t||"هذا الحقل مطلوب"]},null,8,["modelValue","rules"])]),_:1}),l(D,{cols:"12"},{default:o(()=>[V("div",Q,[V("input",{ref_key:"audioInput",ref:f,type:"file",accept:"audio/*",onChange:S,style:{display:"none"}},null,544),l(y,{variant:"outlined",onClick:e[2]||(e[2]=t=>f.value.click())},{default:o(()=>e[6]||(e[6]=[k(" رفع ملف صوت ")])),_:1,__:[6]}),s.value?(w(),g("div",X,[V("span",Y,C(s.value.name),1),l(y,{icon:"",variant:"text",onClick:e[3]||(e[3]=()=>{s.value=null,f.value.value.value=null})},{default:o(()=>[l(W,{icon:"tabler-x"})]),_:1})])):(w(),g("div",ee,"لم يتم اختيار ملف"))]),p.value?(w(),g("div",ae,C(p.value),1)):M("",!0)]),_:1}),l(D,{cols:"12"},{default:o(()=>[l(y,{type:"submit",class:"me-3",loading:i.value,disabled:i.value},{default:o(()=>[k(C(i.value?"جاري التعديل...":"حفظ"),1)]),_:1},8,["loading","disabled"]),l(y,{type:"reset",variant:"tonal",color:"error",onClick:b},{default:o(()=>e[7]||(e[7]=[k(" إلغاء ")])),_:1,__:[7]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};export{Ie as default};
