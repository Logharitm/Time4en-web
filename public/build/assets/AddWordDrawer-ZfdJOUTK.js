import{r as y}from"./validators-DpYrMFzk.js";import{r,E as M,w as W,f as B,e as o,o as f,b as a,l as V,$ as H,k as T,d as C,c as b,a0 as g,s as q,t as U,Z as P,aA as R}from"./main-Hb8XIVRF.js";import{_ as Z}from"./AppTextField-CQr3vq4q.js";import{_ as h}from"./AppSelect-CIRU7Ono.js";import{_ as j}from"./AppDrawerHeaderSection-ChHqonRz.js";import{C as z}from"./vue3-perfect-scrollbar-Bw9auKBj.js";import{$ as x}from"./api-DWtqbNwL.js";import{V as J}from"./VNavigationDrawer-sMq-pydM.js";import{V as K}from"./VDivider-Cf4UjW41.js";import{V as L}from"./VCard-DUPxC2WR.js";import{V as Q}from"./VCardText-1QTsimEb.js";import{V as X}from"./VForm-BvmPyYG0.js";import{V as Y,a as d}from"./VRow-CLyu3EGz.js";import"./helpers-DK5QwNv0.js";import"./form-2JaaAXdy.js";import"./VTextField-ChuAGwZ0.js";/* empty css                   */import"./VCounter-ZugUu--r.js";import"./VImg-Dmr3grH1.js";import"./VField-BozUaRwE.js";import"./easing-Bybner-F.js";import"./VInput-BM2109ea.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-C7b7isbb.js";import"./VList-Dte0qrhd.js";import"./ssrBoot-Df6PafXS.js";import"./VAvatar-CK_iinmj.js";import"./dialog-transition-CeIx901Q.js";import"./VMenu--fyt11cQ.js";import"./VOverlay-DtHbBEyo.js";import"./delay-BDFbLUOd.js";import"./lazy-CepgJUy9.js";import"./scopeId-D_kk_nLK.js";import"./VCheckboxBtn-R_tN2DCj.js";import"./VSelectionControl-Bz0xH2RZ.js";import"./VChip-BsLEiybA.js";import"./VSlideGroup-Gee6pLzD.js";import"./VSpacer-Dka27U5b.js";/* empty css              */import"./index-CvOPxmL5.js";const ee={class:"d-flex gap-2 align-center"},le={key:0,class:"d-flex gap-2 align-center"},ae={class:"small"},te={key:1,class:"text-muted small"},oe={key:0,class:"text-danger small mt-1"},he={__name:"AddWordDrawer",props:{isDrawerOpen:{type:Boolean,required:!0}},emits:["update:isDrawerOpen","word-data"],setup(I,{emit:N}){const O=I,k=N,$=r(!1),c=r(),m=r(null),s=r(null),_=r(""),w=r(""),u=r(null),p=r(null),E=r([]),n=r([]),v=r(null);M(async()=>{try{const l=await x("/users?role=user",{method:"GET"});E.value=l.data||[]}catch(l){console.error("Error fetching users",l)}}),W(m,async l=>{if(l)try{const e=await x(`/folders?user_id=${l}`,{method:"GET"});n.value=e.data||[],s.value=null}catch(e){console.error("Error fetching folders",e),n.value=[],s.value=null}else n.value=[],s.value=null});const S=l=>{const e=l.target.files[0];e&&(e.type.startsWith("audio/")?(u.value=e,p.value=null):(p.value="الملف يجب أن يكون صوتياً",u.value=null,l.target.value=null))},D=()=>{k("update:isDrawerOpen",!1),R(()=>{var l,e;(l=c.value)==null||l.reset(),(e=c.value)==null||e.resetValidation(),m.value=null,s.value=null,_.value="",w.value="",u.value=null,p.value=null,v.value&&(v.value.value=null),n.value=[]})},G=()=>{var l;(l=c.value)==null||l.validate().then(({valid:e})=>{if(e){const i=new FormData;i.append("user_id",m.value),i.append("folder_id",s.value),i.append("word",_.value),i.append("translation",w.value),u.value&&i.append("audio_file",u.value),k("word-data",i),D()}})};return(l,e)=>{const i=j,F=h,A=Z;return f(),B(J,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":O.isDrawerOpen,"onUpdate:modelValue":e[7]||(e[7]=t=>k("update:isDrawerOpen",t))},{default:o(()=>[a(i,{title:"إضافة كلمة جديدة",onCancel:D}),a(K),a(V(z),{options:{wheelPropagation:!1}},{default:o(()=>[a(L,{flat:""},{default:o(()=>[a(Q,null,{default:o(()=>[a(X,{ref_key:"refForm",ref:c,modelValue:$.value,"onUpdate:modelValue":e[6]||(e[6]=t=>$.value=t),onSubmit:H(G,["prevent"])},{default:o(()=>[a(Y,null,{default:o(()=>[a(d,{cols:"12"},{default:o(()=>[a(F,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=t=>m.value=t),items:E.value.map(t=>({value:t.id,title:t.name})),label:"العميل",rules:["requiredValidator"in l?l.requiredValidator:V(y)]},null,8,["modelValue","items","rules"])]),_:1}),n.value.length?(f(),B(d,{key:0,cols:"12"},{default:o(()=>[a(F,{modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value=t),items:n.value.map(t=>({value:t.id,title:t.name})),label:"المجلد",rules:["requiredValidator"in l?l.requiredValidator:V(y)]},null,8,["modelValue","items","rules"])]),_:1})):T("",!0),a(d,{cols:"12"},{default:o(()=>[a(A,{modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=t=>_.value=t),label:"الكلمة",rules:["requiredValidator"in l?l.requiredValidator:V(y)]},null,8,["modelValue","rules"])]),_:1}),a(d,{cols:"12"},{default:o(()=>[a(A,{modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=t=>w.value=t),label:"الترجمة",rules:["requiredValidator"in l?l.requiredValidator:V(y)]},null,8,["modelValue","rules"])]),_:1}),a(d,{cols:"12"},{default:o(()=>[C("div",ee,[C("input",{ref_key:"audioInput",ref:v,type:"file",accept:"audio/*",onChange:S,style:{display:"none"}},null,544),a(g,{variant:"outlined",onClick:e[4]||(e[4]=t=>v.value.click())},{default:o(()=>e[8]||(e[8]=[q(" رفع ملف صوت ")])),_:1,__:[8]}),u.value?(f(),b("div",le,[C("span",ae,U(u.value.name),1),a(g,{icon:"",variant:"text",onClick:e[5]||(e[5]=()=>{u.value=null,v.value.value.value=null})},{default:o(()=>[a(P,{icon:"tabler-x"})]),_:1})])):(f(),b("div",te,"لم يتم اختيار ملف"))]),p.value?(f(),b("div",oe,U(p.value),1)):T("",!0)]),_:1}),a(d,{cols:"12"},{default:o(()=>[a(g,{type:"submit",class:"me-3"},{default:o(()=>e[9]||(e[9]=[q("حفظ")])),_:1,__:[9]}),a(g,{type:"reset",variant:"tonal",color:"error",onClick:D},{default:o(()=>e[10]||(e[10]=[q(" إلغاء ")])),_:1,__:[10]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};export{he as default};
