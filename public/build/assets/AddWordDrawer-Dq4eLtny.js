import{r as y}from"./validators-DpYrMFzk.js";import{r,E as M,w as W,f as T,e as o,o as f,b as a,l as V,a_ as Z,k as U,d as C,c as b,ae as g,s as q,t as x,Z as H,aZ as P}from"./main-0vQdum3W.js";import{_ as R}from"./AppTextField-gvJhEt_e.js";import{_ as h}from"./AppSelect-kmsspWw3.js";import{_ as j}from"./AppDrawerHeaderSection-CoC-5cXl.js";import{C as z}from"./vue3-perfect-scrollbar-DTesLCsq.js";import{$ as A}from"./api-Bu9cAkj7.js";import{V as J}from"./VNavigationDrawer-DkmwQRww.js";import{V as K}from"./VDivider-BjTkQFeN.js";import{V as L}from"./VCard-B0FIEgQM.js";import{V as Q}from"./VCardText-2aUnYOFi.js";import{V as X}from"./VForm-ByJ2Ocas.js";import{V as Y,a as d}from"./VRow-BJC749nL.js";import"./helpers-DK5QwNv0.js";import"./form-BOBDXTIA.js";import"./VTextField-Dt27vO3T.js";/* empty css                   */import"./VCounter-1kO9Ejq8.js";import"./VImg-DLx6417Q.js";import"./VField-ByueHOv2.js";import"./easing-Bybner-F.js";import"./VInput-DtWYPT_L.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-DLwBfv6o.js";import"./VList-glRgkQBq.js";import"./ssrBoot-BbTZXmIo.js";import"./VAvatar-CU2kuCTC.js";import"./dialog-transition-B9SqVvtS.js";import"./VMenu-Bp7x5C0S.js";import"./VOverlay-BbgNkXp-.js";import"./delay-C0XEdUdM.js";import"./lazy-Vb2e14Gv.js";import"./scopeId-BbZfvjVd.js";import"./VCheckboxBtn-B3MFNsTD.js";import"./VSelectionControl-DF6Do3EW.js";import"./VChip-cOQOpo1V.js";import"./VSlideGroup-_0PEsXoi.js";import"./VSpacer-offRCwAk.js";/* empty css              */import"./index-CvOPxmL5.js";const ee={class:"d-flex gap-2 align-center"},le={key:0,class:"d-flex gap-2 align-center"},ae={class:"small"},te={key:1,class:"text-muted small"},oe={key:0,class:"text-danger small mt-1"},he={__name:"AddWordDrawer",props:{isDrawerOpen:{type:Boolean,required:!0}},emits:["update:isDrawerOpen","word-data"],setup(I,{emit:N}){const O=I,k=N,E=r(!1),c=r(),m=r(null),s=r(null),_=r(""),w=r(""),u=r(null),p=r(null),F=r([]),n=r([]),v=r(null);M(async()=>{try{const l=await A("/users?role=user",{method:"GET"});F.value=l.data||[]}catch(l){console.error("Error fetching users",l)}}),W(m,async l=>{if(l)try{const e=await A(`/folders?user_id=${l}`,{method:"GET"});n.value=e.data||[],s.value=null}catch(e){console.error("Error fetching folders",e),n.value=[],s.value=null}else n.value=[],s.value=null});const S=l=>{const e=l.target.files[0];e&&(e.type.startsWith("audio/")?(u.value=e,p.value=null):(p.value="الملف يجب أن يكون صوتياً",u.value=null,l.target.value=null))},D=()=>{k("update:isDrawerOpen",!1),P(()=>{var l,e;(l=c.value)==null||l.reset(),(e=c.value)==null||e.resetValidation(),m.value=null,s.value=null,_.value="",w.value="",u.value=null,p.value=null,v.value&&(v.value.value=null),n.value=[]})},G=()=>{var l;(l=c.value)==null||l.validate().then(({valid:e})=>{if(e){const i=new FormData;i.append("user_id",m.value),i.append("folder_id",s.value),i.append("word",_.value),i.append("translation",w.value),u.value&&i.append("audio_file",u.value),k("word-data",i),D()}})};return(l,e)=>{const i=j,$=h,B=R;return f(),T(J,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":O.isDrawerOpen,"onUpdate:modelValue":e[7]||(e[7]=t=>k("update:isDrawerOpen",t))},{default:o(()=>[a(i,{title:"إضافة كلمة جديدة",onCancel:D}),a(K),a(V(z),{options:{wheelPropagation:!1}},{default:o(()=>[a(L,{flat:""},{default:o(()=>[a(Q,null,{default:o(()=>[a(X,{ref_key:"refForm",ref:c,modelValue:E.value,"onUpdate:modelValue":e[6]||(e[6]=t=>E.value=t),onSubmit:Z(G,["prevent"])},{default:o(()=>[a(Y,null,{default:o(()=>[a(d,{cols:"12"},{default:o(()=>[a($,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=t=>m.value=t),items:F.value.map(t=>({value:t.id,title:t.name})),label:"العميل",rules:["requiredValidator"in l?l.requiredValidator:V(y)]},null,8,["modelValue","items","rules"])]),_:1}),n.value.length?(f(),T(d,{key:0,cols:"12"},{default:o(()=>[a($,{modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value=t),items:n.value.map(t=>({value:t.id,title:t.name})),label:"المجلد",rules:["requiredValidator"in l?l.requiredValidator:V(y)]},null,8,["modelValue","items","rules"])]),_:1})):U("",!0),a(d,{cols:"12"},{default:o(()=>[a(B,{modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=t=>_.value=t),label:"الكلمة",rules:["requiredValidator"in l?l.requiredValidator:V(y)]},null,8,["modelValue","rules"])]),_:1}),a(d,{cols:"12"},{default:o(()=>[a(B,{modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=t=>w.value=t),label:"الترجمة",rules:["requiredValidator"in l?l.requiredValidator:V(y)]},null,8,["modelValue","rules"])]),_:1}),a(d,{cols:"12"},{default:o(()=>[C("div",ee,[C("input",{ref_key:"audioInput",ref:v,type:"file",accept:"audio/*",onChange:S,style:{display:"none"}},null,544),a(g,{variant:"outlined",onClick:e[4]||(e[4]=t=>v.value.click())},{default:o(()=>e[8]||(e[8]=[q(" رفع ملف صوت ")])),_:1,__:[8]}),u.value?(f(),b("div",le,[C("span",ae,x(u.value.name),1),a(g,{icon:"",variant:"text",onClick:e[5]||(e[5]=()=>{u.value=null,v.value.value.value=null})},{default:o(()=>[a(H,{icon:"tabler-x"})]),_:1})])):(f(),b("div",te,"لم يتم اختيار ملف"))]),p.value?(f(),b("div",oe,x(p.value),1)):U("",!0)]),_:1}),a(d,{cols:"12"},{default:o(()=>[a(g,{type:"submit",class:"me-3"},{default:o(()=>e[9]||(e[9]=[q("حفظ")])),_:1,__:[9]}),a(g,{type:"reset",variant:"tonal",color:"error",onClick:D},{default:o(()=>e[10]||(e[10]=[q(" إلغاء ")])),_:1,__:[10]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};export{he as default};
