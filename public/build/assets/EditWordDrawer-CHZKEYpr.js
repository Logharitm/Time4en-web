import{_ as P}from"./AppTextarea-CDg0f_1J.js";import{_ as R}from"./AppTextField-DPTQ7o5I.js";import{_ as Z}from"./AppSelect-Bsoa-5U9.js";import{_ as z}from"./AppDrawerHeaderSection-2h5l2mqK.js";import{r,E as J,w as N,f as I,e as o,o as g,b as t,l as K,$ as L,k as h,d as F,c as S,a0 as k,s as B,t as O,Z as Q,aB as X}from"./main-Ck5OQVpa.js";import{C as Y}from"./vue3-perfect-scrollbar-CiZFivBh.js";import{$ as j}from"./api-DQg2EmU5.js";import{V as ee}from"./VNavigationDrawer-C-wW3eYB.js";import{V as le}from"./VDivider-DCKG-CWy.js";import{V as ae}from"./VCard-CS2sUTs-.js";import{V as te}from"./VCardText-BxC6CEtL.js";import{V as oe}from"./VForm-3anXCUnY.js";import{V as re,a as f}from"./VRow-DQJnEbgC.js";import"./form-CUt863D8.js";import"./VTextarea-C2uhq-yG.js";/* empty css                   */import"./VCounter-DSbfeK1K.js";import"./VImg-CQ2loY3-.js";import"./VField-mvQv7O17.js";import"./easing-Bybner-F.js";import"./VInput-kBbJsbW6.js";import"./forwardRefs-C-GTDzx5.js";import"./VTextField-D8LFvFrU.js";import"./VSelect-BCy5ucG1.js";import"./VList-CzgJmlvl.js";import"./ssrBoot-Bb6TUV6w.js";import"./VAvatar-mdG6NKl9.js";import"./dialog-transition-D1A83k2n.js";import"./VMenu-BhTSAsY1.js";import"./VOverlay-1w9HmcEE.js";import"./delay-CRyF_EI3.js";import"./lazy-CFIJ1jXu.js";import"./scopeId-BVbKgDAe.js";import"./VCheckboxBtn-B3JE3HhG.js";import"./VSelectionControl-XZPXIic8.js";import"./VChip-Bo_gEuo5.js";import"./VSlideGroup-i5VPCPGY.js";import"./VSpacer-DKbOaqBA.js";/* empty css              */import"./index-CvOPxmL5.js";const ue={class:"d-flex gap-2 align-center"},se={key:0,class:"d-flex gap-2 align-center"},ne={class:"small"},ie={key:1,class:"text-muted small"},de={key:0,class:"text-danger small mt-1"},Qe={__name:"EditWordDrawer",props:{isDrawerOpen:{type:Boolean,required:!0},wordData:{type:Object,default:()=>({})}},emits:["update:isDrawerOpen","submit-word"],setup(G,{emit:M}){const s=G,C=M,T=r(!1),b=r(),c=r(!1),u=r(null),n=r(null),_=r(""),w=r(""),V=r(""),i=r(null),y=r(null),U=r([]),d=r([]),D=r(null);let p=!1;J(async()=>{var a;try{const e=await j("/users?role=user",{method:"GET"});U.value=e.data||[],(a=s.wordData)!=null&&a.id&&(u.value=s.wordData.user_id,_.value=s.wordData.word||"",w.value=s.wordData.translation||"",V.value=s.wordData.example_sentence||"",u.value&&(await $(u.value,s.wordData.folder_id),p=!0))}catch(e){console.error("Error fetching users",e)}});const $=async(a,e=null)=>{if(!a){d.value=[],n.value=null;return}try{const m=await j(`/folders?user_id=${a}`,{method:"GET"});d.value=m.data||[],e&&d.value.find(v=>v.id===e)&&!p?n.value=e:p||(n.value=null)}catch(m){console.error("Error fetching folders",m),d.value=[],n.value=null}};N(u,async a=>{if(!a){d.value=[],n.value=null;return}p=!1,await $(a)}),N(()=>s.wordData,async a=>{a&&Object.keys(a).length>0?(u.value=a.user_id||null,_.value=a.word||"",w.value=a.translation||"",V.value=a.example_sentence||"",u.value&&(p=!1,await $(u.value,a.folder_id),p=!0)):A()});const W=a=>{const e=a.target.files[0];e&&(e.type.startsWith("audio/")?(i.value=e,y.value=null):(y.value="الملف يجب أن يكون صوتياً",i.value=null,a.target.value=null))},A=()=>{var a,e;(a=b.value)==null||a.reset(),(e=b.value)==null||e.resetValidation(),u.value=null,n.value=null,_.value="",w.value="",V.value="",i.value=null,y.value=null,D.value&&(D.value.value=null),d.value=[],p=!1,c.value=!1},E=()=>{C("update:isDrawerOpen",!1),X(()=>A())},q=async()=>{var m,v;if(!await((m=b.value)==null?void 0:m.validate())||!((v=s.wordData)!=null&&v.id))return;const e=new FormData;e.append("user_id",u.value),e.append("folder_id",n.value),e.append("word",_.value),e.append("translation",w.value),e.append("example_sentence",V.value),i.value&&e.append("audio_file",i.value),c.value=!0;try{await C("submit-word",s.wordData.id,e),E()}catch(x){console.error(x)}finally{c.value=!1}};return(a,e)=>{const m=z,v=Z,x=R,H=P;return g(),I(ee,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":s.isDrawerOpen,"onUpdate:modelValue":e[8]||(e[8]=l=>C("update:isDrawerOpen",l))},{default:o(()=>[t(m,{title:"تعديل الكلمة",onCancel:E}),t(le),t(K(Y),{options:{wheelPropagation:!1}},{default:o(()=>[t(ae,{flat:""},{default:o(()=>[t(te,null,{default:o(()=>[t(oe,{ref_key:"refForm",ref:b,modelValue:T.value,"onUpdate:modelValue":e[7]||(e[7]=l=>T.value=l),onSubmit:L(q,["prevent"])},{default:o(()=>[t(re,null,{default:o(()=>[t(f,{cols:"12"},{default:o(()=>[t(v,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=l=>u.value=l),items:U.value.map(l=>({value:l.id,title:l.name})),label:"العميل",rules:[l=>!!l||"هذا الحقل مطلوب"]},null,8,["modelValue","items","rules"])]),_:1}),d.value.length?(g(),I(f,{key:0,cols:"12"},{default:o(()=>[t(v,{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=l=>n.value=l),items:d.value.map(l=>({value:l.id,title:l.name})),label:"المجلد",rules:[l=>!!l||"هذا الحقل مطلوب"]},null,8,["modelValue","items","rules"])]),_:1})):h("",!0),t(f,{cols:"12"},{default:o(()=>[t(x,{modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=l=>_.value=l),label:"الكلمة",rules:[l=>!!l||"هذا الحقل مطلوب"]},null,8,["modelValue","rules"])]),_:1}),t(f,{cols:"12"},{default:o(()=>[t(x,{modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=l=>w.value=l),label:"الترجمة",rules:[l=>!!l||"هذا الحقل مطلوب"]},null,8,["modelValue","rules"])]),_:1}),t(f,{cols:"12"},{default:o(()=>[t(H,{modelValue:V.value,"onUpdate:modelValue":e[4]||(e[4]=l=>V.value=l),label:"الجملة"},null,8,["modelValue"])]),_:1}),t(f,{cols:"12"},{default:o(()=>[F("div",ue,[F("input",{ref_key:"audioInput",ref:D,type:"file",accept:"audio/*",onChange:W,style:{display:"none"}},null,544),t(k,{variant:"outlined",onClick:e[5]||(e[5]=l=>D.value.click())},{default:o(()=>e[9]||(e[9]=[B(" رفع ملف صوت ")])),_:1,__:[9]}),i.value?(g(),S("div",se,[F("span",ne,O(i.value.name),1),t(k,{icon:"",variant:"text",onClick:e[6]||(e[6]=()=>{i.value=null,D.value.value.value=null})},{default:o(()=>[t(Q,{icon:"tabler-x"})]),_:1})])):(g(),S("div",ie,"لم يتم اختيار ملف"))]),y.value?(g(),S("div",de,O(y.value),1)):h("",!0)]),_:1}),t(f,{cols:"12"},{default:o(()=>[t(k,{type:"submit",class:"me-3",loading:c.value,disabled:c.value},{default:o(()=>[B(O(c.value?"جاري التعديل...":"حفظ"),1)]),_:1},8,["loading","disabled"]),t(k,{type:"reset",variant:"tonal",color:"error",onClick:E},{default:o(()=>e[10]||(e[10]=[B(" إلغاء ")])),_:1,__:[10]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};export{Qe as default};
