import{r as D}from"./validators-DpYrMFzk.js";import{r,E as M,w as E,f as F,e as o,o as f,b as a,l as w,ak as W,k as $,d as C,c as I,a5 as y,s as b,t as B,Z as H,ax as P}from"./main-DSzMYLzp.js";import{_ as R}from"./AppTextField-BWx9dSw2.js";import{_ as Z}from"./AppSelect-BA5iydIU.js";import{_ as j}from"./AppDrawerHeaderSection-D3lbPkyF.js";import{C as z}from"./vue3-perfect-scrollbar-CD61MQhq.js";import{$ as N}from"./api-DfH6QBqv.js";import{V as J}from"./VNavigationDrawer-vqJV-mq-.js";import{V as K}from"./VDivider-Aaq6eqyh.js";import{V as L}from"./VCard-DuhDOrWR.js";import{V as Q}from"./VCardText-CYf2INNP.js";import{V as X}from"./VForm-CPPstvq0.js";import{V as Y,a as v}from"./VRow-CXKAFC9P.js";import"./helpers-DK5QwNv0.js";import"./form-B1tFRS7d.js";import"./VTextField-CziLb0ab.js";/* empty css                   */import"./VCounter-CgP2sO8g.js";import"./VImg-DNHHYH1j.js";import"./VField-D6MI6Ow5.js";import"./easing-Bybner-F.js";import"./VInput-CPAsoCij.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-D2dW3-oO.js";import"./VList-DKYD3D7n.js";import"./ssrBoot-BftT6orn.js";import"./VAvatar-CS_wgqDD.js";import"./dialog-transition-Bo7gOho2.js";import"./VMenu-C8sperRe.js";import"./VOverlay-B4STW1mc.js";import"./delay-xKSXn8zt.js";import"./lazy-C265PUUC.js";import"./scopeId-D_KEFreD.js";import"./VCheckboxBtn-BPHfXDUK.js";import"./VSelectionControl-l_Y0JvA-.js";import"./VChip-BBSDOnKc.js";import"./VSlideGroup-DP5_Q-g4.js";import"./VSpacer-C0KMtbqI.js";/* empty css              */import"./index-CvOPxmL5.js";const ee={class:"d-flex gap-2 align-center"},le={key:0,class:"d-flex gap-2 align-center"},ae={class:"small"},oe={key:1,class:"text-muted small"},te={key:0,class:"text-danger small mt-1"},Ze={__name:"AddWordDrawer",props:{isDrawerOpen:{type:Boolean,required:!0},folderId:{type:Number,default:null}},emits:["update:isDrawerOpen","word-data"],setup(T,{emit:A}){const n=T,k=A,q=r(!1),c=r(),O=r(null),i=r(n.folderId),V=r(""),_=r(""),u=r(null),m=r(null),S=r([]),d=r([]),p=r(null);M(async()=>{try{const l=await N("/users?role=user",{method:"GET"});S.value=l.data||[]}catch(l){console.error("Error fetching users",l)}}),E(()=>n.folderId,l=>{i.value=l}),E(O,async l=>{if(l)try{const e=await N(`/folders?user_id=${l}`,{method:"GET"});d.value=e.data||[],i.value=null}catch(e){console.error("Error fetching folders",e),d.value=[],i.value=null}else d.value=[],i.value=null});const U=l=>{const e=l.target.files[0];e&&(e.type.startsWith("audio/")?(u.value=e,m.value=null):(m.value="الملف يجب أن يكون صوتياً",u.value=null,l.target.value=null))},g=()=>{k("update:isDrawerOpen",!1),P(()=>{var l,e;(l=c.value)==null||l.reset(),(e=c.value)==null||e.resetValidation(),n.folderId||(i.value=null),V.value="",_.value="",u.value=null,m.value=null,p.value&&(p.value.value=null),n.folderId||(d.value=[])})},h=()=>{var l;(l=c.value)==null||l.validate().then(({valid:e})=>{if(e){const s=new FormData;s.append("folder_id",i.value),s.append("word",V.value),s.append("translation",_.value),u.value&&s.append("audio_file",u.value),k("word-data",s),g()}})};return(l,e)=>{const s=j,G=Z,x=R;return f(),F(J,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":n.isDrawerOpen,"onUpdate:modelValue":e[6]||(e[6]=t=>k("update:isDrawerOpen",t))},{default:o(()=>[a(s,{title:"إضافة كلمة جديدة",onCancel:g}),a(K),a(w(z),{options:{wheelPropagation:!1}},{default:o(()=>[a(L,{flat:""},{default:o(()=>[a(Q,null,{default:o(()=>[a(X,{ref_key:"refForm",ref:c,modelValue:q.value,"onUpdate:modelValue":e[5]||(e[5]=t=>q.value=t),onSubmit:W(h,["prevent"])},{default:o(()=>[a(Y,null,{default:o(()=>[!n.folderId&&d.value.length?(f(),F(v,{key:0,cols:"12"},{default:o(()=>[a(G,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=t=>i.value=t),items:d.value.map(t=>({value:t.id,title:t.name})),label:"المجلد",rules:["requiredValidator"in l?l.requiredValidator:w(D)]},null,8,["modelValue","items","rules"])]),_:1})):$("",!0),a(v,{cols:"12"},{default:o(()=>[a(x,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=t=>V.value=t),label:"الكلمة",rules:["requiredValidator"in l?l.requiredValidator:w(D)]},null,8,["modelValue","rules"])]),_:1}),a(v,{cols:"12"},{default:o(()=>[a(x,{modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=t=>_.value=t),label:"الترجمة",rules:["requiredValidator"in l?l.requiredValidator:w(D)]},null,8,["modelValue","rules"])]),_:1}),a(v,{cols:"12"},{default:o(()=>[C("div",ee,[C("input",{ref_key:"audioInput",ref:p,type:"file",accept:"audio/*",style:{display:"none"},onChange:U},null,544),a(y,{variant:"outlined",onClick:e[3]||(e[3]=t=>p.value.click())},{default:o(()=>e[7]||(e[7]=[b(" رفع ملف صوت ")])),_:1,__:[7]}),u.value?(f(),I("div",le,[C("span",ae,B(u.value.name),1),a(y,{icon:"",variant:"text",onClick:e[4]||(e[4]=()=>{u.value=null,p.value.value.value=null})},{default:o(()=>[a(H,{icon:"tabler-x"})]),_:1})])):(f(),I("div",oe," لم يتم اختيار ملف "))]),m.value?(f(),I("div",te,B(m.value),1)):$("",!0)]),_:1}),a(v,{cols:"12"},{default:o(()=>[a(y,{type:"submit",class:"me-3"},{default:o(()=>e[8]||(e[8]=[b(" حفظ ")])),_:1,__:[8]}),a(y,{type:"reset",variant:"tonal",color:"error",onClick:g},{default:o(()=>e[9]||(e[9]=[b(" إلغاء ")])),_:1,__:[9]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};export{Ze as default};
