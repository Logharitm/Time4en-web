import{r as y}from"./validators-DpYrMFzk.js";import{r,E as M,w as W,f as T,e as o,o as f,b as a,l as V,$ as H,k as U,d as C,c as b,a0 as g,s as q,t as x,Z as P,aB as R}from"./main-Ck5OQVpa.js";import{_ as Z}from"./AppTextField-DPTQ7o5I.js";import{_ as h}from"./AppSelect-Bsoa-5U9.js";import{_ as j}from"./AppDrawerHeaderSection-2h5l2mqK.js";import{C as z}from"./vue3-perfect-scrollbar-CiZFivBh.js";import{$ as A}from"./api-DQg2EmU5.js";import{V as J}from"./VNavigationDrawer-C-wW3eYB.js";import{V as K}from"./VDivider-DCKG-CWy.js";import{V as L}from"./VCard-CS2sUTs-.js";import{V as Q}from"./VCardText-BxC6CEtL.js";import{V as X}from"./VForm-3anXCUnY.js";import{V as Y,a as d}from"./VRow-DQJnEbgC.js";import"./helpers-DK5QwNv0.js";import"./form-CUt863D8.js";import"./VTextField-D8LFvFrU.js";/* empty css                   */import"./VCounter-DSbfeK1K.js";import"./VImg-CQ2loY3-.js";import"./VField-mvQv7O17.js";import"./easing-Bybner-F.js";import"./VInput-kBbJsbW6.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-BCy5ucG1.js";import"./VList-CzgJmlvl.js";import"./ssrBoot-Bb6TUV6w.js";import"./VAvatar-mdG6NKl9.js";import"./dialog-transition-D1A83k2n.js";import"./VMenu-BhTSAsY1.js";import"./VOverlay-1w9HmcEE.js";import"./delay-CRyF_EI3.js";import"./lazy-CFIJ1jXu.js";import"./scopeId-BVbKgDAe.js";import"./VCheckboxBtn-B3JE3HhG.js";import"./VSelectionControl-XZPXIic8.js";import"./VChip-Bo_gEuo5.js";import"./VSlideGroup-i5VPCPGY.js";import"./VSpacer-DKbOaqBA.js";/* empty css              */import"./index-CvOPxmL5.js";const ee={class:"d-flex gap-2 align-center"},le={key:0,class:"d-flex gap-2 align-center"},ae={class:"small"},te={key:1,class:"text-muted small"},oe={key:0,class:"text-danger small mt-1"},he={__name:"AddWordDrawer",props:{isDrawerOpen:{type:Boolean,required:!0}},emits:["update:isDrawerOpen","word-data"],setup(I,{emit:N}){const O=I,k=N,$=r(!1),c=r(),m=r(null),s=r(null),_=r(""),w=r(""),u=r(null),p=r(null),B=r([]),n=r([]),v=r(null);M(async()=>{try{const l=await A("/users?role=user",{method:"GET"});B.value=l.data||[]}catch(l){console.error("Error fetching users",l)}}),W(m,async l=>{if(l)try{const e=await A(`/folders?user_id=${l}`,{method:"GET"});n.value=e.data||[],s.value=null}catch(e){console.error("Error fetching folders",e),n.value=[],s.value=null}else n.value=[],s.value=null});const S=l=>{const e=l.target.files[0];e&&(e.type.startsWith("audio/")?(u.value=e,p.value=null):(p.value="الملف يجب أن يكون صوتياً",u.value=null,l.target.value=null))},D=()=>{k("update:isDrawerOpen",!1),R(()=>{var l,e;(l=c.value)==null||l.reset(),(e=c.value)==null||e.resetValidation(),m.value=null,s.value=null,_.value="",w.value="",u.value=null,p.value=null,v.value&&(v.value.value=null),n.value=[]})},G=()=>{var l;(l=c.value)==null||l.validate().then(({valid:e})=>{if(e){const i=new FormData;i.append("user_id",m.value),i.append("folder_id",s.value),i.append("word",_.value),i.append("translation",w.value),u.value&&i.append("audio_file",u.value),k("word-data",i),D()}})};return(l,e)=>{const i=j,E=h,F=Z;return f(),T(J,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":O.isDrawerOpen,"onUpdate:modelValue":e[7]||(e[7]=t=>k("update:isDrawerOpen",t))},{default:o(()=>[a(i,{title:"إضافة كلمة جديدة",onCancel:D}),a(K),a(V(z),{options:{wheelPropagation:!1}},{default:o(()=>[a(L,{flat:""},{default:o(()=>[a(Q,null,{default:o(()=>[a(X,{ref_key:"refForm",ref:c,modelValue:$.value,"onUpdate:modelValue":e[6]||(e[6]=t=>$.value=t),onSubmit:H(G,["prevent"])},{default:o(()=>[a(Y,null,{default:o(()=>[a(d,{cols:"12"},{default:o(()=>[a(E,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=t=>m.value=t),items:B.value.map(t=>({value:t.id,title:t.name})),label:"العميل",rules:["requiredValidator"in l?l.requiredValidator:V(y)]},null,8,["modelValue","items","rules"])]),_:1}),n.value.length?(f(),T(d,{key:0,cols:"12"},{default:o(()=>[a(E,{modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value=t),items:n.value.map(t=>({value:t.id,title:t.name})),label:"المجلد",rules:["requiredValidator"in l?l.requiredValidator:V(y)]},null,8,["modelValue","items","rules"])]),_:1})):U("",!0),a(d,{cols:"12"},{default:o(()=>[a(F,{modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=t=>_.value=t),label:"الكلمة",rules:["requiredValidator"in l?l.requiredValidator:V(y)]},null,8,["modelValue","rules"])]),_:1}),a(d,{cols:"12"},{default:o(()=>[a(F,{modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=t=>w.value=t),label:"الترجمة",rules:["requiredValidator"in l?l.requiredValidator:V(y)]},null,8,["modelValue","rules"])]),_:1}),a(d,{cols:"12"},{default:o(()=>[C("div",ee,[C("input",{ref_key:"audioInput",ref:v,type:"file",accept:"audio/*",onChange:S,style:{display:"none"}},null,544),a(g,{variant:"outlined",onClick:e[4]||(e[4]=t=>v.value.click())},{default:o(()=>e[8]||(e[8]=[q(" رفع ملف صوت ")])),_:1,__:[8]}),u.value?(f(),b("div",le,[C("span",ae,x(u.value.name),1),a(g,{icon:"",variant:"text",onClick:e[5]||(e[5]=()=>{u.value=null,v.value.value.value=null})},{default:o(()=>[a(P,{icon:"tabler-x"})]),_:1})])):(f(),b("div",te,"لم يتم اختيار ملف"))]),p.value?(f(),b("div",oe,x(p.value),1)):U("",!0)]),_:1}),a(d,{cols:"12"},{default:o(()=>[a(g,{type:"submit",class:"me-3"},{default:o(()=>e[9]||(e[9]=[q("حفظ")])),_:1,__:[9]}),a(g,{type:"reset",variant:"tonal",color:"error",onClick:D},{default:o(()=>e[10]||(e[10]=[q(" إلغاء ")])),_:1,__:[10]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};export{he as default};
