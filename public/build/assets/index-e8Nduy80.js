import{_ as te}from"./TablePagination-Bb4okfSq.js";import{_ as ae}from"./AppTextField-B5LmAI45.js";import{_ as oe}from"./AppSelect-CGoPXjiF.js";import{r,E as se,w as re,V as le,c as R,b as a,e as o,i as ie,a as ne,o as f,s as p,d as i,a5 as h,Z as m,t as u,f as k}from"./main-D7GZrFPc.js";import ue from"./AddNewUserDrawer-CvSz-szM.js";import de from"./EditUserDrawer-B5Ntt0nS.js";import{$ as U}from"./api-BeHJEbM3.js";import{V as F,a as pe,b as L,d as me}from"./VCard-DT64k4Cz.js";import{V as ce}from"./VSnackbar-CDTIPFgy.js";import{V as ve}from"./VDialog-DROIvLHD.js";import{V as Y}from"./VCardText-CefwAUfD.js";import{V as G}from"./VSpacer-CeMEN20F.js";import{V as fe}from"./VDivider-wc9HqgK5.js";import{V as ge}from"./VDataTableServer-BT8_TwfA.js";import{V as _e}from"./VAvatar-BLMjzrgb.js";import{V as xe}from"./VImg-BKWqwFT8.js";import"./VPagination-DLw8Gp0K.js";import"./form-oozAywB0.js";import"./VTextField-DRRTeVyU.js";/* empty css                   */import"./VCounter-36TneYEq.js";import"./VField-Dtz92r7N.js";import"./easing-Bybner-F.js";import"./VInput-DMUQC4_n.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-AMYQbzZG.js";import"./VList-F9p1vbvQ.js";import"./ssrBoot-BVP4G8eg.js";import"./dialog-transition-Cnq99lTQ.js";import"./VMenu-CA2MFpOx.js";import"./VOverlay-BG3xaAKI.js";import"./delay-DQPnD_CU.js";import"./lazy-DF7vD1w0.js";import"./scopeId-BZ6pJ2T2.js";import"./VCheckboxBtn-5Z1sZGey.js";import"./VSelectionControl-C9fnzau3.js";import"./VChip-udoLMTLN.js";import"./VSlideGroup-BYMKBCqk.js";import"./validators-DpYrMFzk.js";import"./helpers-DK5QwNv0.js";import"./AppDrawerHeaderSection-B0imzD_d.js";import"./vue3-perfect-scrollbar-0fVAVACI.js";import"./VNavigationDrawer-CzYrM_bp.js";import"./VForm-hfu_i-lW.js";import"./VRow-vQlp5R9K.js";/* empty css              */import"./index-CvOPxmL5.js";import"./VDataTable-DmV80qoC.js";import"./VTable--Nvmegqn.js";import"./filter-Deo4j4hx.js";const ye={class:"me-3 d-flex gap-3"},Ve={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},be={style:{"inline-size":"15.625rem"}},we={class:"d-flex align-center gap-x-4"},De={key:1},he={class:"d-flex flex-column"},ke={class:"text-base"},Ue={class:"text-sm"},Ce={class:"d-flex align-center gap-x-2"},Te={class:"text-body-1 text-high-emphasis text-capitalize"},$e={class:"text-body-1 text-high-emphasis"},Be={class:"text-body-1 text-high-emphasis"},Ie={class:"text-body-1 text-high-emphasis"},$t={__name:"index",setup(Ee){ie();const y=r(""),d=r(10),c=r(1),C=r(),T=r(),V=r([]),Q=s=>{var e,n;C.value=(e=s.sortBy[0])==null?void 0:e.key,T.value=(n=s.sortBy[0])==null?void 0:n.order},b=r(!1),S=r(""),w=r("success"),v=(s,e="success")=>{S.value=s,w.value=e,b.value=!0},g=r(!1),D=r(null),Z=s=>{D.value=s,g.value=!0},j=async()=>{D.value&&(await W(D.value),g.value=!1,D.value=null)},q=s=>{if(!s)return"غير محدد";const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),x=new Date(s),M=new Date(x.getFullYear(),x.getMonth(),x.getDate()).getTime()-n.getTime(),t=Math.ceil(M/(1e3*60*60*24));return t>0?`متبقي ${t} يوم`:t===0?"ينتهي اليوم":"منتهية"},H=[{title:"الادمن",key:"user"},{title:"النوع",key:"role"},{title:"البريد الالكتروني",key:"email"},{title:"العمليات",key:"actions",sortable:!1}],z=r([]),$=r(0),B=r(!0),_=async()=>{var s;B.value=!0;try{const e=await U("/users",{method:"GET",params:{role:"admin",search:y.value,per_page:d.value,page:c.value,sort_by:C.value,sort_order:T.value}});e.status==="success"&&(z.value=e.data,$.value=((s=e.meta)==null?void 0:s.total)||0)}catch(e){console.error("Error fetching users",e)}finally{B.value=!1}};se(_),re([y,d,c,C,T],_);const J=le(()=>z.value),I=s=>(s==null?void 0:s.toLowerCase())==="admin"?{color:"primary",icon:"tabler-crown"}:{color:"primary",icon:"tabler-user"},E=r(!1),K=async s=>{try{await U("/users/store",{method:"POST",body:s}),v("تم اضافة البيانات بنجاح","success"),_()}catch{v("حدث خطأ من فضلك حاول في وقت اخر","error")}},W=async s=>{try{await U(`/users/delete/${s}`,{method:"POST"});const e=V.value.findIndex(n=>n===s);e!==-1&&V.value.splice(e,1),v("تم الحذف بنجاح","success"),_()}catch(e){console.error("Error deleting user:",e),v("حدث خطأ أثناء الحذف","error")}},P=r(!1),O=r(null),X=s=>{O.value=s,P.value=!0},ee=async(s,e)=>{try{await U(`/users/update/${s}`,{method:"POST",body:e}),v("تم تعديل البيانات بنجاح","success"),_()}catch{v("حدث خطأ من فضلك حاول في وقت اخر","error")}};return(s,e)=>{const n=oe,x=ae,A=ne("IconBtn"),M=te;return f(),R("section",null,[a(F,{class:"mb-6"},{default:o(()=>[a(pe,{class:"pb-4"},{default:o(()=>[a(L,null,{default:o(()=>e[13]||(e[13]=[p("الادمن")])),_:1,__:[13]})]),_:1}),a(Y,{class:"d-flex flex-wrap gap-4"},{default:o(()=>[i("div",ye,[a(n,{"model-value":d.value,items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"All"}],style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[0]||(e[0]=t=>d.value=parseInt(t,10))},null,8,["model-value"])]),a(G),i("div",Ve,[i("div",be,[a(x,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=t=>y.value=t),placeholder:"بحث"},null,8,["modelValue"])]),a(h,{"prepend-icon":"tabler-plus",onClick:e[2]||(e[2]=t=>E.value=!0)},{default:o(()=>e[14]||(e[14]=[p(" اضافة ادمن جديد ")])),_:1,__:[14]})])]),_:1}),a(fe),a(ge,{"items-per-page":d.value,"onUpdate:itemsPerPage":e[4]||(e[4]=t=>d.value=t),"model-value":V.value,"onUpdate:modelValue":e[5]||(e[5]=t=>V.value=t),page:c.value,"onUpdate:page":e[6]||(e[6]=t=>c.value=t),items:J.value,"item-value":"id","items-length":$.value,headers:H,class:"text-no-wrap",loading:B.value,"onUpdate:options":Q},{"item.user":o(({item:t})=>[i("div",we,[a(_e,{size:"34",variant:t.avatar?void 0:"tonal",color:t.avatar?void 0:I(t.role).color},{default:o(()=>{var l;return[t.avatar?(f(),k(xe,{key:0,src:t.avatar},null,8,["src"])):(f(),R("span",De,u((l=t.name)==null?void 0:l.charAt(0).toUpperCase()),1))]}),_:2},1032,["variant","color"]),i("div",he,[i("h6",ke,u(t.name),1),i("div",Ue,u(t.email),1)])])]),"item.role":o(({item:t})=>[i("div",Ce,[a(m,{size:22,icon:I(t.role).icon,color:I(t.role).color},null,8,["icon","color"]),e[15]||(e[15]=i("div",{class:"text-capitalize text-high-emphasis text-body-1"}," ادمن ",-1))])]),"item.plan":o(({item:t})=>{var l,N;return[i("div",Te,u(((N=(l=t.subscription)==null?void 0:l.plan)==null?void 0:N.name)||"غير مشترك"),1)]}),"item.start_at":o(({item:t})=>{var l;return[i("div",$e,u(((l=t.subscription)==null?void 0:l.start_date)??"غير محدد"),1)]}),"item.expires_at":o(({item:t})=>{var l;return[i("div",Be,u(((l=t.subscription)==null?void 0:l.end_date)??"غير محدد"),1)]}),"item.remain":o(({item:t})=>{var l;return[i("div",Ie,u(q((l=t.subscription)==null?void 0:l.end_date)),1)]}),"item.actions":o(({item:t})=>[a(A,{onClick:l=>X(t)},{default:o(()=>[a(m,{icon:"tabler-pencil"})]),_:2},1032,["onClick"]),a(A,{onClick:l=>Z(t.id)},{default:o(()=>[a(m,{icon:"tabler-trash"})]),_:2},1032,["onClick"])]),bottom:o(()=>[a(M,{page:c.value,"onUpdate:page":e[3]||(e[3]=t=>c.value=t),"items-per-page":d.value,"total-items":$.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length","loading"])]),_:1}),a(ue,{"is-drawer-open":E.value,"onUpdate:isDrawerOpen":e[7]||(e[7]=t=>E.value=t),onUserData:K},null,8,["is-drawer-open"]),a(de,{"is-drawer-open":P.value,"onUpdate:isDrawerOpen":e[8]||(e[8]=t=>P.value=t),"user-data":O.value,onUserData:ee},null,8,["is-drawer-open","user-data"]),a(ce,{modelValue:b.value,"onUpdate:modelValue":e[10]||(e[10]=t=>b.value=t),color:w.value,location:"top end",timeout:"5000"},{prepend:o(()=>[w.value==="success"?(f(),k(m,{key:0,icon:"tabler-check"})):w.value==="error"?(f(),k(m,{key:1,icon:"tabler-alert-circle"})):(f(),k(m,{key:2,icon:"tabler-info-circle"}))]),actions:o(()=>[a(h,{icon:"",variant:"text",color:"white",onClick:e[9]||(e[9]=t=>b.value=!1)},{default:o(()=>[a(m,{icon:"tabler-x"})]),_:1})]),default:o(()=>[p(" "+u(S.value)+" ",1)]),_:1},8,["modelValue","color"]),a(ve,{modelValue:g.value,"onUpdate:modelValue":e[12]||(e[12]=t=>g.value=t),"max-width":"500px"},{default:o(()=>[a(F,null,{default:o(()=>[a(L,{class:"text-h6"},{default:o(()=>e[16]||(e[16]=[p(" تأكيد الحذف ")])),_:1,__:[16]}),a(Y,null,{default:o(()=>e[17]||(e[17]=[p(" هل أنت متأكد أنك تريد حذف هذا الادمن؟ لا يمكن التراجع عن هذا الإجراء. ")])),_:1,__:[17]}),a(me,{class:"px-6 pb-4"},{default:o(()=>[a(G),a(h,{color:"error",variant:"flat",onClick:e[11]||(e[11]=t=>g.value=!1)},{default:o(()=>e[18]||(e[18]=[p(" إلغاء ")])),_:1,__:[18]}),a(h,{color:"success",variant:"flat",onClick:j},{default:o(()=>e[19]||(e[19]=[p(" موافق ")])),_:1,__:[19]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{$t as default};
