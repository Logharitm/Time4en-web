import{_ as B}from"./AppTextField-kQMYcegG.js";import{aA as M,r as d,E as O,c as P,o as i,b as e,e as a,s as S,t as _,a5 as b,Z as v,f as g,cB as R,d as x,l as c,ak as F,F as U,a3 as G,h as Z}from"./main-DhBDkIM8.js";import{$ as I}from"./api-xPQ-H3zP.js";import{V as D}from"./VSnackbar-Byr28B1s.js";import{a as E,V as T}from"./VRow-C6eZT6ii.js";import{V as L}from"./VCard-ZO35TGNH.js";import{V as C}from"./VCardText-86VRgrq3.js";import{V as q}from"./VAvatar-BWy3UfGn.js";import{V as N}from"./VForm-BZNpj7K9.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"d-flex flex-column justify-center gap-4"},K={class:"d-flex flex-wrap gap-4"},Q={class:"d-none d-sm-block"},W={class:"d-none d-sm-block"},X={class:"text-body-1 mb-0"},ie={__name:"AccountSettingsAccount",setup(j){const{t}=M(),w=d(),y=d(!1),V=d(!1),m=d(!1),A=d(""),h=d("success"),o=d({name:"",email:"",language:"",role:"",avatar:null,avatarPreview:null}),n=async()=>{var p;y.value=!0;try{const l=await I("/user",{method:"GET"}),s=(p=l==null?void 0:l.data)==null?void 0:p.user;s&&(o.value.name=s.name,o.value.email=s.email,o.value.language=s.language||"en",o.value.role=s.role,o.value.avatar=s.avatar)}catch(l){console.error("Error fetching user:",l)}finally{y.value=!1}},u=(p,l="success")=>{A.value=p,h.value=l,m.value=!0},r=async()=>{var p;V.value=!0;try{const l=new FormData;l.append("name",o.value.name),l.append("email",o.value.email),l.append("language","ar"),o.value.avatar instanceof File?l.append("avatar",o.value.avatar):l.append("avatar","");const s=await I("/update-profile",{method:"POST",body:l});u(t("profile.successMessage"),"success"),(p=s==null?void 0:s.data)!=null&&p.user&&(G("userData").value={name:s.data.user.name,role:s.data.user.role,email:s.data.user.email,avatar:s.data.user.avatar||null})}catch(l){console.error("Error updating profile:",l),u(t("profile.errorMessage"),"error")}finally{V.value=!1}},f=p=>{const{files:l}=p.target;l&&l.length&&(o.value.avatar=l[0],o.value.avatarPreview=URL.createObjectURL(l[0]))},z=()=>{o.value.avatar=null,o.value.avatarPreview=null,w.value.value=""};return O(()=>{n()}),(p,l)=>{const s=B;return i(),P(U,null,[e(D,{modelValue:m.value,"onUpdate:modelValue":l[1]||(l[1]=k=>m.value=k),color:h.value,location:"top end",timeout:"5000"},{prepend:a(()=>[h.value==="success"?(i(),g(v,{key:0,icon:"tabler-check"})):h.value==="error"?(i(),g(v,{key:1,icon:"tabler-alert-circle"})):(i(),g(v,{key:2,icon:"tabler-info-circle"}))]),actions:a(()=>[e(b,{icon:"",variant:"text",color:"white",onClick:l[0]||(l[0]=k=>m.value=!1)},{default:a(()=>[e(v,{icon:"tabler-x"})]),_:1})]),default:a(()=>[S(" "+_(A.value)+" ",1)]),_:1},8,["modelValue","color"]),e(T,null,{default:a(()=>[e(E,{cols:"12"},{default:a(()=>[e(L,null,{default:a(()=>[y.value?(i(),g(C,{key:0},{default:a(()=>[e(R,{indeterminate:"",color:"primary"})]),_:1})):(i(),g(C,{key:1,class:"d-flex"},{default:a(()=>[e(q,{rounded:"",size:"100",class:"me-6",image:o.value.avatarPreview||o.value.avatar||"/default-avatar.png"},null,8,["image"]),x("form",J,[x("div",K,[e(b,{color:"primary",size:"small",onClick:l[2]||(l[2]=k=>{var $;return($=w.value)==null?void 0:$.click()})},{default:a(()=>[e(v,{icon:"tabler-cloud-upload",class:"d-sm-none"}),x("span",Q,_(c(t)("profile.uploadPhoto")),1)]),_:1}),x("input",{ref_key:"refInputEl",ref:w,type:"file",accept:".jpeg,.png,.jpg,.gif",hidden:"",onInput:f},null,544),e(b,{type:"reset",size:"small",color:"secondary",variant:"tonal",onClick:z},{default:a(()=>[x("span",W,_(c(t)("profile.cancel")),1),e(v,{icon:"tabler-refresh",class:"d-sm-none"})]),_:1})]),x("p",X,_(c(t)("profile.allowedFormats")),1)])]),_:1})),e(C,{class:"pt-2"},{default:a(()=>[e(N,{class:"mt-3",onSubmit:F(r,["prevent"])},{default:a(()=>[e(T,null,{default:a(()=>[e(E,{cols:"12",md:"6"},{default:a(()=>[e(s,{modelValue:o.value.name,"onUpdate:modelValue":l[3]||(l[3]=k=>o.value.name=k),label:c(t)("profile.name"),placeholder:c(t)("profile.enterName")},null,8,["modelValue","label","placeholder"])]),_:1}),e(E,{cols:"12",md:"6"},{default:a(()=>[e(s,{modelValue:o.value.email,"onUpdate:modelValue":l[4]||(l[4]=k=>o.value.email=k),label:c(t)("profile.email"),placeholder:c(t)("profile.enterEmail"),type:"email"},null,8,["modelValue","label","placeholder"])]),_:1}),e(C,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:a(()=>[e(b,{type:"submit",loading:V.value},{default:a(()=>[S(_(c(t)("profile.saveChanges")),1)]),_:1},8,["loading"]),e(b,{color:"secondary",variant:"tonal",disabled:V.value,onClick:F(n,["prevent"])},{default:a(()=>[S(_(c(t)("profile.cancelChanges")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64)}}},Y={__name:"AccountSettingsSecurity",setup(j){const{t}=M(),w=d([{key:"current_password",label:t("password.current"),value:"",visible:!1},{key:"new_password",label:t("password.new"),value:"",visible:!1},{key:"new_password_confirmation",label:t("password.confirmNew"),value:"",visible:!1}]),y=d(!1),V=d(""),m=d("success"),A=(o,n="success")=>{V.value=o,m.value=n,y.value=!0},h=async()=>{var o,n;try{const u={};w.value.forEach(f=>{u[f.key]=f.value});const r=await I("/change-password",{method:"POST",body:u});A(r.data.message||t("password.successMessage"),"success"),w.value.forEach(f=>f.value="")}catch(u){console.error("Error updating password:",u),A(((n=(o=u==null?void 0:u.response)==null?void 0:o._data)==null?void 0:n.message)||t("password.errorMessage"),"error")}};return(o,n)=>{const u=B;return i(),P(U,null,[e(D,{modelValue:y.value,"onUpdate:modelValue":n[1]||(n[1]=r=>y.value=r),color:m.value,location:"top end",timeout:"5000"},{prepend:a(()=>[m.value==="success"?(i(),g(v,{key:0,icon:"tabler-check"})):m.value==="error"?(i(),g(v,{key:1,icon:"tabler-alert-circle"})):(i(),g(v,{key:2,icon:"tabler-info-circle"}))]),actions:a(()=>[e(b,{icon:"",variant:"text",color:"white",onClick:n[0]||(n[0]=r=>y.value=!1)},{default:a(()=>[e(v,{icon:"tabler-x"})]),_:1})]),default:a(()=>[S(" "+_(V.value)+" ",1)]),_:1},8,["modelValue","color"]),e(T,null,{default:a(()=>[e(E,{cols:"12"},{default:a(()=>[e(L,{title:c(t)("password.title")},{default:a(()=>[e(N,{onSubmit:F(h,["prevent"])},{default:a(()=>[e(C,{class:"pt-0"},{default:a(()=>[e(T,null,{default:a(()=>[(i(!0),P(U,null,Z(w.value,r=>(i(),g(E,{key:r.key,cols:"12",md:"6"},{default:a(()=>[e(u,{modelValue:r.value,"onUpdate:modelValue":f=>r.value=f,type:r.visible?"text":"password","append-inner-icon":r.visible?"tabler-eye-off":"tabler-eye",label:r.label,autocomplete:"on",placeholder:"············","onClick:appendInner":f=>r.visible=!r.visible},null,8,["modelValue","onUpdate:modelValue","type","append-inner-icon","label","onClick:appendInner"])]),_:2},1024))),128))]),_:1})]),_:1}),e(C,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[e(b,{type:"submit"},{default:a(()=>[S(_(c(t)("password.save")),1)]),_:1}),e(b,{type:"reset",color:"secondary",variant:"tonal"},{default:a(()=>[S(_(c(t)("password.cancel")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1})]),_:1})],64)}}},de=H(Y,[["__scopeId","data-v-46831e44"]]);export{de as A,ie as _};
