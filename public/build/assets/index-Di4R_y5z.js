import{_ as ve}from"./TablePagination-B8d9hxqa.js";import{_ as fe}from"./AppDateTimePicker-Bfo9Kk5q.js";import{_ as _e}from"./AppTextField-D7_sgzpA.js";import{_ as Ve}from"./AppSelect-Be37VUwQ.js";import{r,E as ge,w as Z,V as ye,c as j,b as a,e as o,i as be,a as q,o as C,s as i,d as u,ae as T,Z as f,t as d,f as F,k as we}from"./main-DFArCsHY.js";import xe from"./AddNewUserDrawer-DWumuP-F.js";import ke from"./EditUserDrawer-CzldVEJ-.js";import{$ as h}from"./api-XzAV96D5.js";import{_ as De}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as H,a as Ue,b as J,d as Ce}from"./VCard-DxEjI5j5.js";import{V as Te}from"./VSnackbar-DEKLRHEo.js";import{V as he}from"./VDialog-Comn7H6S.js";import{V as K}from"./VCardText-DPCtp8hQ.js";import{V as W}from"./VSpacer-Ix0ciMj8.js";import{V as $e}from"./VDivider-r3A3xjrj.js";import{V as Be}from"./VDataTableServer-aed43sCK.js";import{V as Pe}from"./VAvatar-CR6ulyn0.js";import{V as Ee}from"./VImg-u4PCXAxX.js";import"./VPagination-uZ1sW5JS.js";import"./VField-Df9Z3FAQ.js";import"./form-Dca2QsTl.js";import"./easing-Bybner-F.js";import"./VInput-CTSxe1am.js";import"./VTextField-umeveIvf.js";/* empty css                   */import"./VCounter-COEwzdbN.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-DMNaQ-fx.js";import"./VList-CePb2jwz.js";import"./ssrBoot-BYwRCcks.js";import"./dialog-transition-DJ8svTM-.js";import"./VMenu-CGIlYQhN.js";import"./VOverlay-DAJAZdL3.js";import"./delay-DmoI4jxp.js";import"./lazy-Cxg2GrII.js";import"./scopeId-C1yITn5F.js";import"./VCheckboxBtn-CTXDyT5c.js";import"./VSelectionControl-CPzmbhb-.js";import"./VChip-D7ojS-xb.js";import"./VSlideGroup-D22aarxl.js";import"./validators-DpYrMFzk.js";import"./helpers-DK5QwNv0.js";import"./AppDrawerHeaderSection-UlioqdB7.js";import"./vue3-perfect-scrollbar-lX5i4by-.js";import"./VNavigationDrawer-CUULj9NY.js";import"./VForm-C3ZOJrXx.js";import"./VRow-ug2wovWp.js";/* empty css              */import"./index-CvOPxmL5.js";import"./VDataTable-_pKsa3bT.js";import"./VTable-iLxlgEJ3.js";import"./filter-B-rpF6id.js";const Ie={class:"me-3 d-flex gap-3"},Ae={style:{"min-width":"200px"}},Se={style:{"min-width":"200px"}},Me={style:{"min-width":"200px"}},Re={style:{"min-width":"200px"}},Ne={style:{"min-width":"200px"}},Oe={class:"d-flex align-center gap-x-4"},ze={key:1},Fe={class:"d-flex flex-column"},Le={class:"text-base"},Ge={class:"text-sm"},Ye={class:"d-flex align-center gap-x-2"},Qe={class:"text-capitalize text-high-emphasis text-body-1"},Ze={__name:"index",setup(je){const X=be(),y=r(""),b=r(null),w=r(null),x=r(null),k=r(null),$=r([]),ee=async()=>{var l;try{const e=await h("/plans",{method:"GET",params:{per_page:200}});e&&e.status==="success"?$.value=Array.isArray(e.data)?e.data:((l=e.data)==null?void 0:l.data)??e.data??[]:$.value=[]}catch(e){console.error("Error fetching plans",e),$.value=[]}},p=r(10),c=r(1),A=r(),S=r(),L=r([]),te=l=>{var e,n,m,g;A.value=(n=(e=l.sortBy)==null?void 0:e[0])==null?void 0:n.key,S.value=(g=(m=l.sortBy)==null?void 0:m[0])==null?void 0:g.order},B=r(!1),G=r(""),P=r("success"),_=(l,e="success")=>{G.value=l,P.value=e,B.value=!0},D=r(!1),E=r(null),ae=l=>{E.value=l,D.value=!0},le=async()=>{E.value&&(await de(E.value),D.value=!1,E.value=null)},oe=l=>{if(!l)return"غير محدد";const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),m=new Date(l),z=new Date(m.getFullYear(),m.getMonth(),m.getDate()).getTime()-n.getTime(),v=Math.ceil(z/(1e3*60*60*24));return v>0?`متبقي ${v} يوم`:v===0?"ينتهي اليوم":"منتهية"},re=[{title:"المستخدم",key:"user"},{title:"النوع",key:"role"},{title:"عدد الفولدرات",key:"folders",sortable:!1},{title:"عدد الكلمات",key:"words",sortable:!1},{title:"باقة الاشتراك",key:"plan"},{title:"بداية الاشتراك",key:"start_at"},{title:"نهاية الاشتراك",key:"expires_at"},{title:"الوقت المتبقي",key:"remain"},{title:"العمليات",key:"actions",sortable:!1}],I=r([]),U=r(0),M=r(!0),V=async()=>{var l;M.value=!0;try{const e={role:b.value||void 0,search:y.value||void 0,plan_id:w.value||void 0,start_date:x.value||void 0,end_date:k.value||void 0,per_page:p.value,page:c.value,sort_by:A.value||void 0,sort_order:S.value||void 0},n=await h("/users",{method:"GET",params:e});n&&n.status==="success"?(I.value=n.data,U.value=((l=n.meta)==null?void 0:l.total)||0):(I.value=[],U.value=0)}catch(e){console.error("Error fetching users",e),I.value=[],U.value=0}finally{M.value=!1}},se=()=>{y.value="",b.value=null,w.value=null,x.value=null,k.value=null};ge(async()=>{await ee(),V()}),Z([y,b,w,x,k,p,A,S],()=>{c.value=1,V()}),Z(c,()=>{V()});const ne=ye(()=>I.value),R=l=>{const e=l==null?void 0:l.toLowerCase();return e==="subscriber"?{color:"success",icon:"tabler-user"}:e==="author"?{color:"error",icon:"tabler-device-desktop"}:e==="maintainer"?{color:"info",icon:"tabler-chart-pie"}:e==="editor"?{color:"warning",icon:"tabler-edit"}:e==="admin"?{color:"primary",icon:"tabler-crown"}:{color:"primary",icon:"tabler-user"}},N=r(!1),O=r(!1),Y=r(null),ie=async l=>{try{await h("/users/store",{method:"POST",body:l}),_("تم اضافة البيانات بنجاح","success"),V()}catch{_("حدث خطأ من فضلك حاول في وقت اخر","error")}},ue=async(l,e)=>{try{await h(`/users/update/${l}`,{method:"POST",body:e}),_("تم تعديل البيانات بنجاح","success"),V()}catch{_("حدث خطأ من فضلك حاول في وقت اخر","error")}},de=async l=>{try{await h(`/users/delete/${l}`,{method:"POST"}),_("تم الحذف بنجاح","success"),V()}catch{_("حدث خطأ أثناء الحذف","error")}},me=l=>{Y.value=l,O.value=!0},pe=l=>{X.push({name:"admin-users-id",params:{id:l}})};return(l,e)=>{const n=Ve,m=_e,g=fe,z=q("RouterLink"),v=q("IconBtn"),ce=ve;return C(),j("section",null,[a(H,{class:"mb-6"},{default:o(()=>[a(Ue,{class:"pb-4"},{default:o(()=>[a(J,null,{default:o(()=>e[17]||(e[17]=[i("المستخدمين")])),_:1,__:[17]})]),_:1}),a(K,{class:"d-flex flex-wrap gap-4 align-center"},{default:o(()=>[u("div",Ie,[a(n,{label:"عرض","model-value":p.value,items:[10,25,50,100].map(t=>({value:t,title:t})),style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[0]||(e[0]=t=>p.value=parseInt(t,10))},null,8,["model-value","items"])]),u("div",Ae,[a(m,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=t=>y.value=t),placeholder:"بحث بالاسم أو الايميل",label:"بحث"},null,8,["modelValue"])]),u("div",Se,[a(n,{modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=t=>b.value=t),items:[{value:"user",title:"مستخدم"},{value:"admin",title:"مدير"}],label:"النوع",clearable:""},null,8,["modelValue"])]),u("div",Me,[a(n,{modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=t=>w.value=t),items:$.value,"item-value":"id","item-title":"name",label:"الباقة",clearable:"",placeholder:"اختر باقة"},null,8,["modelValue","items"])]),u("div",Re,[a(g,{modelValue:x.value,"onUpdate:modelValue":e[4]||(e[4]=t=>x.value=t),label:"تاريخ البداية",placeholder:"اختر التاريخ",clearable:""},null,8,["modelValue"])]),u("div",Ne,[a(g,{modelValue:k.value,"onUpdate:modelValue":e[5]||(e[5]=t=>k.value=t),label:"تاريخ النهاية",placeholder:"اختر التاريخ",clearable:""},null,8,["modelValue"])]),a(W),a(T,{"prepend-icon":"tabler-rotate-clockwise",variant:"outlined",onClick:se},{default:o(()=>e[18]||(e[18]=[i(" إعادة تعيين ")])),_:1,__:[18]}),a(T,{"prepend-icon":"tabler-plus",onClick:e[6]||(e[6]=t=>N.value=!0)},{default:o(()=>e[19]||(e[19]=[i(" إضافة مستخدم جديد ")])),_:1,__:[19]})]),_:1}),a($e),a(Be,{"items-per-page":p.value,"onUpdate:itemsPerPage":e[8]||(e[8]=t=>p.value=t),"model-value":L.value,"onUpdate:modelValue":e[9]||(e[9]=t=>L.value=t),page:c.value,"onUpdate:page":e[10]||(e[10]=t=>c.value=t),items:ne.value,"item-value":"id","items-length":U.value,headers:re,class:"text-no-wrap",loading:M.value,"onUpdate:options":te},{"item.user":o(({item:t})=>[u("div",Oe,[a(Pe,{size:"34",variant:t.avatar?void 0:"tonal",color:t.avatar?void 0:R(t.role).color},{default:o(()=>{var s;return[t.avatar?(C(),F(Ee,{key:0,src:t.avatar},null,8,["src"])):(C(),j("span",ze,d((s=t.name)==null?void 0:s.charAt(0).toUpperCase()),1))]}),_:2},1032,["variant","color"]),u("div",Fe,[u("h6",Le,[a(z,{to:{name:"apps-user-view-id",params:{id:t.id}},class:"font-weight-medium text-link"},{default:o(()=>[i(d(t.name),1)]),_:2},1032,["to"])]),u("div",Ge,d(t.email),1)])])]),"item.role":o(({item:t})=>[u("div",Ye,[a(f,{size:22,icon:R(t.role).icon,color:R(t.role).color},null,8,["icon","color"]),u("div",Qe,d(t.role=="user"?"عميل":"ادمن"),1)])]),"item.plan":o(({item:t})=>{var s,Q;return[i(d(((Q=(s=t.subscription)==null?void 0:s.plan)==null?void 0:Q.name)||"غير مشترك"),1)]}),"item.start_at":o(({item:t})=>{var s;return[i(d(((s=t.subscription)==null?void 0:s.start_date)??"غير محدد"),1)]}),"item.expires_at":o(({item:t})=>{var s;return[i(d(((s=t.subscription)==null?void 0:s.end_date)??"غير محدد"),1)]}),"item.remain":o(({item:t})=>{var s;return[i(d(oe((s=t.subscription)==null?void 0:s.end_date)),1)]}),"item.actions":o(({item:t})=>[a(v,{onClick:s=>me(t)},{default:o(()=>[a(f,{icon:"tabler-pencil"})]),_:2},1032,["onClick"]),a(v,{onClick:s=>ae(t.id)},{default:o(()=>[a(f,{icon:"tabler-trash"})]),_:2},1032,["onClick"]),a(v,{onClick:s=>pe(t.id)},{default:o(()=>[a(f,{icon:"tabler-eye"})]),_:2},1032,["onClick"])]),bottom:o(()=>[a(ce,{page:c.value,"onUpdate:page":e[7]||(e[7]=t=>c.value=t),"items-per-page":p.value,"total-items":U.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length","loading"])]),_:1}),a(xe,{"is-drawer-open":N.value,"onUpdate:isDrawerOpen":e[11]||(e[11]=t=>N.value=t),onUserData:ie},null,8,["is-drawer-open"]),a(ke,{"is-drawer-open":O.value,"onUpdate:isDrawerOpen":e[12]||(e[12]=t=>O.value=t),"user-data":Y.value,onUserData:ue},null,8,["is-drawer-open","user-data"]),a(Te,{modelValue:B.value,"onUpdate:modelValue":e[14]||(e[14]=t=>B.value=t),color:P.value,location:"top end",timeout:"5000"},{prepend:o(()=>[P.value==="success"?(C(),F(f,{key:0,icon:"tabler-check"})):P.value==="error"?(C(),F(f,{key:1,icon:"tabler-alert-circle"})):we("",!0)]),actions:o(()=>[a(T,{icon:"",variant:"text",color:"white",onClick:e[13]||(e[13]=t=>B.value=!1)},{default:o(()=>[a(f,{icon:"tabler-x"})]),_:1})]),default:o(()=>[i(" "+d(G.value)+" ",1)]),_:1},8,["modelValue","color"]),a(he,{modelValue:D.value,"onUpdate:modelValue":e[16]||(e[16]=t=>D.value=t),"max-width":"500px"},{default:o(()=>[a(H,null,{default:o(()=>[a(J,{class:"text-h6"},{default:o(()=>e[20]||(e[20]=[i(" تأكيد الحذف ")])),_:1,__:[20]}),a(K,null,{default:o(()=>e[21]||(e[21]=[i("هل أنت متأكد أنك تريد حذف هذا المستخدم؟ لا يمكن التراجع عن هذا الإجراء.")])),_:1,__:[21]}),a(Ce,{class:"px-6 pb-4"},{default:o(()=>[a(W),a(T,{color:"error",variant:"flat",onClick:e[15]||(e[15]=t=>D.value=!1)},{default:o(()=>e[22]||(e[22]=[i(" إلغاء ")])),_:1,__:[22]}),a(T,{color:"success",variant:"flat",onClick:le},{default:o(()=>e[23]||(e[23]=[i(" موافق ")])),_:1,__:[23]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},Zt=De(Ze,[["__scopeId","data-v-eeadcfe0"]]);export{Zt as default};
