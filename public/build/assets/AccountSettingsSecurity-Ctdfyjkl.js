import{_ as I}from"./AppTextField-BWx9dSw2.js";import{r as i,E as G,c as T,o as u,b as a,e as l,s as x,t as $,a5 as _,Z as d,f as m,cB as N,d as k,ak as A,F as E,a3 as z,h as O}from"./main-DSzMYLzp.js";import{$ as F}from"./api-DfH6QBqv.js";import{V as B}from"./VSnackbar-cAfrQJKi.js";import{a as S,V as P}from"./VRow-CXKAFC9P.js";import{V as D}from"./VCard-DuhDOrWR.js";import{V as w}from"./VCardText-CYf2INNP.js";import{V as R}from"./VAvatar-CS_wgqDD.js";import{V as L}from"./VForm-CPPstvq0.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"d-flex flex-column justify-center gap-4"},Z={class:"d-flex flex-wrap gap-4"},oe={__name:"AccountSettingsAccount",setup(h){const y=i(),f=i(!1),g=i(!1),p=i(!1),C=i(""),V=i("success"),t=i({name:"",email:"",language:"",role:"",avatar:null,avatarPreview:null}),s=async()=>{var c;f.value=!0;try{const e=await F("/user",{method:"GET"}),o=(c=e==null?void 0:e.data)==null?void 0:c.user;o&&(t.value.name=o.name,t.value.email=o.email,t.value.language=o.language||"en",t.value.role=o.role,t.value.avatar=o.avatar)}catch(e){console.error("Error fetching user:",e)}finally{f.value=!1}},n=(c,e="success")=>{C.value=c,V.value=e,p.value=!0},r=async()=>{var c;g.value=!0;try{const e=new FormData;e.append("name",t.value.name),e.append("email",t.value.email),e.append("language","ar"),t.value.avatar instanceof File?e.append("avatar",t.value.avatar):e.append("avatar","");const o=await F("/update-profile",{method:"POST",body:e});n("تم تعديل البيانات بنجاح","success"),(c=o==null?void 0:o.data)!=null&&c.user&&(z("userData").value={name:o.data.user.name,role:o.data.user.role,email:o.data.user.email,avatar:o.data.user.avatar||null})}catch(e){console.error("Error updating profile:",e),n("حدث خطأ من فضلك حاو في وقت اخر","error")}finally{g.value=!1}},v=c=>{const{files:e}=c.target;e&&e.length&&(t.value.avatar=e[0],t.value.avatarPreview=URL.createObjectURL(e[0]))},j=()=>{t.value.avatar=null,t.value.avatarPreview=null,y.value.value=""};return G(()=>{s()}),(c,e)=>{const o=I;return u(),T(E,null,[a(B,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=b=>p.value=b),color:V.value,location:"top end",timeout:"5000"},{prepend:l(()=>[V.value==="success"?(u(),m(d,{key:0,icon:"tabler-check"})):V.value==="error"?(u(),m(d,{key:1,icon:"tabler-alert-circle"})):(u(),m(d,{key:2,icon:"tabler-info-circle"}))]),actions:l(()=>[a(_,{icon:"",variant:"text",color:"white",onClick:e[0]||(e[0]=b=>p.value=!1)},{default:l(()=>[a(d,{icon:"tabler-x"})]),_:1})]),default:l(()=>[x(" "+$(C.value)+" ",1)]),_:1},8,["modelValue","color"]),a(P,null,{default:l(()=>[a(S,{cols:"12"},{default:l(()=>[a(D,null,{default:l(()=>[f.value?(u(),m(w,{key:0},{default:l(()=>[a(N,{indeterminate:"",color:"primary"})]),_:1})):(u(),m(w,{key:1,class:"d-flex"},{default:l(()=>[a(R,{rounded:"",size:"100",class:"me-6",image:t.value.avatarPreview||t.value.avatar||"/default-avatar.png"},null,8,["image"]),k("form",J,[k("div",Z,[a(_,{color:"primary",size:"small",onClick:e[2]||(e[2]=b=>{var U;return(U=y.value)==null?void 0:U.click()})},{default:l(()=>[a(d,{icon:"tabler-cloud-upload",class:"d-sm-none"}),e[5]||(e[5]=k("span",{class:"d-none d-sm-block"},"تحميل صورة الحساب",-1))]),_:1,__:[5]}),k("input",{ref_key:"refInputEl",ref:y,type:"file",accept:".jpeg,.png,.jpg,.gif",hidden:"",onInput:v},null,544),a(_,{type:"reset",size:"small",color:"secondary",variant:"tonal",onClick:j},{default:l(()=>[e[6]||(e[6]=k("span",{class:"d-none d-sm-block"},"الغاء",-1)),a(d,{icon:"tabler-refresh",class:"d-sm-none"})]),_:1,__:[6]})]),e[7]||(e[7]=k("p",{class:"text-body-1 mb-0"}," مسموح بالامتدادات JPG, GIF , PNG بمساحة 2 ميجا كحد اقصي ",-1))])]),_:1})),a(w,{class:"pt-2"},{default:l(()=>[a(L,{class:"mt-3",onSubmit:A(r,["prevent"])},{default:l(()=>[a(P,null,{default:l(()=>[a(S,{cols:"12",md:"6"},{default:l(()=>[a(o,{modelValue:t.value.name,"onUpdate:modelValue":e[3]||(e[3]=b=>t.value.name=b),label:"الاسم",placeholder:"ادخل اسمك"},null,8,["modelValue"])]),_:1}),a(S,{cols:"12",md:"6"},{default:l(()=>[a(o,{modelValue:t.value.email,"onUpdate:modelValue":e[4]||(e[4]=b=>t.value.email=b),label:"البريد الالكتروني",placeholder:"ادخل بريدك الالكتروني",type:"email"},null,8,["modelValue"])]),_:1}),a(w,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:l(()=>[a(_,{type:"submit",loading:g.value},{default:l(()=>e[8]||(e[8]=[x(" حفظ التعديلات ")])),_:1,__:[8]},8,["loading"]),a(_,{color:"secondary",variant:"tonal",disabled:g.value,onClick:A(s,["prevent"])},{default:l(()=>e[9]||(e[9]=[x(" الغاء ")])),_:1,__:[9]},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64)}}},q={__name:"AccountSettingsSecurity",setup(h){const y=i([{key:"current_password",label:"كلمة المرور الحالية",value:"",visible:!1},{key:"new_password",label:"كلمة المرور الجديدة",value:"",visible:!1},{key:"new_password_confirmation",label:"تأكيد كلمة المرور الجديدة",value:"",visible:!1}]),f=i(!1),g=i(""),p=i("success"),C=(t,s="success")=>{g.value=t,p.value=s,f.value=!0},V=async()=>{var t,s;try{const n={};y.value.forEach(v=>{n[v.key]=v.value});const r=await F("/change-password",{method:"POST",body:n});C(r.data.message||"تم تعديل كلمة المرور بنجاح","success"),y.value.forEach(v=>v.value="")}catch(n){console.error("Error updating password:",n),C(((s=(t=n==null?void 0:n.response)==null?void 0:t._data)==null?void 0:s.message)||"حدث خطأ اثناء التعديل برجاء المحاولة في وقت لاحق","error")}};return(t,s)=>{const n=I;return u(),T(E,null,[a(B,{modelValue:f.value,"onUpdate:modelValue":s[1]||(s[1]=r=>f.value=r),color:p.value,location:"top end",timeout:"5000"},{prepend:l(()=>[p.value==="success"?(u(),m(d,{key:0,icon:"tabler-check"})):p.value==="error"?(u(),m(d,{key:1,icon:"tabler-alert-circle"})):(u(),m(d,{key:2,icon:"tabler-info-circle"}))]),actions:l(()=>[a(_,{icon:"",variant:"text",color:"white",onClick:s[0]||(s[0]=r=>f.value=!1)},{default:l(()=>[a(d,{icon:"tabler-x"})]),_:1})]),default:l(()=>[x(" "+$(g.value)+" ",1)]),_:1},8,["modelValue","color"]),a(P,null,{default:l(()=>[a(S,{cols:"12"},{default:l(()=>[a(D,{title:"تعديل كلمة المرور"},{default:l(()=>[a(L,{onSubmit:A(V,["prevent"])},{default:l(()=>[a(w,{class:"pt-0"},{default:l(()=>[a(P,null,{default:l(()=>[(u(!0),T(E,null,O(y.value,r=>(u(),m(S,{key:r.key,cols:"12",md:"6"},{default:l(()=>[a(n,{modelValue:r.value,"onUpdate:modelValue":v=>r.value=v,type:r.visible?"text":"password","append-inner-icon":r.visible?"tabler-eye-off":"tabler-eye",label:r.label,autocomplete:"on",placeholder:"············","onClick:appendInner":v=>r.visible=!r.visible},null,8,["modelValue","onUpdate:modelValue","type","append-inner-icon","label","onClick:appendInner"])]),_:2},1024))),128))]),_:1})]),_:1}),a(w,{class:"d-flex flex-wrap gap-4"},{default:l(()=>[a(_,{type:"submit"},{default:l(()=>s[2]||(s[2]=[x(" حفظ التعديلات ")])),_:1,__:[2]}),a(_,{type:"reset",color:"secondary",variant:"tonal"},{default:l(()=>s[3]||(s[3]=[x(" الغاء ")])),_:1,__:[3]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64)}}},se=M(q,[["__scopeId","data-v-329a5900"]]);export{se as A,oe as _};
