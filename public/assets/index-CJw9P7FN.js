import{_ as ne}from"./TablePagination-DdKTX9OV.js";import{_ as ie}from"./AppDateTimePicker-Dr5P4Pgx.js";import{_ as ue}from"./AppTextField-aZv7gLR1.js";import{_ as de}from"./AppSelect-Dc5xzrsl.js";import{r,E as me,w as Y,V as pe,c as Q,b as a,e as l,i as ce,o as D,s as u,d as i,a5 as P,t as d,Z as A,f as O,k as ve}from"./main-BoNGmApi.js";import fe from"./AddNewUserDrawer-DX_oWiNP.js";import _e from"./EditUserDrawer-D6FikSbU.js";import{$ as k}from"./api-CHPjDHzy.js";import{_ as Ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Z,a as ge,b as j,d as ye}from"./VCard-CIKASufN.js";import{V as be}from"./VSnackbar-nXt_2vgz.js";import{V as we}from"./VDialog-fBE2blFA.js";import{V as q}from"./VCardText-DDkz13nn.js";import{V as H}from"./VSpacer-EjYJj1Z_.js";import{V as xe}from"./VDivider-COJgEHam.js";import{V as De}from"./VDataTableServer-cQiRBdfY.js";import{V as ke}from"./VAvatar-B4jUlWaz.js";import{V as Ue}from"./VImg-C0UW1cvE.js";import"./VPagination-g7dDgunw.js";import"./VField-CGulMkEM.js";import"./form-BOCittNv.js";import"./easing-Bybner-F.js";import"./VInput-UNY5FM3D.js";import"./VTextField-DfsZX4z1.js";/* empty css                   */import"./VCounter-BrDhg_jj.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-DvY4lhKB.js";import"./VList-dMazRKTH.js";import"./ssrBoot-CbhHCPX2.js";import"./dialog-transition-DSZfBO75.js";import"./VMenu-Ct53Bckx.js";import"./VOverlay-BEh_8h-6.js";import"./delay-VWJ3yp0p.js";import"./lazy-CCMlf-LN.js";import"./scopeId-9mEpF7-z.js";import"./VCheckboxBtn-CXq9-h6C.js";import"./VSelectionControl-BjjFP2rz.js";import"./VChip-CFWLr0Fc.js";import"./VSlideGroup-BuutOZ8P.js";import"./validators-DpYrMFzk.js";import"./helpers-DK5QwNv0.js";import"./AppDrawerHeaderSection-C2Ci_3BF.js";import"./vue3-perfect-scrollbar-C3VtpWIR.js";import"./VNavigationDrawer-CMqHVrvh.js";import"./VForm-DNQjOeF6.js";import"./VRow-CR53p6r4.js";/* empty css              */import"./index-CvOPxmL5.js";import"./VDataTable-C6qSTHw6.js";import"./VTable-Bdz8hCOV.js";import"./filter-JpcQOUJD.js";const Te={class:"me-3 d-flex gap-3"},he={style:{"min-width":"200px"}},Ce={style:{"min-width":"200px"}},$e={style:{"min-width":"200px"}},Pe={style:{"min-width":"200px"}},Ae={style:{"min-width":"200px"}},Be={class:"d-flex align-center gap-x-4"},Ee={key:1},Ie={class:"d-flex flex-column"},Se={class:"text-base"},Me={class:"text-sm"},Ne={class:"d-flex align-center gap-x-2"},Oe={class:"text-capitalize text-high-emphasis text-body-1"},Re={__name:"index",setup(ze){ce();const V=r(""),g=r(null),y=r(null),b=r(null),w=r(null),U=r([]),J=async()=>{var o;try{const e=await k("/plans",{method:"GET",params:{per_page:200}});e&&e.status==="success"?U.value=Array.isArray(e.data)?e.data:((o=e.data)==null?void 0:o.data)??e.data??[]:U.value=[]}catch(e){console.error("Error fetching plans",e),U.value=[]}},p=r(10),c=r(1),B=r(),E=r(),R=r([]),K=o=>{var e,s,m,_;B.value=(s=(e=o.sortBy)==null?void 0:e[0])==null?void 0:s.key,E.value=(_=(m=o.sortBy)==null?void 0:m[0])==null?void 0:_.order},T=r(!1),z=r(""),h=r("success"),v=(o,e="success")=>{z.value=o,h.value=e,T.value=!0},C=r(!1),I=r(null),W=async()=>{I.value&&(await se(I.value),C.value=!1,I.value=null)},X=o=>{if(!o)return"غير محدد";const e=new Date,s=new Date(e.getFullYear(),e.getMonth(),e.getDate()),m=new Date(o),N=new Date(m.getFullYear(),m.getMonth(),m.getDate()).getTime()-s.getTime(),t=Math.ceil(N/(1e3*60*60*24));return t>0?`متبقي ${t} يوم`:t===0?"ينتهي اليوم":"منتهية"},ee=[{title:"المستخدم",key:"user"},{title:"النوع",key:"role"},{title:"عدد الفولدرات",key:"folders",sortable:!1},{title:"عدد الكلمات",key:"words",sortable:!1},{title:"باقة الاشتراك",key:"plan"},{title:"بداية الاشتراك",key:"start_at"},{title:"نهاية الاشتراك",key:"expires_at"},{title:"الوقت المتبقي",key:"remain"}],$=r([]),x=r(0),S=r(!0),f=async()=>{var o;S.value=!0;try{const e={role:g.value||void 0,search:V.value||void 0,plan_id:y.value||void 0,start_date:b.value||void 0,end_date:w.value||void 0,per_page:p.value,page:c.value,sort_by:B.value||void 0,sort_order:E.value||void 0},s=await k("/users",{method:"GET",params:e});s&&s.status==="success"?($.value=s.data,x.value=((o=s.meta)==null?void 0:o.total)||0):($.value=[],x.value=0)}catch(e){console.error("Error fetching users",e),$.value=[],x.value=0}finally{S.value=!1}},te=()=>{V.value="",g.value=null,y.value=null,b.value=null,w.value=null};me(async()=>{await J(),f()}),Y([V,g,y,b,w,p,B,E],()=>{c.value=1,f()}),Y(c,()=>{f()});const ae=pe(()=>$.value),M=o=>{const e=o==null?void 0:o.toLowerCase();return e==="subscriber"?{color:"success",icon:"tabler-user"}:e==="author"?{color:"error",icon:"tabler-device-desktop"}:e==="maintainer"?{color:"info",icon:"tabler-chart-pie"}:e==="editor"?{color:"warning",icon:"tabler-edit"}:e==="admin"?{color:"primary",icon:"tabler-crown"}:{color:"primary",icon:"tabler-user"}},F=r(!1),G=r(!1),le=r(null),oe=async o=>{try{await k("/users/store",{method:"POST",body:o}),v("تم اضافة البيانات بنجاح","success"),f()}catch{v("حدث خطأ من فضلك حاول في وقت اخر","error")}},re=async(o,e)=>{try{await k(`/users/update/${o}`,{method:"POST",body:e}),v("تم تعديل البيانات بنجاح","success"),f()}catch{v("حدث خطأ من فضلك حاول في وقت اخر","error")}},se=async o=>{try{await k(`/users/delete/${o}`,{method:"POST"}),v("تم الحذف بنجاح","success"),f()}catch{v("حدث خطأ أثناء الحذف","error")}};return(o,e)=>{const s=de,m=ue,_=ie,N=ne;return D(),Q("section",null,[a(Z,{class:"mb-6"},{default:l(()=>[a(ge,{class:"pb-4"},{default:l(()=>[a(j,null,{default:l(()=>e[16]||(e[16]=[u("المستخدمين")])),_:1,__:[16]})]),_:1}),a(q,{class:"d-flex flex-wrap gap-4 align-center"},{default:l(()=>[i("div",Te,[a(s,{label:"عرض","model-value":p.value,items:[10,25,50,100].map(t=>({value:t,title:t})),style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[0]||(e[0]=t=>p.value=parseInt(t,10))},null,8,["model-value","items"])]),i("div",he,[a(m,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=t=>V.value=t),placeholder:"بحث بالاسم أو الايميل",label:"بحث"},null,8,["modelValue"])]),i("div",Ce,[a(s,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=t=>g.value=t),items:[{value:"user",title:"مستخدم"},{value:"admin",title:"مدير"}],label:"النوع",clearable:""},null,8,["modelValue"])]),i("div",$e,[a(s,{modelValue:y.value,"onUpdate:modelValue":e[3]||(e[3]=t=>y.value=t),items:U.value,"item-value":"id","item-title":"name",label:"الباقة",clearable:"",placeholder:"اختر باقة"},null,8,["modelValue","items"])]),i("div",Pe,[a(_,{modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=t=>b.value=t),label:"تاريخ البداية",placeholder:"اختر التاريخ",clearable:""},null,8,["modelValue"])]),i("div",Ae,[a(_,{modelValue:w.value,"onUpdate:modelValue":e[5]||(e[5]=t=>w.value=t),label:"تاريخ النهاية",placeholder:"اختر التاريخ",clearable:""},null,8,["modelValue"])]),a(H),a(P,{"prepend-icon":"tabler-rotate-clockwise",variant:"outlined",onClick:te},{default:l(()=>e[17]||(e[17]=[u(" إعادة تعيين ")])),_:1,__:[17]})]),_:1}),a(xe),a(De,{"items-per-page":p.value,"onUpdate:itemsPerPage":e[7]||(e[7]=t=>p.value=t),"model-value":R.value,"onUpdate:modelValue":e[8]||(e[8]=t=>R.value=t),page:c.value,"onUpdate:page":e[9]||(e[9]=t=>c.value=t),items:ae.value,"item-value":"id","items-length":x.value,headers:ee,class:"text-no-wrap",loading:S.value,"onUpdate:options":K},{"item.user":l(({item:t})=>[i("div",Be,[a(ke,{size:"34",variant:t.avatar?void 0:"tonal",color:t.avatar?void 0:M(t.role).color},{default:l(()=>{var n;return[t.avatar?(D(),O(Ue,{key:0,src:t.avatar},null,8,["src"])):(D(),Q("span",Ee,d((n=t.name)==null?void 0:n.charAt(0).toUpperCase()),1))]}),_:2},1032,["variant","color"]),i("div",Ie,[i("h6",Se,d(t.name),1),i("div",Me,d(t.email),1)])])]),"item.role":l(({item:t})=>[i("div",Ne,[a(A,{size:22,icon:M(t.role).icon,color:M(t.role).color},null,8,["icon","color"]),i("div",Oe,d(t.role=="user"?"عميل":"ادمن"),1)])]),"item.plan":l(({item:t})=>{var n,L;return[u(d(((L=(n=t.subscription)==null?void 0:n.plan)==null?void 0:L.name)||"غير مشترك"),1)]}),"item.start_at":l(({item:t})=>{var n;return[u(d(((n=t.subscription)==null?void 0:n.start_date)??"غير محدد"),1)]}),"item.expires_at":l(({item:t})=>{var n;return[u(d(((n=t.subscription)==null?void 0:n.end_date)??"غير محدد"),1)]}),"item.remain":l(({item:t})=>{var n;return[u(d(X((n=t.subscription)==null?void 0:n.end_date)),1)]}),"item.actions":l(({item:t})=>e[18]||(e[18]=[])),bottom:l(()=>[a(N,{page:c.value,"onUpdate:page":e[6]||(e[6]=t=>c.value=t),"items-per-page":p.value,"total-items":x.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length","loading"])]),_:1}),a(fe,{"is-drawer-open":F.value,"onUpdate:isDrawerOpen":e[10]||(e[10]=t=>F.value=t),onUserData:oe},null,8,["is-drawer-open"]),a(_e,{"is-drawer-open":G.value,"onUpdate:isDrawerOpen":e[11]||(e[11]=t=>G.value=t),"user-data":le.value,onUserData:re},null,8,["is-drawer-open","user-data"]),a(be,{modelValue:T.value,"onUpdate:modelValue":e[13]||(e[13]=t=>T.value=t),color:h.value,location:"top end",timeout:"5000"},{prepend:l(()=>[h.value==="success"?(D(),O(A,{key:0,icon:"tabler-check"})):h.value==="error"?(D(),O(A,{key:1,icon:"tabler-alert-circle"})):ve("",!0)]),actions:l(()=>[a(P,{icon:"",variant:"text",color:"white",onClick:e[12]||(e[12]=t=>T.value=!1)},{default:l(()=>[a(A,{icon:"tabler-x"})]),_:1})]),default:l(()=>[u(" "+d(z.value)+" ",1)]),_:1},8,["modelValue","color"]),a(we,{modelValue:C.value,"onUpdate:modelValue":e[15]||(e[15]=t=>C.value=t),"max-width":"500px"},{default:l(()=>[a(Z,null,{default:l(()=>[a(j,{class:"text-h6"},{default:l(()=>e[19]||(e[19]=[u(" تأكيد الحذف ")])),_:1,__:[19]}),a(q,null,{default:l(()=>e[20]||(e[20]=[u("هل أنت متأكد أنك تريد حذف هذا المستخدم؟ لا يمكن التراجع عن هذا الإجراء.")])),_:1,__:[20]}),a(ye,{class:"px-6 pb-4"},{default:l(()=>[a(H),a(P,{color:"error",variant:"flat",onClick:e[14]||(e[14]=t=>C.value=!1)},{default:l(()=>e[21]||(e[21]=[u(" إلغاء ")])),_:1,__:[21]}),a(P,{color:"success",variant:"flat",onClick:W},{default:l(()=>e[22]||(e[22]=[u(" موافق ")])),_:1,__:[22]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},Rt=Ve(Re,[["__scopeId","data-v-9048fb14"]]);export{Rt as default};
