import{V as N,a as R,f as V,o as m,e as a,b as o,p as $,Z as C,s as h,t as c,I as g,l as k,J as v,c as S,F as w,h as z,k as A,v as P,d,r as T,E as L}from"./main-D7GZrFPc.js";import{C as U}from"./vue3-perfect-scrollbar-0fVAVACI.js";import{$ as B}from"./api-BeHJEbM3.js";/* empty css                                                      */import{V as q}from"./VBadge-CIWXRM39.js";import{V as D}from"./VMenu-CA2MFpOx.js";import{V as F,a as M,b as O}from"./VCard-DT64k4Cz.js";import{V as j}from"./VChip-udoLMTLN.js";import{V as x}from"./VDivider-wc9HqgK5.js";import{c as G,a as I,b as J}from"./VList-F9p1vbvQ.js";import{V as Z}from"./VSpacer-CeMEN20F.js";import"./index-CvOPxmL5.js";import"./VImg-BKWqwFT8.js";import"./VOverlay-BG3xaAKI.js";import"./easing-Bybner-F.js";import"./delay-DQPnD_CU.js";import"./lazy-DF7vD1w0.js";import"./scopeId-BZ6pJ2T2.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-Cnq99lTQ.js";import"./VAvatar-BLMjzrgb.js";import"./VCardText-CefwAUfD.js";import"./VSlideGroup-BYMKBCqk.js";import"./ssrBoot-BVP4G8eg.js";/* empty css              */const H={class:"d-flex align-start gap-3"},K={class:"text-sm font-weight-medium mb-1"},Q={class:"text-body-2 mb-2",style:{"letter-spacing":"0.4px !important","line-height":"18px"}},W={class:"text-sm text-disabled mb-0",style:{"letter-spacing":"0.4px !important","line-height":"18px"}},X={__name:"Notifications",props:{notifications:{type:Array,required:!0},badgeProps:{type:Object,required:!1,default:void 0},location:{type:null,required:!1,default:"bottom end"}},emits:["read","unread","remove","click:notification"],setup(b,{emit:r}){const s=b,l=r,f=async e=>{if(!e.isSeen)try{await B(`/notifications/${e.id}/read`,{method:"POST"}),e.isSeen=!0,l("read",[e.id])}catch(u){console.error("Error marking notification as read:",u)}},_=e=>{f(e),l("click:notification",e)},p=N(()=>s.notifications.some(e=>e.isSeen===!1)),t=()=>{const e=s.notifications.map(u=>u.id);p.value?l("read",e):l("unread",e)},i=N(()=>s.notifications.filter(e=>e.isSeen===!1).length);return(e,u)=>{const y=R("IconBtn");return m(),V(y,{id:"notification-btn"},{default:a(()=>[o(q,$(s.badgeProps,{"model-value":s.notifications.some(n=>!n.isSeen),color:"error",dot:"","offset-x":"2","offset-y":"3"}),{default:a(()=>[o(C,{icon:"tabler-bell"})]),_:1},16,["model-value"]),o(D,{activator:"parent",width:"380px",location:s.location,offset:"12px","close-on-content-click":!1},{default:a(()=>[o(F,{class:"d-flex flex-column"},{default:a(()=>[o(M,{class:"notification-section"},{append:a(()=>[g(o(j,{size:"small",color:"primary",class:"me-2"},{default:a(()=>[h(c(k(i))+" New ",1)]),_:1},512),[[v,s.notifications.some(n=>!n.isSeen)]]),g(o(y,{size:"34",onClick:t},{default:a(()=>[o(C,{size:"20",color:"high-emphasis",icon:k(p)?"tabler-mail-opened":"tabler-mail"},null,8,["icon"])]),_:1},512),[[v,s.notifications.length]])]),default:a(()=>[o(O,{class:"text-h6"},{default:a(()=>[h(c(e.$t("Notifications")),1)]),_:1})]),_:1}),o(x),o(k(U),{options:{wheelPropagation:!1},style:{"max-block-size":"23.75rem"}},{default:a(()=>[o(G,{class:"notification-list rounded-0 py-0"},{default:a(()=>[(m(!0),S(w,null,z(s.notifications,(n,E)=>(m(),S(w,{key:n.id},[E>0?(m(),V(x,{key:0})):A("",!0),o(I,{link:"",lines:"one","min-height":"66px",class:P(["list-item-hover-class",{"notification-unread":!n.isSeen}]),onClick:Y=>_(n)},{default:a(()=>[d("div",H,[d("div",null,[d("p",K,c(n.title),1),d("p",Q,c(n.subtitle),1),d("p",W,c(n.time),1)]),o(Z)])]),_:2},1032,["class","onClick"])],64))),128)),g(o(I,{class:"text-center text-medium-emphasis",style:{"block-size":"56px"}},{default:a(()=>[o(J,null,{default:a(()=>[h(c(e.$t("No Notification Found"))+"!",1)]),_:1})]),_:1},512),[[v,!s.notifications.length]])]),_:1})]),_:1}),o(x)]),_:1})]),_:1},8,["location"])]),_:1})}}},Ce={__name:"NavBarNotifications",setup(b){const r=T([]),s=async()=>{try{const t=await B("/user-notifications",{method:"GET"});console.log(t),Array.isArray(t.data)?r.value=t.data.map(i=>({id:i.id,title:i.message,subtitle:i.message_en,time:i.created_at,isSeen:i.is_read})):console.warn("No notifications found in API response")}catch(t){console.error("Error loading notifications:",t)}},l=t=>{r.value=r.value.filter(i=>i.id!==t)},f=t=>{r.value.forEach(i=>{t.includes(i.id)&&(i.isSeen=!0)})},_=t=>{r.value.forEach(i=>{t.includes(i.id)&&(i.isSeen=!1)})},p=t=>{t.isSeen||f([t.id])};return L(()=>{s()}),(t,i)=>{const e=X;return m(),V(e,{notifications:r.value,onRemove:l,onRead:f,onUnread:_,"onClick:notification":p},null,8,["notifications"])}}};export{Ce as default};
