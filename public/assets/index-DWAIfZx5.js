import{_ as W}from"./TablePagination-Bb4okfSq.js";import{_ as X}from"./AppTextField-B5LmAI45.js";import{_ as Y}from"./AppSelect-CGoPXjiF.js";import{r as s,E as h,w as ee,V as te,c as ae,b as a,e as o,i as oe,a as le,o as T,s as i,d as $,a5 as _,Z as v,t as se,f as I,k as re}from"./main-D7GZrFPc.js";import ne from"./AddNewPlanDrawer-6V1MXpVr.js";import ie from"./EditPlanDrawer-CbZwGy_P.js";import{$ as w}from"./api-BeHJEbM3.js";import{V as N,a as pe,b as O,d as ue}from"./VCard-DT64k4Cz.js";import{V as me}from"./VSnackbar-CDTIPFgy.js";import{V as de}from"./VDialog-DROIvLHD.js";import{V as A}from"./VCardText-CefwAUfD.js";import{V as z}from"./VSpacer-CeMEN20F.js";import{V as ve}from"./VDivider-wc9HqgK5.js";import{V as ce}from"./VDataTableServer-BT8_TwfA.js";import"./VPagination-DLw8Gp0K.js";import"./form-oozAywB0.js";import"./VTextField-DRRTeVyU.js";/* empty css                   */import"./VCounter-36TneYEq.js";import"./VImg-BKWqwFT8.js";import"./VField-Dtz92r7N.js";import"./easing-Bybner-F.js";import"./VInput-DMUQC4_n.js";import"./forwardRefs-C-GTDzx5.js";import"./VSelect-AMYQbzZG.js";import"./VList-F9p1vbvQ.js";import"./ssrBoot-BVP4G8eg.js";import"./VAvatar-BLMjzrgb.js";import"./dialog-transition-Cnq99lTQ.js";import"./VMenu-CA2MFpOx.js";import"./VOverlay-BG3xaAKI.js";import"./delay-DQPnD_CU.js";import"./lazy-DF7vD1w0.js";import"./scopeId-BZ6pJ2T2.js";import"./VCheckboxBtn-5Z1sZGey.js";import"./VSelectionControl-C9fnzau3.js";import"./VChip-udoLMTLN.js";import"./VSlideGroup-BYMKBCqk.js";import"./validators-DpYrMFzk.js";import"./helpers-DK5QwNv0.js";import"./AppTextarea-DWkxOXY7.js";import"./VTextarea-1zYdG-Ok.js";import"./AppDrawerHeaderSection-B0imzD_d.js";import"./vue3-perfect-scrollbar-0fVAVACI.js";import"./VNavigationDrawer-CzYrM_bp.js";import"./VForm-hfu_i-lW.js";import"./VRow-vQlp5R9K.js";/* empty css              */import"./index-CvOPxmL5.js";import"./VDataTable-DmV80qoC.js";import"./VTable--Nvmegqn.js";import"./filter-Deo4j4hx.js";const fe={class:"me-3 d-flex gap-3"},Ve={class:"app-plan-search-filter d-flex align-center flex-wrap gap-4"},ge={style:{"inline-size":"15.625rem"}},gt={__name:"index",setup(ye){oe();const c=s(""),r=s(10),p=s(1),k=s(),b=s(),f=s([]),R=l=>{var e,n;k.value=(e=l.sortBy[0])==null?void 0:e.key,b.value=(n=l.sortBy[0])==null?void 0:n.order},V=s(!1),B=s(""),g=s("success"),u=(l,e="success")=>{B.value=l,g.value=e,V.value=!0},m=s(!1),y=s(null),F=l=>{y.value=l,m.value=!0},G=async()=>{y.value&&(await H(y.value),m.value=!1,y.value=null)},M=[{title:"اسم باقة الاشتراك",key:"name"},{title:"عدد الكلمات",key:"words_limit"},{title:"السعر",key:"price"},{title:"المدة (شهور)",key:"duration_months"},{title:"عدد المشتركين",key:"subscriptions"},{title:"الوصف",key:"description"},{title:"العمليات",key:"actions",sortable:!1}],U=s([]),x=s(0),C=s(!0),d=async()=>{var l;C.value=!0;try{const e=await w("/plans",{method:"GET",params:{search:c.value,per_page:r.value,page:p.value,sort_by:k.value,sort_order:b.value}});e.status==="success"&&(U.value=e.data,x.value=((l=e.meta)==null?void 0:l.total)||0)}catch(e){console.error("Error fetching plans",e)}finally{C.value=!1}};h(d),ee([c,r,p,k,b],d);const Q=te(()=>U.value),D=s(!1),Z=async l=>{try{await w("/plans/store",{method:"POST",body:l}),u("تم إضافة باقة الاشتراك بنجاح","success"),d()}catch{u("حدث خطأ، حاول مرة أخرى","error")}},P=s(!1),S=s(null),j=l=>{S.value=l,P.value=!0},q=async(l,e)=>{try{await w(`/plans/update/${l}`,{method:"POST",body:e}),u("تم تعديل باقة الاشتراك بنجاح","success"),d()}catch{u("حدث خطأ، حاول مرة أخرى","error")}},H=async l=>{try{await w(`/plans/delete/${l}`,{method:"POST"});const e=f.value.findIndex(n=>n===l);e!==-1&&f.value.splice(e,1),u("تم حذف باقة الاشتراك بنجاح","success"),d()}catch{u("حدث خطأ أثناء الحذف","error")}};return(l,e)=>{const n=Y,J=X,E=le("IconBtn"),K=W;return T(),ae("section",null,[a(N,{class:"mb-6"},{default:o(()=>[a(pe,{class:"pb-4"},{default:o(()=>[a(O,null,{default:o(()=>e[13]||(e[13]=[i("باقات الاشتراك")])),_:1,__:[13]})]),_:1}),a(A,{class:"d-flex flex-wrap gap-4"},{default:o(()=>[$("div",fe,[a(n,{"model-value":r.value,items:[10,25,50,100].map(t=>({value:t,title:t})),style:{"inline-size":"6.25rem"},"onUpdate:modelValue":e[0]||(e[0]=t=>r.value=parseInt(t,10))},null,8,["model-value","items"])]),a(z),$("div",Ve,[$("div",ge,[a(J,{modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=t=>c.value=t),placeholder:"بحث"},null,8,["modelValue"])]),a(_,{"prepend-icon":"tabler-plus",onClick:e[2]||(e[2]=t=>D.value=!0)},{default:o(()=>e[14]||(e[14]=[i(" اضافة خطة جديدة ")])),_:1,__:[14]})])]),_:1}),a(ve),a(ce,{"items-per-page":r.value,"onUpdate:itemsPerPage":e[4]||(e[4]=t=>r.value=t),"model-value":f.value,"onUpdate:modelValue":e[5]||(e[5]=t=>f.value=t),page:p.value,"onUpdate:page":e[6]||(e[6]=t=>p.value=t),items:Q.value,"item-value":"id","items-length":x.value,headers:M,class:"text-no-wrap",loading:C.value,"onUpdate:options":R},{"item.actions":o(({item:t})=>[a(E,{onClick:L=>j(t)},{default:o(()=>[a(v,{icon:"tabler-pencil"})]),_:2},1032,["onClick"]),a(E,{onClick:L=>F(t.id)},{default:o(()=>[a(v,{icon:"tabler-trash"})]),_:2},1032,["onClick"])]),bottom:o(()=>[a(K,{page:p.value,"onUpdate:page":e[3]||(e[3]=t=>p.value=t),"items-per-page":r.value,"total-items":x.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length","loading"])]),_:1}),a(ne,{"is-drawer-open":D.value,"onUpdate:isDrawerOpen":e[7]||(e[7]=t=>D.value=t),onPlanData:Z},null,8,["is-drawer-open"]),a(ie,{"is-drawer-open":P.value,"onUpdate:isDrawerOpen":e[8]||(e[8]=t=>P.value=t),"plan-data":S.value,onPlanData:q},null,8,["is-drawer-open","plan-data"]),a(me,{modelValue:V.value,"onUpdate:modelValue":e[10]||(e[10]=t=>V.value=t),color:g.value,location:"top end",timeout:"5000"},{prepend:o(()=>[g.value==="success"?(T(),I(v,{key:0,icon:"tabler-check"})):g.value==="error"?(T(),I(v,{key:1,icon:"tabler-alert-circle"})):re("",!0)]),actions:o(()=>[a(_,{icon:"",variant:"text",color:"white",onClick:e[9]||(e[9]=t=>V.value=!1)},{default:o(()=>[a(v,{icon:"tabler-x"})]),_:1})]),default:o(()=>[i(" "+se(B.value)+" ",1)]),_:1},8,["modelValue","color"]),a(de,{modelValue:m.value,"onUpdate:modelValue":e[12]||(e[12]=t=>m.value=t),"max-width":"500px"},{default:o(()=>[a(N,null,{default:o(()=>[a(O,{class:"text-h6"},{default:o(()=>e[15]||(e[15]=[i("تأكيد الحذف")])),_:1,__:[15]}),a(A,null,{default:o(()=>e[16]||(e[16]=[i("هل أنت متأكد أنك تريد حذف هذه باقة الاشتراك؟ لا يمكن التراجع عن هذا الإجراء.")])),_:1,__:[16]}),a(ue,{class:"px-6 pb-4"},{default:o(()=>[a(z),a(_,{color:"error",variant:"flat",onClick:e[11]||(e[11]=t=>m.value=!1)},{default:o(()=>e[17]||(e[17]=[i("إلغاء")])),_:1,__:[17]}),a(_,{color:"success",variant:"flat",onClick:G},{default:o(()=>e[18]||(e[18]=[i("موافق")])),_:1,__:[18]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{gt as default};
